!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=179)}([,function(t,e,r){function n(){}r(24).mixin(n),n.prototype.write=function(t,e,r){this.emit("item",t,e,r)},n.prototype.end=function(){this.emit("end"),this.removeAllListeners()},n.prototype.pipe=function(t){var e=this;function r(){t.write.apply(t,Array.prototype.slice.call(arguments))}function n(){!t._isStdio&&t.end()}return e.emit("unpipe",t),t.emit("pipe",e),e.on("item",r),e.on("end",n),e.when("unpipe",function(i){var o=i===t||void 0===i;return o&&(e.removeListener("item",r),e.removeListener("end",n),t.emit("unpipe")),o}),t},n.prototype.unpipe=function(t){return this.emit("unpipe",t),this},n.prototype.format=function(t){throw new Error(["Warning: .format() is deprecated in Minilog v2! Use .pipe() instead. For example:","var Minilog = require('minilog');","Minilog","  .pipe(Minilog.backends.console.formatClean)","  .pipe(Minilog.backends.console);"].join("\n"))},n.mixin=function(t){var e,r=n.prototype;for(e in r)r.hasOwnProperty(e)&&(t.prototype[e]=r[e])},t.exports=n},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(12),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,null,[{key:"toNumber",value:function(t){if("number"==typeof t)return Number.isNaN(t)?0:t;var e=Number(t);return Number.isNaN(e)?0:e}},{key:"toBoolean",value:function(t){return"boolean"==typeof t?t:"string"==typeof t?""!==t&&"0"!==t&&"false"!==t.toLowerCase():Boolean(t)}},{key:"toString",value:function(t){return String(t)}},{key:"toRgbColorList",value:function(e){var r=t.toRgbColorObject(e);return[r.r,r.g,r.b]}},{key:"toRgbColorObject",value:function(e){return"string"==typeof e&&"#"===e.substring(0,1)?i.hexToRgb(e):i.decimalToRgb(t.toNumber(e))}},{key:"isWhiteSpace",value:function(t){return null===t||"string"==typeof t&&0===t.trim().length}},{key:"compare",value:function(e,r){var n=Number(e),i=Number(r);if(0===n&&t.isWhiteSpace(e)?n=NaN:0===i&&t.isWhiteSpace(r)&&(i=NaN),isNaN(n)||isNaN(i)){var o=String(e).toLowerCase(),a=String(r).toLowerCase();return o<a?-1:o>a?1:0}return n===1/0&&i===1/0||n===-1/0&&i===-1/0?0:n-i}},{key:"isInt",value:function(t){return"number"==typeof t?!!isNaN(t)||t===parseInt(t,10):"boolean"==typeof t||"string"==typeof t&&t.indexOf(".")<0}},{key:"toListIndex",value:function(e,r,n){if("number"!=typeof e){if("all"===e)return n?t.LIST_ALL:t.LIST_INVALID;if("last"===e)return r>0?r:t.LIST_INVALID;if("random"===e||"any"===e)return r>0?1+Math.floor(Math.random()*r):t.LIST_INVALID}return(e=Math.floor(t.toNumber(e)))<1||e>r?t.LIST_INVALID:e}},{key:"LIST_INVALID",get:function(){return"INVALID"}},{key:"LIST_ALL",get:function(){return"ALL"}}]),t}();t.exports=o},function(t,e,r){var n=r(22);n.enable(),t.exports=n("vm")},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,null,[{key:"simple",value:function(t){return JSON.parse(JSON.stringify(t))}}]),t}();t.exports=n},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,null,[{key:"degToRad",value:function(t){return t*Math.PI/180}},{key:"radToDeg",value:function(t){return 180*t/Math.PI}},{key:"clamp",value:function(t,e,r){return Math.min(Math.max(t,e),r)}},{key:"wrapClamp",value:function(t,e,r){var n=r-e+1;return t-Math.floor((t-e)/n)*n}},{key:"tan",value:function(t){switch(t%=360){case-270:case 90:return 1/0;case-90:case 270:return-1/0;default:return parseFloat(Math.tan(Math.PI*t/180).toFixed(10))}}},{key:"reducedSortOrdering",value:function(t){var e=t.slice(0).sort(function(t,e){return t-e});return t.map(function(t){return e.indexOf(t)})}},{key:"scale",value:function(t,e,r,n,i){return(t-e)/(r-e)*(i-n)+n}}]),t}();t.exports=n},function(t,e,r){var n=r(42),i=r(62);function o(e,r){return delete t.exports[e],t.exports[e]=r,r}t.exports={Parser:n,Tokenizer:r(43),ElementType:r(7),DomHandler:i,get FeedHandler(){return o("FeedHandler",r(64))},get Stream(){return o("Stream",r(65))},get WritableStream(){return o("WritableStream",r(47))},get ProxyHandler(){return o("ProxyHandler",r(69))},get DomUtils(){return o("DomUtils",r(70))},get CollectingHandler(){return o("CollectingHandler",r(81))},DefaultHandler:i,get RssHandler(){return o("RssHandler",this.FeedHandler)},parseDOM:function(t,e){var r=new i(e);return new n(r,e).end(t),r.dom},parseFeed:function(e,r){var i=new t.exports.FeedHandler(r);return new n(i,r).end(e),i.dom},createDomStream:function(t,e,r){var o=new i(t,e,r);return new n(o,e)},EVENTS:{attribute:2,cdatastart:0,cdataend:0,text:1,processinginstruction:2,comment:1,commentend:0,closetag:1,opentag:2,opentagname:1,error:1,end:0}}},function(t,e){t.exports={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag",CDATA:"cdata",Doctype:"doctype",isTag:function(t){return"tag"===t.type||"script"===t.type||"style"===t.type}}},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){var r="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.exports=function(){for(var t=r.length,e=[],n=0;n<20;n++)e[n]=r.charAt(Math.random()*t);return e.join("")}},function(t,e){t.exports={ANGLE:"angle",BOOLEAN:"Boolean",COLOR:"color",NUMBER:"number",STRING:"string",MATRIX:"matrix",NOTE:"note",IMAGE:"image"}},function(t,e){t.exports={BOOLEAN:"Boolean",BUTTON:"button",COMMAND:"command",CONDITIONAL:"conditional",EVENT:"event",HAT:"hat",LOOP:"loop",REPORTER:"reporter"}},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,null,[{key:"decimalToHex",value:function(t){t<0&&(t+=16777216);var e=Number(t).toString(16);return e="#".concat("000000".substr(0,6-e.length)).concat(e)}},{key:"decimalToRgb",value:function(t){var e=t>>24&255;return{r:t>>16&255,g:t>>8&255,b:255&t,a:e>0?e:255}}},{key:"hexToRgb",value:function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,r,n){return e+e+r+r+n+n});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}},{key:"rgbToHex",value:function(e){return t.decimalToHex(t.rgbToDecimal(e))}},{key:"rgbToDecimal",value:function(t){return(t.r<<16)+(t.g<<8)+t.b}},{key:"hexToDecimal",value:function(e){return t.rgbToDecimal(t.hexToRgb(e))}},{key:"hsvToRgb",value:function(t){var e=t.h%360;e<0&&(e+=360);var r,n,i,o=Math.max(0,Math.min(t.s,1)),a=Math.max(0,Math.min(t.v,1)),s=Math.floor(e/60),u=e/60-s,c=a*(1-o),l=a*(1-o*u),h=a*(1-o*(1-u));switch(s){default:case 0:r=a,n=h,i=c;break;case 1:r=l,n=a,i=c;break;case 2:r=c,n=a,i=h;break;case 3:r=c,n=l,i=a;break;case 4:r=h,n=c,i=a;break;case 5:r=a,n=c,i=l}return{r:Math.floor(255*r),g:Math.floor(255*n),b:Math.floor(255*i)}}},{key:"rgbToHsv",value:function(t){var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(Math.min(e,r),n),o=Math.max(Math.max(e,r),n),a=0,s=0;i!==o&&(a=60*((e===i?3:r===i?5:1)-(e===i?r-n:r===i?n-e:e-r)/(o-i))%360,s=(o-i)/o);return{h:a,s:s,v:o}}},{key:"mixRgb",value:function(t,e,r){if(r<=0)return t;if(r>=1)return e;var n=1-r;return{r:n*t.r+r*e.r,g:n*t.g+r*e.g,b:n*t.b+r*e.b}}},{key:"RGB_BLACK",get:function(){return{r:0,g:0,b:0}}},{key:"RGB_WHITE",get:function(){return{r:255,g:255,b:255}}}]),t}();t.exports=n},function(t,e){var r={black:"#000",red:"#c23621",green:"#25bc26",yellow:"#bbbb00",blue:"#492ee1",magenta:"#d338d3",cyan:"#33bbc8",gray:"#808080",purple:"#708"};t.exports=function(t,e){return e?"color: #fff; background: "+r[t]+";":"color: "+r[t]+";"}},function(t,e,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=r(16),i=r(17),o=r(18);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,r)}function c(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(e,r),i=(t=s(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(u.isBuffer(e)){var r=0|p(e.length);return 0===(t=s(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?s(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(l(e),t=s(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function f(t,e){var r=e.length<0?0:0|p(e.length);t=s(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(t).length;default:if(n)return F(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function m(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=u.from(e,n)),u.isBuffer(e))return 0===e.length?-1:v(t,e,r,n,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):v(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,r,n,i){var o,a=1,s=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function _(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[r+a]=s}return a}function y(t,e,r,n){return q(F(e,t.length-r),t,r,n)}function b(t,e,r,n){return q(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function k(t,e,r,n){return b(t,e,r,n)}function T(t,e,r,n){return q(V(e),t,r,n)}function S(t,e,r,n){return q(function(t,e){for(var r,n,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)r=t.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function w(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function E(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,a,s,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=r)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=h}return function(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=I));return r}(n)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,r){return c(null,t,e,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,r){return function(t,e,r,n){return l(e),e<=0?s(t,e):void 0!==r?"string"==typeof n?s(t,e).fill(r,n):s(t,e).fill(r):s(t,e)}(null,t,e,r)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=u.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var a=t[r];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):function(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return N(this,e,r);case"utf8":case"utf-8":return E(this,e,r);case"ascii":return A(this,e,r);case"latin1":case"binary":return O(this,e,r);case"base64":return w(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,r,n,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,i>>>=0,this===t)return 0;for(var o=i-n,a=r-e,s=Math.min(o,a),c=this.slice(n,i),l=t.slice(e,r),h=0;h<s;++h)if(c[h]!==l[h]){o=c[h],a=l[h];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},u.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},u.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)},u.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return _(this,t,e,r);case"utf8":case"utf-8":return y(this,t,e,r);case"ascii":return b(this,t,e,r);case"latin1":case"binary":return k(this,t,e,r);case"base64":return T(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function A(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function O(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function N(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=j(t[o]);return i}function x(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function C(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,r,n,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function R(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function M(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function L(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function P(t,e,r,n,o){return o||L(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function B(t,e,r,n,o){return o||L(t,0,r,8),i.write(t,e,r,n,52,8),r+8}u.prototype.slice=function(t,e){var r,n=this.length;if(t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},u.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||C(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},u.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||C(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},u.prototype.readUInt8=function(t,e){return e||C(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||C(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||C(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||C(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},u.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||C(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||C(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(t,e){e||C(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(t,e){return e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||C(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||C(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||C(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||C(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||D(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},u.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||D(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},u.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);D(this,t,e,r,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<r&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},u.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);D(this,t,e,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},u.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,r){return P(this,t,e,!0,r)},u.prototype.writeFloatBE=function(t,e,r){return P(this,t,e,!1,r)},u.prototype.writeDoubleLE=function(t,e,r){return B(this,t,e,!0,r)},u.prototype.writeDoubleBE=function(t,e,r){return B(this,t,e,!1,r)},u.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},u.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var a=u.isBuffer(t)?t:F(new u(t,n).toString()),s=a.length;for(o=0;o<r-e;++o)this[o+e]=a[o%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function j(t){return t<16?"0"+t.toString(16):t.toString(16)}function F(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],a=0;a<n;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function V(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}}).call(this,r(8))},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},function(t,e,r){"use strict";e.byteLength=function(t){var e=c(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){for(var e,r=c(t),n=r[0],a=r[1],s=new o(function(t,e,r){return 3*(e+r)/4-r}(0,n,a)),u=0,l=a>0?n-4:n,h=0;h<l;h+=4)e=i[t.charCodeAt(h)]<<18|i[t.charCodeAt(h+1)]<<12|i[t.charCodeAt(h+2)]<<6|i[t.charCodeAt(h+3)],s[u++]=e>>16&255,s[u++]=e>>8&255,s[u++]=255&e;2===a&&(e=i[t.charCodeAt(h)]<<2|i[t.charCodeAt(h+1)]>>4,s[u++]=255&e);1===a&&(e=i[t.charCodeAt(h)]<<10|i[t.charCodeAt(h+1)]<<4|i[t.charCodeAt(h+2)]>>2,s[u++]=e>>8&255,s[u++]=255&e);return s},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],a=0,s=r-i;a<s;a+=16383)o.push(h(t,a,a+16383>s?s:a+16383));1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)n[s]=a[s],i[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function l(t){return n[t>>18&63]+n[t>>12&63]+n[t>>6&63]+n[63&t]}function h(t,e,r){for(var n,i=[],o=e;o<r;o+=3)n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(l(n));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,h=r?i-1:0,f=r?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[r+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[r+p]=255&a,p+=d,a/=256,c-=8);t[r+p-d]|=128*g}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,r){t.exports=function(){"use strict";var t=Array.prototype.slice;function e(t,e){e&&(t.prototype=Object.create(e.prototype)),t.prototype.constructor=t}function r(t){return a(t)?t:H(t)}function n(t){return s(t)?t:W(t)}function i(t){return u(t)?t:J(t)}function o(t){return a(t)&&!c(t)?t:K(t)}function a(t){return!(!t||!t[h])}function s(t){return!(!t||!t[f])}function u(t){return!(!t||!t[p])}function c(t){return s(t)||u(t)}function l(t){return!(!t||!t[d])}e(n,r),e(i,r),e(o,r),r.isIterable=a,r.isKeyed=s,r.isIndexed=u,r.isAssociative=c,r.isOrdered=l,r.Keyed=n,r.Indexed=i,r.Set=o;var h="@@__IMMUTABLE_ITERABLE__@@",f="@@__IMMUTABLE_KEYED__@@",p="@@__IMMUTABLE_INDEXED__@@",d="@@__IMMUTABLE_ORDERED__@@",g=5,m=1<<g,v=m-1,_={},y={value:!1},b={value:!1};function k(t){return t.value=!1,t}function T(t){t&&(t.value=!0)}function S(){}function w(t,e){e=e||0;for(var r=Math.max(0,t.length-e),n=new Array(r),i=0;i<r;i++)n[i]=t[i+e];return n}function E(t){return void 0===t.size&&(t.size=t.__iterate(A)),t.size}function I(t,e){if("number"!=typeof e){var r=e>>>0;if(""+r!==e||4294967295===r)return NaN;e=r}return e<0?E(t)+e:e}function A(){return!0}function O(t,e,r){return(0===t||void 0!==r&&t<=-r)&&(void 0===e||void 0!==r&&e>=r)}function N(t,e){return C(t,e,0)}function x(t,e){return C(t,e,e)}function C(t,e,r){return void 0===t?r:t<0?Math.max(0,e+t):void 0===e?t:Math.min(e,t)}var D=0,R=1,M=2,L="function"==typeof Symbol&&Symbol.iterator,P="@@iterator",B=L||P;function U(t){this.next=t}function j(t,e,r,n){var i=0===t?e:1===t?r:[e,r];return n?n.value=i:n={value:i,done:!1},n}function F(){return{value:void 0,done:!0}}function V(t){return!!G(t)}function q(t){return t&&"function"==typeof t.next}function z(t){var e=G(t);return e&&e.call(t)}function G(t){var e=t&&(L&&t[L]||t[P]);if("function"==typeof e)return e}function Y(t){return t&&"number"==typeof t.length}function H(t){return null===t||void 0===t?ot():a(t)?t.toSeq():function(t){var e=ut(t)||"object"==typeof t&&new et(t);if(!e)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+t);return e}(t)}function W(t){return null===t||void 0===t?ot().toKeyedSeq():a(t)?s(t)?t.toSeq():t.fromEntrySeq():at(t)}function J(t){return null===t||void 0===t?ot():a(t)?s(t)?t.entrySeq():t.toIndexedSeq():st(t)}function K(t){return(null===t||void 0===t?ot():a(t)?s(t)?t.entrySeq():t:st(t)).toSetSeq()}U.prototype.toString=function(){return"[Iterator]"},U.KEYS=D,U.VALUES=R,U.ENTRIES=M,U.prototype.inspect=U.prototype.toSource=function(){return this.toString()},U.prototype[B]=function(){return this},e(H,r),H.of=function(){return H(arguments)},H.prototype.toSeq=function(){return this},H.prototype.toString=function(){return this.__toString("Seq {","}")},H.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},H.prototype.__iterate=function(t,e){return ct(this,t,e,!0)},H.prototype.__iterator=function(t,e){return lt(this,t,e,!0)},e(W,H),W.prototype.toKeyedSeq=function(){return this},e(J,H),J.of=function(){return J(arguments)},J.prototype.toIndexedSeq=function(){return this},J.prototype.toString=function(){return this.__toString("Seq [","]")},J.prototype.__iterate=function(t,e){return ct(this,t,e,!1)},J.prototype.__iterator=function(t,e){return lt(this,t,e,!1)},e(K,H),K.of=function(){return K(arguments)},K.prototype.toSetSeq=function(){return this},H.isSeq=it,H.Keyed=W,H.Set=K,H.Indexed=J;var X,Z,Q,$="@@__IMMUTABLE_SEQ__@@";function tt(t){this._array=t,this.size=t.length}function et(t){var e=Object.keys(t);this._object=t,this._keys=e,this.size=e.length}function rt(t){this._iterable=t,this.size=t.length||t.size}function nt(t){this._iterator=t,this._iteratorCache=[]}function it(t){return!(!t||!t[$])}function ot(){return X||(X=new tt([]))}function at(t){var e=Array.isArray(t)?new tt(t).fromEntrySeq():q(t)?new nt(t).fromEntrySeq():V(t)?new rt(t).fromEntrySeq():"object"==typeof t?new et(t):void 0;if(!e)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+t);return e}function st(t){var e=ut(t);if(!e)throw new TypeError("Expected Array or iterable object of values: "+t);return e}function ut(t){return Y(t)?new tt(t):q(t)?new nt(t):V(t)?new rt(t):void 0}function ct(t,e,r,n){var i=t._cache;if(i){for(var o=i.length-1,a=0;a<=o;a++){var s=i[r?o-a:a];if(!1===e(s[1],n?s[0]:a,t))return a+1}return a}return t.__iterateUncached(e,r)}function lt(t,e,r,n){var i=t._cache;if(i){var o=i.length-1,a=0;return new U(function(){var t=i[r?o-a:a];return a++>o?{value:void 0,done:!0}:j(e,n?t[0]:a-1,t[1])})}return t.__iteratorUncached(e,r)}function ht(t,e){return e?function t(e,r,n,i){return Array.isArray(r)?e.call(i,n,J(r).map(function(n,i){return t(e,n,i,r)})):pt(r)?e.call(i,n,W(r).map(function(n,i){return t(e,n,i,r)})):r}(e,t,"",{"":t}):ft(t)}function ft(t){return Array.isArray(t)?J(t).map(ft).toList():pt(t)?W(t).map(ft).toMap():t}function pt(t){return t&&(t.constructor===Object||void 0===t.constructor)}function dt(t,e){if(t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if(t=t.valueOf(),e=e.valueOf(),t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1}return!("function"!=typeof t.equals||"function"!=typeof e.equals||!t.equals(e))}function gt(t,e){if(t===e)return!0;if(!a(e)||void 0!==t.size&&void 0!==e.size&&t.size!==e.size||void 0!==t.__hash&&void 0!==e.__hash&&t.__hash!==e.__hash||s(t)!==s(e)||u(t)!==u(e)||l(t)!==l(e))return!1;if(0===t.size&&0===e.size)return!0;var r=!c(t);if(l(t)){var n=t.entries();return e.every(function(t,e){var i=n.next().value;return i&&dt(i[1],t)&&(r||dt(i[0],e))})&&n.next().done}var i=!1;if(void 0===t.size)if(void 0===e.size)"function"==typeof t.cacheResult&&t.cacheResult();else{i=!0;var o=t;t=e,e=o}var h=!0,f=e.__iterate(function(e,n){if(r?!t.has(e):i?!dt(e,t.get(n,_)):!dt(t.get(n,_),e))return h=!1,!1});return h&&t.size===f}function mt(t,e){if(!(this instanceof mt))return new mt(t,e);if(this._value=t,this.size=void 0===e?1/0:Math.max(0,e),0===this.size){if(Z)return Z;Z=this}}function vt(t,e){if(!t)throw new Error(e)}function _t(t,e,r){if(!(this instanceof _t))return new _t(t,e,r);if(vt(0!==r,"Cannot step a Range by 0"),t=t||0,void 0===e&&(e=1/0),r=void 0===r?1:Math.abs(r),e<t&&(r=-r),this._start=t,this._end=e,this._step=r,this.size=Math.max(0,Math.ceil((e-t)/r-1)+1),0===this.size){if(Q)return Q;Q=this}}function yt(){throw TypeError("Abstract")}function bt(){}function kt(){}function Tt(){}H.prototype[$]=!0,e(tt,J),tt.prototype.get=function(t,e){return this.has(t)?this._array[I(this,t)]:e},tt.prototype.__iterate=function(t,e){for(var r=this._array,n=r.length-1,i=0;i<=n;i++)if(!1===t(r[e?n-i:i],i,this))return i+1;return i},tt.prototype.__iterator=function(t,e){var r=this._array,n=r.length-1,i=0;return new U(function(){return i>n?{value:void 0,done:!0}:j(t,i,r[e?n-i++:i++])})},e(et,W),et.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},et.prototype.has=function(t){return this._object.hasOwnProperty(t)},et.prototype.__iterate=function(t,e){for(var r=this._object,n=this._keys,i=n.length-1,o=0;o<=i;o++){var a=n[e?i-o:o];if(!1===t(r[a],a,this))return o+1}return o},et.prototype.__iterator=function(t,e){var r=this._object,n=this._keys,i=n.length-1,o=0;return new U(function(){var a=n[e?i-o:o];return o++>i?{value:void 0,done:!0}:j(t,a,r[a])})},et.prototype[d]=!0,e(rt,J),rt.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var r=this._iterable,n=z(r),i=0;if(q(n))for(var o;!(o=n.next()).done&&!1!==t(o.value,i++,this););return i},rt.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var r=this._iterable,n=z(r);if(!q(n))return new U(F);var i=0;return new U(function(){var e=n.next();return e.done?e:j(t,i++,e.value)})},e(nt,J),nt.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);for(var r,n=this._iterator,i=this._iteratorCache,o=0;o<i.length;)if(!1===t(i[o],o++,this))return o;for(;!(r=n.next()).done;){var a=r.value;if(i[o]=a,!1===t(a,o++,this))break}return o},nt.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var r=this._iterator,n=this._iteratorCache,i=0;return new U(function(){if(i>=n.length){var e=r.next();if(e.done)return e;n[i]=e.value}return j(t,i,n[i++])})},e(mt,J),mt.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},mt.prototype.get=function(t,e){return this.has(t)?this._value:e},mt.prototype.includes=function(t){return dt(this._value,t)},mt.prototype.slice=function(t,e){var r=this.size;return O(t,e,r)?this:new mt(this._value,x(e,r)-N(t,r))},mt.prototype.reverse=function(){return this},mt.prototype.indexOf=function(t){return dt(this._value,t)?0:-1},mt.prototype.lastIndexOf=function(t){return dt(this._value,t)?this.size:-1},mt.prototype.__iterate=function(t,e){for(var r=0;r<this.size;r++)if(!1===t(this._value,r,this))return r+1;return r},mt.prototype.__iterator=function(t,e){var r=this,n=0;return new U(function(){return n<r.size?j(t,n++,r._value):{value:void 0,done:!0}})},mt.prototype.equals=function(t){return t instanceof mt?dt(this._value,t._value):gt(t)},e(_t,J),_t.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},_t.prototype.get=function(t,e){return this.has(t)?this._start+I(this,t)*this._step:e},_t.prototype.includes=function(t){var e=(t-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},_t.prototype.slice=function(t,e){return O(t,e,this.size)?this:(t=N(t,this.size),(e=x(e,this.size))<=t?new _t(0,0):new _t(this.get(t,this._end),this.get(e,this._end),this._step))},_t.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step==0){var r=e/this._step;if(r>=0&&r<this.size)return r}return-1},_t.prototype.lastIndexOf=function(t){return this.indexOf(t)},_t.prototype.__iterate=function(t,e){for(var r=this.size-1,n=this._step,i=e?this._start+r*n:this._start,o=0;o<=r;o++){if(!1===t(i,o,this))return o+1;i+=e?-n:n}return o},_t.prototype.__iterator=function(t,e){var r=this.size-1,n=this._step,i=e?this._start+r*n:this._start,o=0;return new U(function(){var a=i;return i+=e?-n:n,o>r?{value:void 0,done:!0}:j(t,o++,a)})},_t.prototype.equals=function(t){return t instanceof _t?this._start===t._start&&this._end===t._end&&this._step===t._step:gt(this,t)},e(yt,r),e(bt,yt),e(kt,yt),e(Tt,yt),yt.Keyed=bt,yt.Indexed=kt,yt.Set=Tt;var St="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){var r=65535&(t|=0),n=65535&(e|=0);return r*n+((t>>>16)*n+r*(e>>>16)<<16>>>0)|0};function wt(t){return t>>>1&1073741824|3221225471&t}function Et(t){if(!1===t||null===t||void 0===t)return 0;if("function"==typeof t.valueOf&&(!1===(t=t.valueOf())||null===t||void 0===t))return 0;if(!0===t)return 1;var e=typeof t;if("number"===e){if(t!=t||t===1/0)return 0;var r=0|t;for(r!==t&&(r^=4294967295*t);t>4294967295;)r^=t/=4294967295;return wt(r)}if("string"===e)return t.length>Rt?function(t){var e=Pt[t];return void 0===e&&(e=It(t),Lt===Mt&&(Lt=0,Pt={}),Lt++,Pt[t]=e),e}(t):It(t);if("function"==typeof t.hashCode)return t.hashCode();if("object"===e)return function(t){var e;if(xt&&void 0!==(e=At.get(t)))return e;if(void 0!==(e=t[Dt]))return e;if(!Nt){if(void 0!==(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Dt]))return e;if(void 0!==(e=function(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}(t)))return e}if(e=++Ct,1073741824&Ct&&(Ct=0),xt)At.set(t,e);else{if(void 0!==Ot&&!1===Ot(t))throw new Error("Non-extensible objects are not allowed as keys.");if(Nt)Object.defineProperty(t,Dt,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Dt]=e;else{if(void 0===t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[Dt]=e}}return e}(t);if("function"==typeof t.toString)return It(t.toString());throw new Error("Value type "+e+" cannot be hashed.")}function It(t){for(var e=0,r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return wt(e)}var At,Ot=Object.isExtensible,Nt=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}(),xt="function"==typeof WeakMap;xt&&(At=new WeakMap);var Ct=0,Dt="__immutablehash__";"function"==typeof Symbol&&(Dt=Symbol(Dt));var Rt=16,Mt=255,Lt=0,Pt={};function Bt(t){vt(t!==1/0,"Cannot perform this action with an infinite size.")}function Ut(t){return null===t||void 0===t?Qt():jt(t)&&!l(t)?t:Qt().withMutations(function(e){var r=n(t);Bt(r.size),r.forEach(function(t,r){return e.set(r,t)})})}function jt(t){return!(!t||!t[Vt])}e(Ut,bt),Ut.of=function(){var e=t.call(arguments,0);return Qt().withMutations(function(t){for(var r=0;r<e.length;r+=2){if(r+1>=e.length)throw new Error("Missing value for key: "+e[r]);t.set(e[r],e[r+1])}})},Ut.prototype.toString=function(){return this.__toString("Map {","}")},Ut.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},Ut.prototype.set=function(t,e){return $t(this,t,e)},Ut.prototype.setIn=function(t,e){return this.updateIn(t,_,function(){return e})},Ut.prototype.remove=function(t){return $t(this,t,_)},Ut.prototype.deleteIn=function(t){return this.updateIn(t,function(){return _})},Ut.prototype.update=function(t,e,r){return 1===arguments.length?t(this):this.updateIn([t],e,r)},Ut.prototype.updateIn=function(t,e,r){r||(r=e,e=void 0);var n=function t(e,r,n,i){var o=e===_,a=r.next();if(a.done){var s=o?n:e,u=i(s);return u===s?e:u}vt(o||e&&e.set,"invalid keyPath");var c=a.value,l=o?_:e.get(c,_),h=t(l,r,n,i);return h===l?e:h===_?e.remove(c):(o?Qt():e).set(c,h)}(this,rr(t),e,r);return n===_?void 0:n},Ut.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Qt()},Ut.prototype.merge=function(){return ne(this,void 0,arguments)},Ut.prototype.mergeWith=function(e){var r=t.call(arguments,1);return ne(this,e,r)},Ut.prototype.mergeIn=function(e){var r=t.call(arguments,1);return this.updateIn(e,Qt(),function(t){return"function"==typeof t.merge?t.merge.apply(t,r):r[r.length-1]})},Ut.prototype.mergeDeep=function(){return ne(this,ie,arguments)},Ut.prototype.mergeDeepWith=function(e){var r=t.call(arguments,1);return ne(this,oe(e),r)},Ut.prototype.mergeDeepIn=function(e){var r=t.call(arguments,1);return this.updateIn(e,Qt(),function(t){return"function"==typeof t.mergeDeep?t.mergeDeep.apply(t,r):r[r.length-1]})},Ut.prototype.sort=function(t){return Ne(Ye(this,t))},Ut.prototype.sortBy=function(t,e){return Ne(Ye(this,e,t))},Ut.prototype.withMutations=function(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this},Ut.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new S)},Ut.prototype.asImmutable=function(){return this.__ensureOwner()},Ut.prototype.wasAltered=function(){return this.__altered},Ut.prototype.__iterator=function(t,e){return new Jt(this,t,e)},Ut.prototype.__iterate=function(t,e){var r=this,n=0;return this._root&&this._root.iterate(function(e){return n++,t(e[1],e[0],r)},e),n},Ut.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Zt(this.size,this._root,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},Ut.isMap=jt;var Ft,Vt="@@__IMMUTABLE_MAP__@@",qt=Ut.prototype;function zt(t,e){this.ownerID=t,this.entries=e}function Gt(t,e,r){this.ownerID=t,this.bitmap=e,this.nodes=r}function Yt(t,e,r){this.ownerID=t,this.count=e,this.nodes=r}function Ht(t,e,r){this.ownerID=t,this.keyHash=e,this.entries=r}function Wt(t,e,r){this.ownerID=t,this.keyHash=e,this.entry=r}function Jt(t,e,r){this._type=e,this._reverse=r,this._stack=t._root&&Xt(t._root)}function Kt(t,e){return j(t,e[0],e[1])}function Xt(t,e){return{node:t,index:0,__prev:e}}function Zt(t,e,r,n){var i=Object.create(qt);return i.size=t,i._root=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function Qt(){return Ft||(Ft=Zt(0))}function $t(t,e,r){var n,i;if(t._root){var o=k(y),a=k(b);if(n=te(t._root,t.__ownerID,0,void 0,e,r,o,a),!a.value)return t;i=t.size+(o.value?r===_?-1:1:0)}else{if(r===_)return t;i=1,n=new zt(t.__ownerID,[[e,r]])}return t.__ownerID?(t.size=i,t._root=n,t.__hash=void 0,t.__altered=!0,t):n?Zt(i,n):Qt()}function te(t,e,r,n,i,o,a,s){return t?t.update(e,r,n,i,o,a,s):o===_?t:(T(s),T(a),new Wt(e,n,[i,o]))}function ee(t){return t.constructor===Wt||t.constructor===Ht}function re(t,e,r,n,i){if(t.keyHash===n)return new Ht(e,n,[t.entry,i]);var o,a=(0===r?t.keyHash:t.keyHash>>>r)&v,s=(0===r?n:n>>>r)&v,u=a===s?[re(t,e,r+g,n,i)]:(o=new Wt(e,n,i),a<s?[t,o]:[o,t]);return new Gt(e,1<<a|1<<s,u)}function ne(t,e,r){for(var i=[],o=0;o<r.length;o++){var s=r[o],u=n(s);a(s)||(u=u.map(function(t){return ht(t)})),i.push(u)}return ae(t,e,i)}function ie(t,e,r){return t&&t.mergeDeep&&a(e)?t.mergeDeep(e):dt(t,e)?t:e}function oe(t){return function(e,r,n){if(e&&e.mergeDeepWith&&a(r))return e.mergeDeepWith(t,r);var i=t(e,r,n);return dt(e,i)?e:i}}function ae(t,e,r){return 0===(r=r.filter(function(t){return 0!==t.size})).length?t:0!==t.size||t.__ownerID||1!==r.length?t.withMutations(function(t){for(var n=e?function(r,n){t.update(n,_,function(t){return t===_?r:e(t,r,n)})}:function(e,r){t.set(r,e)},i=0;i<r.length;i++)r[i].forEach(n)}):t.constructor(r[0])}function se(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,t+=t>>8,127&(t+=t>>16)}function ue(t,e,r,n){var i=n?t:w(t);return i[e]=r,i}qt[Vt]=!0,qt.delete=qt.remove,qt.removeIn=qt.deleteIn,zt.prototype.get=function(t,e,r,n){for(var i=this.entries,o=0,a=i.length;o<a;o++)if(dt(r,i[o][0]))return i[o][1];return n},zt.prototype.update=function(t,e,r,n,i,o,a){for(var s=i===_,u=this.entries,c=0,l=u.length;c<l&&!dt(n,u[c][0]);c++);var h=c<l;if(h?u[c][1]===i:s)return this;if(T(a),(s||!h)&&T(o),!s||1!==u.length){if(!h&&!s&&u.length>=ce)return function(t,e,r,n){t||(t=new S);for(var i=new Wt(t,Et(r),[r,n]),o=0;o<e.length;o++){var a=e[o];i=i.update(t,0,void 0,a[0],a[1])}return i}(t,u,n,i);var f=t&&t===this.ownerID,p=f?u:w(u);return h?s?c===l-1?p.pop():p[c]=p.pop():p[c]=[n,i]:p.push([n,i]),f?(this.entries=p,this):new zt(t,p)}},Gt.prototype.get=function(t,e,r,n){void 0===e&&(e=Et(r));var i=1<<((0===t?e:e>>>t)&v),o=this.bitmap;return 0==(o&i)?n:this.nodes[se(o&i-1)].get(t+g,e,r,n)},Gt.prototype.update=function(t,e,r,n,i,o,a){void 0===r&&(r=Et(n));var s=(0===e?r:r>>>e)&v,u=1<<s,c=this.bitmap,l=0!=(c&u);if(!l&&i===_)return this;var h=se(c&u-1),f=this.nodes,p=l?f[h]:void 0,d=te(p,t,e+g,r,n,i,o,a);if(d===p)return this;if(!l&&d&&f.length>=le)return function(t,e,r,n,i){for(var o=0,a=new Array(m),s=0;0!==r;s++,r>>>=1)a[s]=1&r?e[o++]:void 0;return a[n]=i,new Yt(t,o+1,a)}(t,f,c,s,d);if(l&&!d&&2===f.length&&ee(f[1^h]))return f[1^h];if(l&&d&&1===f.length&&ee(d))return d;var y=t&&t===this.ownerID,b=l?d?c:c^u:c|u,k=l?d?ue(f,h,d,y):function(t,e,r){var n=t.length-1;if(r&&e===n)return t.pop(),t;for(var i=new Array(n),o=0,a=0;a<n;a++)a===e&&(o=1),i[a]=t[a+o];return i}(f,h,y):function(t,e,r,n){var i=t.length+1;if(n&&e+1===i)return t[e]=r,t;for(var o=new Array(i),a=0,s=0;s<i;s++)s===e?(o[s]=r,a=-1):o[s]=t[s+a];return o}(f,h,d,y);return y?(this.bitmap=b,this.nodes=k,this):new Gt(t,b,k)},Yt.prototype.get=function(t,e,r,n){void 0===e&&(e=Et(r));var i=(0===t?e:e>>>t)&v,o=this.nodes[i];return o?o.get(t+g,e,r,n):n},Yt.prototype.update=function(t,e,r,n,i,o,a){void 0===r&&(r=Et(n));var s=(0===e?r:r>>>e)&v,u=i===_,c=this.nodes,l=c[s];if(u&&!l)return this;var h=te(l,t,e+g,r,n,i,o,a);if(h===l)return this;var f=this.count;if(l){if(!h&&--f<he)return function(t,e,r,n){for(var i=0,o=0,a=new Array(r),s=0,u=1,c=e.length;s<c;s++,u<<=1){var l=e[s];void 0!==l&&s!==n&&(i|=u,a[o++]=l)}return new Gt(t,i,a)}(t,c,f,s)}else f++;var p=t&&t===this.ownerID,d=ue(c,s,h,p);return p?(this.count=f,this.nodes=d,this):new Yt(t,f,d)},Ht.prototype.get=function(t,e,r,n){for(var i=this.entries,o=0,a=i.length;o<a;o++)if(dt(r,i[o][0]))return i[o][1];return n},Ht.prototype.update=function(t,e,r,n,i,o,a){void 0===r&&(r=Et(n));var s=i===_;if(r!==this.keyHash)return s?this:(T(a),T(o),re(this,t,e,r,[n,i]));for(var u=this.entries,c=0,l=u.length;c<l&&!dt(n,u[c][0]);c++);var h=c<l;if(h?u[c][1]===i:s)return this;if(T(a),(s||!h)&&T(o),s&&2===l)return new Wt(t,this.keyHash,u[1^c]);var f=t&&t===this.ownerID,p=f?u:w(u);return h?s?c===l-1?p.pop():p[c]=p.pop():p[c]=[n,i]:p.push([n,i]),f?(this.entries=p,this):new Ht(t,this.keyHash,p)},Wt.prototype.get=function(t,e,r,n){return dt(r,this.entry[0])?this.entry[1]:n},Wt.prototype.update=function(t,e,r,n,i,o,a){var s=i===_,u=dt(n,this.entry[0]);return(u?i===this.entry[1]:s)?this:(T(a),s?void T(o):u?t&&t===this.ownerID?(this.entry[1]=i,this):new Wt(t,this.keyHash,[n,i]):(T(o),re(this,t,e,Et(n),[n,i])))},zt.prototype.iterate=Ht.prototype.iterate=function(t,e){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(!1===t(r[e?i-n:n]))return!1},Gt.prototype.iterate=Yt.prototype.iterate=function(t,e){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var o=r[e?i-n:n];if(o&&!1===o.iterate(t,e))return!1}},Wt.prototype.iterate=function(t,e){return t(this.entry)},e(Jt,U),Jt.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var r,n=e.node,i=e.index++;if(n.entry){if(0===i)return Kt(t,n.entry)}else if(n.entries){if(r=n.entries.length-1,i<=r)return Kt(t,n.entries[this._reverse?r-i:i])}else if(r=n.nodes.length-1,i<=r){var o=n.nodes[this._reverse?r-i:i];if(o){if(o.entry)return Kt(t,o.entry);e=this._stack=Xt(o,e)}continue}e=this._stack=this._stack.__prev}return{value:void 0,done:!0}};var ce=m/4,le=m/2,he=m/4;function fe(t){var e=Te();if(null===t||void 0===t)return e;if(pe(t))return t;var r=i(t),n=r.size;return 0===n?e:(Bt(n),n>0&&n<m?ke(0,n,g,null,new me(r.toArray())):e.withMutations(function(t){t.setSize(n),r.forEach(function(e,r){return t.set(r,e)})}))}function pe(t){return!(!t||!t[de])}e(fe,kt),fe.of=function(){return this(arguments)},fe.prototype.toString=function(){return this.__toString("List [","]")},fe.prototype.get=function(t,e){if((t=I(this,t))>=0&&t<this.size){var r=Ee(this,t+=this._origin);return r&&r.array[t&v]}return e},fe.prototype.set=function(t,e){return function(t,e,r){if((e=I(t,e))!=e)return t;if(e>=t.size||e<0)return t.withMutations(function(t){e<0?Ie(t,e).set(0,r):Ie(t,0,e+1).set(e,r)});e+=t._origin;var n=t._tail,i=t._root,o=k(b);return e>=Oe(t._capacity)?n=Se(n,t.__ownerID,0,e,r,o):i=Se(i,t.__ownerID,t._level,e,r,o),o.value?t.__ownerID?(t._root=i,t._tail=n,t.__hash=void 0,t.__altered=!0,t):ke(t._origin,t._capacity,t._level,i,n):t}(this,t,e)},fe.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},fe.prototype.insert=function(t,e){return this.splice(t,0,e)},fe.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=g,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):Te()},fe.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations(function(r){Ie(r,0,e+t.length);for(var n=0;n<t.length;n++)r.set(e+n,t[n])})},fe.prototype.pop=function(){return Ie(this,0,-1)},fe.prototype.unshift=function(){var t=arguments;return this.withMutations(function(e){Ie(e,-t.length);for(var r=0;r<t.length;r++)e.set(r,t[r])})},fe.prototype.shift=function(){return Ie(this,1)},fe.prototype.merge=function(){return Ae(this,void 0,arguments)},fe.prototype.mergeWith=function(e){var r=t.call(arguments,1);return Ae(this,e,r)},fe.prototype.mergeDeep=function(){return Ae(this,ie,arguments)},fe.prototype.mergeDeepWith=function(e){var r=t.call(arguments,1);return Ae(this,oe(e),r)},fe.prototype.setSize=function(t){return Ie(this,0,t)},fe.prototype.slice=function(t,e){var r=this.size;return O(t,e,r)?this:Ie(this,N(t,r),x(e,r))},fe.prototype.__iterator=function(t,e){var r=0,n=be(this,e);return new U(function(){var e=n();return e===ye?{value:void 0,done:!0}:j(t,r++,e)})},fe.prototype.__iterate=function(t,e){for(var r,n=0,i=be(this,e);(r=i())!==ye&&!1!==t(r,n++,this););return n},fe.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?ke(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):(this.__ownerID=t,this)},fe.isList=pe;var de="@@__IMMUTABLE_LIST__@@",ge=fe.prototype;function me(t,e){this.array=t,this.ownerID=e}ge[de]=!0,ge.delete=ge.remove,ge.setIn=qt.setIn,ge.deleteIn=ge.removeIn=qt.removeIn,ge.update=qt.update,ge.updateIn=qt.updateIn,ge.mergeIn=qt.mergeIn,ge.mergeDeepIn=qt.mergeDeepIn,ge.withMutations=qt.withMutations,ge.asMutable=qt.asMutable,ge.asImmutable=qt.asImmutable,ge.wasAltered=qt.wasAltered,me.prototype.removeBefore=function(t,e,r){if(r===e?1<<e:0===this.array.length)return this;var n=r>>>e&v;if(n>=this.array.length)return new me([],t);var i,o=0===n;if(e>0){var a=this.array[n];if((i=a&&a.removeBefore(t,e-g,r))===a&&o)return this}if(o&&!i)return this;var s=we(this,t);if(!o)for(var u=0;u<n;u++)s.array[u]=void 0;return i&&(s.array[n]=i),s},me.prototype.removeAfter=function(t,e,r){if(r===(e?1<<e:0)||0===this.array.length)return this;var n,i=r-1>>>e&v;if(i>=this.array.length)return this;if(e>0){var o=this.array[i];if((n=o&&o.removeAfter(t,e-g,r))===o&&i===this.array.length-1)return this}var a=we(this,t);return a.array.splice(i+1),n&&(a.array[i]=n),a};var ve,_e,ye={};function be(t,e){var r=t._origin,n=t._capacity,i=Oe(n),o=t._tail;return a(t._root,t._level,0);function a(t,s,u){return 0===s?function(t,a){var s=a===i?o&&o.array:t&&t.array,u=a>r?0:r-a,c=n-a;return c>m&&(c=m),function(){if(u===c)return ye;var t=e?--c:u++;return s&&s[t]}}(t,u):function(t,i,o){var s,u=t&&t.array,c=o>r?0:r-o>>i,l=1+(n-o>>i);return l>m&&(l=m),function(){for(;;){if(s){var t=s();if(t!==ye)return t;s=null}if(c===l)return ye;var r=e?--l:c++;s=a(u&&u[r],i-g,o+(r<<i))}}}(t,s,u)}}function ke(t,e,r,n,i,o,a){var s=Object.create(ge);return s.size=e-t,s._origin=t,s._capacity=e,s._level=r,s._root=n,s._tail=i,s.__ownerID=o,s.__hash=a,s.__altered=!1,s}function Te(){return ve||(ve=ke(0,0,g))}function Se(t,e,r,n,i,o){var a,s=n>>>r&v,u=t&&s<t.array.length;if(!u&&void 0===i)return t;if(r>0){var c=t&&t.array[s],l=Se(c,e,r-g,n,i,o);return l===c?t:((a=we(t,e)).array[s]=l,a)}return u&&t.array[s]===i?t:(T(o),a=we(t,e),void 0===i&&s===a.array.length-1?a.array.pop():a.array[s]=i,a)}function we(t,e){return e&&t&&e===t.ownerID?t:new me(t?t.array.slice():[],e)}function Ee(t,e){if(e>=Oe(t._capacity))return t._tail;if(e<1<<t._level+g){for(var r=t._root,n=t._level;r&&n>0;)r=r.array[e>>>n&v],n-=g;return r}}function Ie(t,e,r){void 0!==e&&(e|=0),void 0!==r&&(r|=0);var n=t.__ownerID||new S,i=t._origin,o=t._capacity,a=i+e,s=void 0===r?o:r<0?o+r:i+r;if(a===i&&s===o)return t;if(a>=s)return t.clear();for(var u=t._level,c=t._root,l=0;a+l<0;)c=new me(c&&c.array.length?[void 0,c]:[],n),l+=1<<(u+=g);l&&(a+=l,i+=l,s+=l,o+=l);for(var h=Oe(o),f=Oe(s);f>=1<<u+g;)c=new me(c&&c.array.length?[c]:[],n),u+=g;var p=t._tail,d=f<h?Ee(t,s-1):f>h?new me([],n):p;if(p&&f>h&&a<o&&p.array.length){for(var m=c=we(c,n),_=u;_>g;_-=g){var y=h>>>_&v;m=m.array[y]=we(m.array[y],n)}m.array[h>>>g&v]=p}if(s<o&&(d=d&&d.removeAfter(n,0,s)),a>=f)a-=f,s-=f,u=g,c=null,d=d&&d.removeBefore(n,0,a);else if(a>i||f<h){for(l=0;c;){var b=a>>>u&v;if(b!==f>>>u&v)break;b&&(l+=(1<<u)*b),u-=g,c=c.array[b]}c&&a>i&&(c=c.removeBefore(n,u,a-l)),c&&f<h&&(c=c.removeAfter(n,u,f-l)),l&&(a-=l,s-=l)}return t.__ownerID?(t.size=s-a,t._origin=a,t._capacity=s,t._level=u,t._root=c,t._tail=d,t.__hash=void 0,t.__altered=!0,t):ke(a,s,u,c,d)}function Ae(t,e,r){for(var n=[],o=0,s=0;s<r.length;s++){var u=r[s],c=i(u);c.size>o&&(o=c.size),a(u)||(c=c.map(function(t){return ht(t)})),n.push(c)}return o>t.size&&(t=t.setSize(o)),ae(t,e,n)}function Oe(t){return t<m?0:t-1>>>g<<g}function Ne(t){return null===t||void 0===t?De():xe(t)?t:De().withMutations(function(e){var r=n(t);Bt(r.size),r.forEach(function(t,r){return e.set(r,t)})})}function xe(t){return jt(t)&&l(t)}function Ce(t,e,r,n){var i=Object.create(Ne.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=r,i.__hash=n,i}function De(){return _e||(_e=Ce(Qt(),Te()))}function Re(t,e,r){var n,i,o=t._map,a=t._list,s=o.get(e),u=void 0!==s;if(r===_){if(!u)return t;a.size>=m&&a.size>=2*o.size?(i=a.filter(function(t,e){return void 0!==t&&s!==e}),n=i.toKeyedSeq().map(function(t){return t[0]}).flip().toMap(),t.__ownerID&&(n.__ownerID=i.__ownerID=t.__ownerID)):(n=o.remove(e),i=s===a.size-1?a.pop():a.set(s,void 0))}else if(u){if(r===a.get(s)[1])return t;n=o,i=a.set(s,[e,r])}else n=o.set(e,a.size),i=a.set(a.size,[e,r]);return t.__ownerID?(t.size=n.size,t._map=n,t._list=i,t.__hash=void 0,t):Ce(n,i)}function Me(t,e){this._iter=t,this._useKeys=e,this.size=t.size}function Le(t){this._iter=t,this.size=t.size}function Pe(t){this._iter=t,this.size=t.size}function Be(t){this._iter=t,this.size=t.size}function Ue(t){var e=$e(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.includes(e)},e.includes=function(e){return t.has(e)},e.cacheResult=tr,e.__iterateUncached=function(e,r){var n=this;return t.__iterate(function(t,r){return!1!==e(r,t,n)},r)},e.__iteratorUncached=function(e,r){if(e===M){var n=t.__iterator(e,r);return new U(function(){var t=n.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t})}return t.__iterator(e===R?D:R,r)},e}function je(t,e,r){var n=$e(t);return n.size=t.size,n.has=function(e){return t.has(e)},n.get=function(n,i){var o=t.get(n,_);return o===_?i:e.call(r,o,n,t)},n.__iterateUncached=function(n,i){var o=this;return t.__iterate(function(t,i,a){return!1!==n(e.call(r,t,i,a),i,o)},i)},n.__iteratorUncached=function(n,i){var o=t.__iterator(M,i);return new U(function(){var i=o.next();if(i.done)return i;var a=i.value,s=a[0];return j(n,s,e.call(r,a[1],s,t),i)})},n}function Fe(t,e){var r=$e(t);return r._iter=t,r.size=t.size,r.reverse=function(){return t},t.flip&&(r.flip=function(){var e=Ue(t);return e.reverse=function(){return t.flip()},e}),r.get=function(r,n){return t.get(e?r:-1-r,n)},r.has=function(r){return t.has(e?r:-1-r)},r.includes=function(e){return t.includes(e)},r.cacheResult=tr,r.__iterate=function(e,r){var n=this;return t.__iterate(function(t,r){return e(t,r,n)},!r)},r.__iterator=function(e,r){return t.__iterator(e,!r)},r}function Ve(t,e,r,n){var i=$e(t);return n&&(i.has=function(n){var i=t.get(n,_);return i!==_&&!!e.call(r,i,n,t)},i.get=function(n,i){var o=t.get(n,_);return o!==_&&e.call(r,o,n,t)?o:i}),i.__iterateUncached=function(i,o){var a=this,s=0;return t.__iterate(function(t,o,u){if(e.call(r,t,o,u))return s++,i(t,n?o:s-1,a)},o),s},i.__iteratorUncached=function(i,o){var a=t.__iterator(M,o),s=0;return new U(function(){for(;;){var o=a.next();if(o.done)return o;var u=o.value,c=u[0],l=u[1];if(e.call(r,l,c,t))return j(i,n?c:s++,l,o)}})},i}function qe(t,e,r,n){var i=t.size;if(void 0!==e&&(e|=0),void 0!==r&&(r===1/0?r=i:r|=0),O(e,r,i))return t;var o=N(e,i),a=x(r,i);if(o!=o||a!=a)return qe(t.toSeq().cacheResult(),e,r,n);var s,u=a-o;u==u&&(s=u<0?0:u);var c=$e(t);return c.size=0===s?s:t.size&&s||void 0,!n&&it(t)&&s>=0&&(c.get=function(e,r){return(e=I(this,e))>=0&&e<s?t.get(e+o,r):r}),c.__iterateUncached=function(e,r){var i=this;if(0===s)return 0;if(r)return this.cacheResult().__iterate(e,r);var a=0,u=!0,c=0;return t.__iterate(function(t,r){if(!u||!(u=a++<o))return c++,!1!==e(t,n?r:c-1,i)&&c!==s}),c},c.__iteratorUncached=function(e,r){if(0!==s&&r)return this.cacheResult().__iterator(e,r);var i=0!==s&&t.__iterator(e,r),a=0,u=0;return new U(function(){for(;a++<o;)i.next();if(++u>s)return{value:void 0,done:!0};var t=i.next();return n||e===R?t:j(e,u-1,e===D?void 0:t.value[1],t)})},c}function ze(t,e,r,n){var i=$e(t);return i.__iterateUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterate(i,o);var s=!0,u=0;return t.__iterate(function(t,o,c){if(!s||!(s=e.call(r,t,o,c)))return u++,i(t,n?o:u-1,a)}),u},i.__iteratorUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterator(i,o);var s=t.__iterator(M,o),u=!0,c=0;return new U(function(){var t,o,l;do{if((t=s.next()).done)return n||i===R?t:j(i,c++,i===D?void 0:t.value[1],t);var h=t.value;o=h[0],l=h[1],u&&(u=e.call(r,l,o,a))}while(u);return i===M?t:j(i,o,l,t)})},i}function Ge(t,e,r){var n=$e(t);return n.__iterateUncached=function(n,i){var o=0,s=!1;return function t(u,c){var l=this;u.__iterate(function(i,u){return(!e||c<e)&&a(i)?t(i,c+1):!1===n(i,r?u:o++,l)&&(s=!0),!s},i)}(t,0),o},n.__iteratorUncached=function(n,i){var o=t.__iterator(n,i),s=[],u=0;return new U(function(){for(;o;){var t=o.next();if(!1===t.done){var c=t.value;if(n===M&&(c=c[1]),e&&!(s.length<e)||!a(c))return r?t:j(n,u++,c,t);s.push(o),o=c.__iterator(n,i)}else o=s.pop()}return{value:void 0,done:!0}})},n}function Ye(t,e,r){e||(e=er);var n=s(t),i=0,o=t.toSeq().map(function(e,n){return[n,e,i++,r?r(e,n,t):e]}).toArray();return o.sort(function(t,r){return e(t[3],r[3])||t[2]-r[2]}).forEach(n?function(t,e){o[e].length=2}:function(t,e){o[e]=t[1]}),n?W(o):u(t)?J(o):K(o)}function He(t,e,r){if(e||(e=er),r){var n=t.toSeq().map(function(e,n){return[e,r(e,n,t)]}).reduce(function(t,r){return We(e,t[1],r[1])?r:t});return n&&n[0]}return t.reduce(function(t,r){return We(e,t,r)?r:t})}function We(t,e,r){var n=t(r,e);return 0===n&&r!==e&&(void 0===r||null===r||r!=r)||n>0}function Je(t,e,n){var i=$e(t);return i.size=new tt(n).map(function(t){return t.size}).min(),i.__iterate=function(t,e){for(var r,n=this.__iterator(R,e),i=0;!(r=n.next()).done&&!1!==t(r.value,i++,this););return i},i.__iteratorUncached=function(t,i){var o=n.map(function(t){return t=r(t),z(i?t.reverse():t)}),a=0,s=!1;return new U(function(){var r;return s||(r=o.map(function(t){return t.next()}),s=r.some(function(t){return t.done})),s?{value:void 0,done:!0}:j(t,a++,e.apply(null,r.map(function(t){return t.value})))})},i}function Ke(t,e){return it(t)?e:t.constructor(e)}function Xe(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Ze(t){return Bt(t.size),E(t)}function Qe(t){return s(t)?n:u(t)?i:o}function $e(t){return Object.create((s(t)?W:u(t)?J:K).prototype)}function tr(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):H.prototype.cacheResult.call(this)}function er(t,e){return t>e?1:t<e?-1:0}function rr(t){var e=z(t);if(!e){if(!Y(t))throw new TypeError("Expected iterable or array-like: "+t);e=z(r(t))}return e}function nr(t,e){var r,n=function(o){if(o instanceof n)return o;if(!(this instanceof n))return new n(o);if(!r){r=!0;var a=Object.keys(t);!function(t,e){try{e.forEach(function(t,e){Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){vt(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}.bind(void 0,t))}catch(t){}}(i,a),i.size=a.length,i._name=e,i._keys=a,i._defaultValues=t}this._map=Ut(o)},i=n.prototype=Object.create(ir);return i.constructor=n,n}e(Ne,Ut),Ne.of=function(){return this(arguments)},Ne.prototype.toString=function(){return this.__toString("OrderedMap {","}")},Ne.prototype.get=function(t,e){var r=this._map.get(t);return void 0!==r?this._list.get(r)[1]:e},Ne.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):De()},Ne.prototype.set=function(t,e){return Re(this,t,e)},Ne.prototype.remove=function(t){return Re(this,t,_)},Ne.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},Ne.prototype.__iterate=function(t,e){var r=this;return this._list.__iterate(function(e){return e&&t(e[1],e[0],r)},e)},Ne.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},Ne.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),r=this._list.__ensureOwner(t);return t?Ce(e,r,t,this.__hash):(this.__ownerID=t,this._map=e,this._list=r,this)},Ne.isOrderedMap=xe,Ne.prototype[d]=!0,Ne.prototype.delete=Ne.prototype.remove,e(Me,W),Me.prototype.get=function(t,e){return this._iter.get(t,e)},Me.prototype.has=function(t){return this._iter.has(t)},Me.prototype.valueSeq=function(){return this._iter.valueSeq()},Me.prototype.reverse=function(){var t=this,e=Fe(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},Me.prototype.map=function(t,e){var r=this,n=je(this,t,e);return this._useKeys||(n.valueSeq=function(){return r._iter.toSeq().map(t,e)}),n},Me.prototype.__iterate=function(t,e){var r,n=this;return this._iter.__iterate(this._useKeys?function(e,r){return t(e,r,n)}:(r=e?Ze(this):0,function(i){return t(i,e?--r:r++,n)}),e)},Me.prototype.__iterator=function(t,e){if(this._useKeys)return this._iter.__iterator(t,e);var r=this._iter.__iterator(R,e),n=e?Ze(this):0;return new U(function(){var i=r.next();return i.done?i:j(t,e?--n:n++,i.value,i)})},Me.prototype[d]=!0,e(Le,J),Le.prototype.includes=function(t){return this._iter.includes(t)},Le.prototype.__iterate=function(t,e){var r=this,n=0;return this._iter.__iterate(function(e){return t(e,n++,r)},e)},Le.prototype.__iterator=function(t,e){var r=this._iter.__iterator(R,e),n=0;return new U(function(){var e=r.next();return e.done?e:j(t,n++,e.value,e)})},e(Pe,K),Pe.prototype.has=function(t){return this._iter.includes(t)},Pe.prototype.__iterate=function(t,e){var r=this;return this._iter.__iterate(function(e){return t(e,e,r)},e)},Pe.prototype.__iterator=function(t,e){var r=this._iter.__iterator(R,e);return new U(function(){var e=r.next();return e.done?e:j(t,e.value,e.value,e)})},e(Be,W),Be.prototype.entrySeq=function(){return this._iter.toSeq()},Be.prototype.__iterate=function(t,e){var r=this;return this._iter.__iterate(function(e){if(e){Xe(e);var n=a(e);return t(n?e.get(1):e[1],n?e.get(0):e[0],r)}},e)},Be.prototype.__iterator=function(t,e){var r=this._iter.__iterator(R,e);return new U(function(){for(;;){var e=r.next();if(e.done)return e;var n=e.value;if(n){Xe(n);var i=a(n);return j(t,i?n.get(0):n[0],i?n.get(1):n[1],e)}}})},Le.prototype.cacheResult=Me.prototype.cacheResult=Pe.prototype.cacheResult=Be.prototype.cacheResult=tr,e(nr,bt),nr.prototype.toString=function(){return this.__toString(ar(this)+" {","}")},nr.prototype.has=function(t){return this._defaultValues.hasOwnProperty(t)},nr.prototype.get=function(t,e){if(!this.has(t))return e;var r=this._defaultValues[t];return this._map?this._map.get(t,r):r},nr.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var t=this.constructor;return t._empty||(t._empty=or(this,Qt()))},nr.prototype.set=function(t,e){if(!this.has(t))throw new Error('Cannot set unknown key "'+t+'" on '+ar(this));if(this._map&&!this._map.has(t)){var r=this._defaultValues[t];if(e===r)return this}var n=this._map&&this._map.set(t,e);return this.__ownerID||n===this._map?this:or(this,n)},nr.prototype.remove=function(t){if(!this.has(t))return this;var e=this._map&&this._map.remove(t);return this.__ownerID||e===this._map?this:or(this,e)},nr.prototype.wasAltered=function(){return this._map.wasAltered()},nr.prototype.__iterator=function(t,e){var r=this;return n(this._defaultValues).map(function(t,e){return r.get(e)}).__iterator(t,e)},nr.prototype.__iterate=function(t,e){var r=this;return n(this._defaultValues).map(function(t,e){return r.get(e)}).__iterate(t,e)},nr.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map&&this._map.__ensureOwner(t);return t?or(this,e,t):(this.__ownerID=t,this._map=e,this)};var ir=nr.prototype;function or(t,e,r){var n=Object.create(Object.getPrototypeOf(t));return n._map=e,n.__ownerID=r,n}function ar(t){return t._name||t.constructor.name||"Record"}function sr(t){return null===t||void 0===t?dr():ur(t)&&!l(t)?t:dr().withMutations(function(e){var r=o(t);Bt(r.size),r.forEach(function(t){return e.add(t)})})}function ur(t){return!(!t||!t[lr])}ir.delete=ir.remove,ir.deleteIn=ir.removeIn=qt.removeIn,ir.merge=qt.merge,ir.mergeWith=qt.mergeWith,ir.mergeIn=qt.mergeIn,ir.mergeDeep=qt.mergeDeep,ir.mergeDeepWith=qt.mergeDeepWith,ir.mergeDeepIn=qt.mergeDeepIn,ir.setIn=qt.setIn,ir.update=qt.update,ir.updateIn=qt.updateIn,ir.withMutations=qt.withMutations,ir.asMutable=qt.asMutable,ir.asImmutable=qt.asImmutable,e(sr,Tt),sr.of=function(){return this(arguments)},sr.fromKeys=function(t){return this(n(t).keySeq())},sr.prototype.toString=function(){return this.__toString("Set {","}")},sr.prototype.has=function(t){return this._map.has(t)},sr.prototype.add=function(t){return fr(this,this._map.set(t,!0))},sr.prototype.remove=function(t){return fr(this,this._map.remove(t))},sr.prototype.clear=function(){return fr(this,this._map.clear())},sr.prototype.union=function(){var e=t.call(arguments,0);return 0===(e=e.filter(function(t){return 0!==t.size})).length?this:0!==this.size||this.__ownerID||1!==e.length?this.withMutations(function(t){for(var r=0;r<e.length;r++)o(e[r]).forEach(function(e){return t.add(e)})}):this.constructor(e[0])},sr.prototype.intersect=function(){var e=t.call(arguments,0);if(0===e.length)return this;e=e.map(function(t){return o(t)});var r=this;return this.withMutations(function(t){r.forEach(function(r){e.every(function(t){return t.includes(r)})||t.remove(r)})})},sr.prototype.subtract=function(){var e=t.call(arguments,0);if(0===e.length)return this;e=e.map(function(t){return o(t)});var r=this;return this.withMutations(function(t){r.forEach(function(r){e.some(function(t){return t.includes(r)})&&t.remove(r)})})},sr.prototype.merge=function(){return this.union.apply(this,arguments)},sr.prototype.mergeWith=function(e){var r=t.call(arguments,1);return this.union.apply(this,r)},sr.prototype.sort=function(t){return gr(Ye(this,t))},sr.prototype.sortBy=function(t,e){return gr(Ye(this,e,t))},sr.prototype.wasAltered=function(){return this._map.wasAltered()},sr.prototype.__iterate=function(t,e){var r=this;return this._map.__iterate(function(e,n){return t(n,n,r)},e)},sr.prototype.__iterator=function(t,e){return this._map.map(function(t,e){return e}).__iterator(t,e)},sr.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):(this.__ownerID=t,this._map=e,this)},sr.isSet=ur;var cr,lr="@@__IMMUTABLE_SET__@@",hr=sr.prototype;function fr(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function pr(t,e){var r=Object.create(hr);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}function dr(){return cr||(cr=pr(Qt()))}function gr(t){return null===t||void 0===t?br():mr(t)?t:br().withMutations(function(e){var r=o(t);Bt(r.size),r.forEach(function(t){return e.add(t)})})}function mr(t){return ur(t)&&l(t)}hr[lr]=!0,hr.delete=hr.remove,hr.mergeDeep=hr.merge,hr.mergeDeepWith=hr.mergeWith,hr.withMutations=qt.withMutations,hr.asMutable=qt.asMutable,hr.asImmutable=qt.asImmutable,hr.__empty=dr,hr.__make=pr,e(gr,sr),gr.of=function(){return this(arguments)},gr.fromKeys=function(t){return this(n(t).keySeq())},gr.prototype.toString=function(){return this.__toString("OrderedSet {","}")},gr.isOrderedSet=mr;var vr,_r=gr.prototype;function yr(t,e){var r=Object.create(_r);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}function br(){return vr||(vr=yr(De()))}function kr(t){return null===t||void 0===t?Ar():Tr(t)?t:Ar().unshiftAll(t)}function Tr(t){return!(!t||!t[wr])}_r[d]=!0,_r.__empty=br,_r.__make=yr,e(kr,kt),kr.of=function(){return this(arguments)},kr.prototype.toString=function(){return this.__toString("Stack [","]")},kr.prototype.get=function(t,e){var r=this._head;for(t=I(this,t);r&&t--;)r=r.next;return r?r.value:e},kr.prototype.peek=function(){return this._head&&this._head.value},kr.prototype.push=function(){if(0===arguments.length)return this;for(var t=this.size+arguments.length,e=this._head,r=arguments.length-1;r>=0;r--)e={value:arguments[r],next:e};return this.__ownerID?(this.size=t,this._head=e,this.__hash=void 0,this.__altered=!0,this):Ir(t,e)},kr.prototype.pushAll=function(t){if(0===(t=i(t)).size)return this;Bt(t.size);var e=this.size,r=this._head;return t.reverse().forEach(function(t){e++,r={value:t,next:r}}),this.__ownerID?(this.size=e,this._head=r,this.__hash=void 0,this.__altered=!0,this):Ir(e,r)},kr.prototype.pop=function(){return this.slice(1)},kr.prototype.unshift=function(){return this.push.apply(this,arguments)},kr.prototype.unshiftAll=function(t){return this.pushAll(t)},kr.prototype.shift=function(){return this.pop.apply(this,arguments)},kr.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Ar()},kr.prototype.slice=function(t,e){if(O(t,e,this.size))return this;var r=N(t,this.size),n=x(e,this.size);if(n!==this.size)return kt.prototype.slice.call(this,t,e);for(var i=this.size-r,o=this._head;r--;)o=o.next;return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):Ir(i,o)},kr.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Ir(this.size,this._head,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},kr.prototype.__iterate=function(t,e){if(e)return this.reverse().__iterate(t);for(var r=0,n=this._head;n&&!1!==t(n.value,r++,this);)n=n.next;return r},kr.prototype.__iterator=function(t,e){if(e)return this.reverse().__iterator(t);var r=0,n=this._head;return new U(function(){if(n){var e=n.value;return n=n.next,j(t,r++,e)}return{value:void 0,done:!0}})},kr.isStack=Tr;var Sr,wr="@@__IMMUTABLE_STACK__@@",Er=kr.prototype;function Ir(t,e,r,n){var i=Object.create(Er);return i.size=t,i._head=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function Ar(){return Sr||(Sr=Ir(0))}function Or(t,e){var r=function(r){t.prototype[r]=e[r]};return Object.keys(e).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(r),t}Er[wr]=!0,Er.withMutations=qt.withMutations,Er.asMutable=qt.asMutable,Er.asImmutable=qt.asImmutable,Er.wasAltered=qt.wasAltered,r.Iterator=U,Or(r,{toArray:function(){Bt(this.size);var t=new Array(this.size||0);return this.valueSeq().__iterate(function(e,r){t[r]=e}),t},toIndexedSeq:function(){return new Le(this)},toJS:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJS?t.toJS():t}).__toJS()},toJSON:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJSON?t.toJSON():t}).__toJS()},toKeyedSeq:function(){return new Me(this,!0)},toMap:function(){return Ut(this.toKeyedSeq())},toObject:function(){Bt(this.size);var t={};return this.__iterate(function(e,r){t[r]=e}),t},toOrderedMap:function(){return Ne(this.toKeyedSeq())},toOrderedSet:function(){return gr(s(this)?this.valueSeq():this)},toSet:function(){return sr(s(this)?this.valueSeq():this)},toSetSeq:function(){return new Pe(this)},toSeq:function(){return u(this)?this.toIndexedSeq():s(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return kr(s(this)?this.valueSeq():this)},toList:function(){return fe(s(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){var e=t.call(arguments,0);return Ke(this,function(t,e){var r=s(t),i=[t].concat(e).map(function(t){return a(t)?r&&(t=n(t)):t=r?at(t):st(Array.isArray(t)?t:[t]),t}).filter(function(t){return 0!==t.size});if(0===i.length)return t;if(1===i.length){var o=i[0];if(o===t||r&&s(o)||u(t)&&u(o))return o}var c=new tt(i);return r?c=c.toKeyedSeq():u(t)||(c=c.toSetSeq()),(c=c.flatten(!0)).size=i.reduce(function(t,e){if(void 0!==t){var r=e.size;if(void 0!==r)return t+r}},0),c}(this,e))},includes:function(t){return this.some(function(e){return dt(e,t)})},entries:function(){return this.__iterator(M)},every:function(t,e){Bt(this.size);var r=!0;return this.__iterate(function(n,i,o){if(!t.call(e,n,i,o))return r=!1,!1}),r},filter:function(t,e){return Ke(this,Ve(this,t,e,!0))},find:function(t,e,r){var n=this.findEntry(t,e);return n?n[1]:r},forEach:function(t,e){return Bt(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){Bt(this.size),t=void 0!==t?""+t:",";var e="",r=!0;return this.__iterate(function(n){r?r=!1:e+=t,e+=null!==n&&void 0!==n?n.toString():""}),e},keys:function(){return this.__iterator(D)},map:function(t,e){return Ke(this,je(this,t,e))},reduce:function(t,e,r){var n,i;return Bt(this.size),arguments.length<2?i=!0:n=e,this.__iterate(function(e,o,a){i?(i=!1,n=e):n=t.call(r,n,e,o,a)}),n},reduceRight:function(t,e,r){var n=this.toKeyedSeq().reverse();return n.reduce.apply(n,arguments)},reverse:function(){return Ke(this,Fe(this,!0))},slice:function(t,e){return Ke(this,qe(this,t,e,!0))},some:function(t,e){return!this.every(Rr(t),e)},sort:function(t){return Ke(this,Ye(this,t))},values:function(){return this.__iterator(R)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(t,e){return E(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return function(t,e,r){var n=Ut().asMutable();return t.__iterate(function(i,o){n.update(e.call(r,i,o,t),0,function(t){return t+1})}),n.asImmutable()}(this,t,e)},equals:function(t){return gt(this,t)},entrySeq:function(){var t=this;if(t._cache)return new tt(t._cache);var e=t.toSeq().map(Dr).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(Rr(t),e)},findEntry:function(t,e,r){var n=r;return this.__iterate(function(r,i,o){if(t.call(e,r,i,o))return n=[i,r],!1}),n},findKey:function(t,e){var r=this.findEntry(t,e);return r&&r[0]},findLast:function(t,e,r){return this.toKeyedSeq().reverse().find(t,e,r)},findLastEntry:function(t,e,r){return this.toKeyedSeq().reverse().findEntry(t,e,r)},findLastKey:function(t,e){return this.toKeyedSeq().reverse().findKey(t,e)},first:function(){return this.find(A)},flatMap:function(t,e){return Ke(this,function(t,e,r){var n=Qe(t);return t.toSeq().map(function(i,o){return n(e.call(r,i,o,t))}).flatten(!0)}(this,t,e))},flatten:function(t){return Ke(this,Ge(this,t,!0))},fromEntrySeq:function(){return new Be(this)},get:function(t,e){return this.find(function(e,r){return dt(r,t)},void 0,e)},getIn:function(t,e){for(var r,n=this,i=rr(t);!(r=i.next()).done;){var o=r.value;if((n=n&&n.get?n.get(o,_):_)===_)return e}return n},groupBy:function(t,e){return function(t,e,r){var n=s(t),i=(l(t)?Ne():Ut()).asMutable();t.__iterate(function(o,a){i.update(e.call(r,o,a,t),function(t){return(t=t||[]).push(n?[a,o]:o),t})});var o=Qe(t);return i.map(function(e){return Ke(t,o(e))})}(this,t,e)},has:function(t){return this.get(t,_)!==_},hasIn:function(t){return this.getIn(t,_)!==_},isSubset:function(t){return t="function"==typeof t.includes?t:r(t),this.every(function(e){return t.includes(e)})},isSuperset:function(t){return(t="function"==typeof t.isSubset?t:r(t)).isSubset(this)},keyOf:function(t){return this.findKey(function(e){return dt(e,t)})},keySeq:function(){return this.toSeq().map(Cr).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return He(this,t)},maxBy:function(t,e){return He(this,e,t)},min:function(t){return He(this,t?Mr(t):Br)},minBy:function(t,e){return He(this,e?Mr(e):Br,t)},rest:function(){return this.slice(1)},skip:function(t){return this.slice(Math.max(0,t))},skipLast:function(t){return Ke(this,this.toSeq().reverse().skip(t).reverse())},skipWhile:function(t,e){return Ke(this,ze(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(Rr(t),e)},sortBy:function(t,e){return Ke(this,Ye(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return Ke(this,this.toSeq().reverse().take(t).reverse())},takeWhile:function(t,e){return Ke(this,function(t,e,r){var n=$e(t);return n.__iterateUncached=function(n,i){var o=this;if(i)return this.cacheResult().__iterate(n,i);var a=0;return t.__iterate(function(t,i,s){return e.call(r,t,i,s)&&++a&&n(t,i,o)}),a},n.__iteratorUncached=function(n,i){var o=this;if(i)return this.cacheResult().__iterator(n,i);var a=t.__iterator(M,i),s=!0;return new U(function(){if(!s)return{value:void 0,done:!0};var t=a.next();if(t.done)return t;var i=t.value,u=i[0],c=i[1];return e.call(r,c,u,o)?n===M?t:j(n,u,c,t):(s=!1,{value:void 0,done:!0})})},n}(this,t,e))},takeUntil:function(t,e){return this.takeWhile(Rr(t),e)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(t){if(t.size===1/0)return 0;var e=l(t),r=s(t),n=e?1:0;return function(t,e){return e=St(e,3432918353),e=St(e<<15|e>>>-15,461845907),e=St(e<<13|e>>>-13,5),e=St((e=(e+3864292196|0)^t)^e>>>16,2246822507),e=wt((e=St(e^e>>>13,3266489909))^e>>>16)}(t.__iterate(r?e?function(t,e){n=31*n+Ur(Et(t),Et(e))|0}:function(t,e){n=n+Ur(Et(t),Et(e))|0}:e?function(t){n=31*n+Et(t)|0}:function(t){n=n+Et(t)|0}),n)}(this))}});var Nr=r.prototype;Nr[h]=!0,Nr[B]=Nr.values,Nr.__toJS=Nr.toArray,Nr.__toStringMapper=Lr,Nr.inspect=Nr.toSource=function(){return this.toString()},Nr.chain=Nr.flatMap,Nr.contains=Nr.includes,Or(n,{flip:function(){return Ke(this,Ue(this))},mapEntries:function(t,e){var r=this,n=0;return Ke(this,this.toSeq().map(function(i,o){return t.call(e,[o,i],n++,r)}).fromEntrySeq())},mapKeys:function(t,e){var r=this;return Ke(this,this.toSeq().flip().map(function(n,i){return t.call(e,n,i,r)}).flip())}});var xr=n.prototype;function Cr(t,e){return e}function Dr(t,e){return[e,t]}function Rr(t){return function(){return!t.apply(this,arguments)}}function Mr(t){return function(){return-t.apply(this,arguments)}}function Lr(t){return"string"==typeof t?JSON.stringify(t):String(t)}function Pr(){return w(arguments)}function Br(t,e){return t<e?1:t>e?-1:0}function Ur(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}return xr[f]=!0,xr[B]=Nr.entries,xr.__toJS=Nr.toObject,xr.__toStringMapper=function(t,e){return JSON.stringify(e)+": "+Lr(t)},Or(i,{toKeyedSeq:function(){return new Me(this,!1)},filter:function(t,e){return Ke(this,Ve(this,t,e,!1))},findIndex:function(t,e){var r=this.findEntry(t,e);return r?r[0]:-1},indexOf:function(t){var e=this.keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){var e=this.lastKeyOf(t);return void 0===e?-1:e},reverse:function(){return Ke(this,Fe(this,!1))},slice:function(t,e){return Ke(this,qe(this,t,e,!1))},splice:function(t,e){var r=arguments.length;if(e=Math.max(0|e,0),0===r||2===r&&!e)return this;t=N(t,t<0?this.count():this.size);var n=this.slice(0,t);return Ke(this,1===r?n:n.concat(w(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var r=this.findLastEntry(t,e);return r?r[0]:-1},first:function(){return this.get(0)},flatten:function(t){return Ke(this,Ge(this,t,!1))},get:function(t,e){return(t=I(this,t))<0||this.size===1/0||void 0!==this.size&&t>this.size?e:this.find(function(e,r){return r===t},void 0,e)},has:function(t){return(t=I(this,t))>=0&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return Ke(this,function(t,e){var r=$e(t);return r.size=t.size&&2*t.size-1,r.__iterateUncached=function(r,n){var i=this,o=0;return t.__iterate(function(t,n){return(!o||!1!==r(e,o++,i))&&!1!==r(t,o++,i)},n),o},r.__iteratorUncached=function(r,n){var i,o=t.__iterator(R,n),a=0;return new U(function(){return(!i||a%2)&&(i=o.next()).done?i:a%2?j(r,a++,e):j(r,a++,i.value,i)})},r}(this,t))},interleave:function(){var t=[this].concat(w(arguments)),e=Je(this.toSeq(),J.of,t),r=e.flatten(!0);return e.size&&(r.size=e.size*t.length),Ke(this,r)},keySeq:function(){return _t(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(t,e){return Ke(this,ze(this,t,e,!1))},zip:function(){return Ke(this,Je(this,Pr,[this].concat(w(arguments))))},zipWith:function(t){var e=w(arguments);return e[0]=this,Ke(this,Je(this,t,e))}}),i.prototype[p]=!0,i.prototype[d]=!0,Or(o,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),o.prototype.has=Nr.includes,o.prototype.contains=o.prototype.includes,Or(W,n.prototype),Or(J,i.prototype),Or(K,o.prototype),Or(bt,n.prototype),Or(kt,i.prototype),Or(Tt,o.prototype),{Iterable:r,Seq:H,Collection:yt,Map:Ut,OrderedMap:Ne,List:fe,Stack:kr,Set:sr,OrderedSet:gr,Record:nr,Range:_t,Repeat:mt,is:dt,fromJS:ht}}()},function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=r(60),a=r(41),s=r(21),u=r(83),c=r(4),l=r(19).Map,h=r(55),f=r(56),p=r(3),d=r(34),g=r(9),m=r(48),v=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e,this._blocks={},this._scripts=[],Object.defineProperty(this,"_cache",{writable:!0,enumerable:!1}),this._cache={inputs:{},procedureParamNames:{},procedureDefinitions:{},_executeCached:{},_monitored:null,scripts:{}},this.forceNoGlow=r||!1}return function(t,e,r){e&&i(t.prototype,e),r&&i(t,r)}(t,[{key:"getBlock",value:function(t){return this._blocks[t]}},{key:"getScripts",value:function(){return this._scripts}},{key:"getNextBlock",value:function(t){var e=this._blocks[t];return void 0===e?null:e.next}},{key:"getBranch",value:function(e,r){var n=this._blocks[e];if(void 0===n)return null;r||(r=1);var i=t.BRANCH_INPUT_PREFIX;r>1&&(i+=r);var o=n.inputs[i];return void 0===o?null:o.block}},{key:"getOpcode",value:function(t){return void 0===t?null:t.opcode}},{key:"getFields",value:function(t){return void 0===t?null:t.fields}},{key:"getInputs",value:function(e){if(void 0===e)return null;var r=this._cache.inputs[e.id];if(void 0!==r)return r;for(var n in r={},e.inputs)n.substring(0,t.BRANCH_INPUT_PREFIX.length)!==t.BRANCH_INPUT_PREFIX&&(r[n]=e.inputs[n]);return this._cache.inputs[e.id]=r,r}},{key:"getMutation",value:function(t){return void 0===t?null:t.mutation}},{key:"getTopLevelScript",value:function(t){var e=this._blocks[t];if(void 0===e)return null;for(;null!==e.parent;)e=this._blocks[e.parent];return e.id}},{key:"getProcedureDefinition",value:function(t){var e=this._cache.procedureDefinitions[t];if(void 0!==e)return e;for(var r in this._blocks)if(this._blocks.hasOwnProperty(r)){var n=this._blocks[r];if("procedures_definition"===n.opcode){var i=this._getCustomBlockInternal(n);if(i&&i.mutation.proccode===t)return this._cache.procedureDefinitions[t]=r,r}}return this._cache.procedureDefinitions[t]=null,null}},{key:"getProcedureParamNamesAndIds",value:function(t){return this.getProcedureParamNamesIdsAndDefaults(t).slice(0,2)}},{key:"getProcedureParamNamesIdsAndDefaults",value:function(t){var e=this._cache.procedureParamNames[t];if(void 0!==e)return e;for(var r in this._blocks)if(this._blocks.hasOwnProperty(r)){var n=this._blocks[r];if("procedures_prototype"===n.opcode&&n.mutation.proccode===t){var i=JSON.parse(n.mutation.argumentnames),o=JSON.parse(n.mutation.argumentids),a=JSON.parse(n.mutation.argumentdefaults);return this._cache.procedureParamNames[t]=[i,o,a],this._cache.procedureParamNames[t]}}return this._cache.procedureParamNames[t]=null,null}},{key:"duplicate",value:function(){var e=new t(this.runtime,this.forceNoGlow);return e._blocks=c.simple(this._blocks),e._scripts=c.simple(this._scripts),this.resetBlockIDs(e),e}},{key:"resetBlockIDs",value:function(t){var e={},r=t._blocks,n={},i=[];for(var o in r){var a=g();e[o]=a}for(var s in r){var u=r[s];u.id=e[s],u.next&&(u.next=e[u.next]),u.parent&&(u.parent=e[u.parent]);var c=u.inputs;if(c)for(var l in c){var h=c[l];h.block&&(h.block=e[h.block]),h.shadow&&(h.shadow=e[h.shadow])}n[u.id]=u}t._blocks=n;var f=!0,p=!1,d=void 0;try{for(var m,v=t._scripts[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var _=m.value;i.push(e[_])}}catch(t){p=!0,d=t}finally{try{f||null==v.return||v.return()}finally{if(p)throw d}}t._scripts=i}},{key:"blocklyListen",value:function(t){if("object"===n(t)&&("string"==typeof t.blockId||"string"==typeof t.varId||"string"==typeof t.commentId)){var e=this.runtime.getTargetForStage(),r=this.runtime.getEditingTarget();if("stackclick"!==t.element)switch(t.type){case"create":for(var i=o(t),a=0;a<i.length;a++)this.createBlock(i[a]);break;case"change":this.changeBlock({id:t.blockId,element:t.element,name:t.name,value:t.newValue});break;case"move":this.moveBlock({id:t.blockId,oldParent:t.oldParentId,oldInput:t.oldInputName,newParent:t.newParentId,newInput:t.newInputName,newCoordinate:t.newCoordinate});break;case"dragOutside":this.runtime.emitBlockDragUpdate(t.isOutside);break;case"endDrag":if(this.runtime.emitBlockDragUpdate(!1),t.isOutside){var s=o(t);this.runtime.emitBlockEndDrag(s,t.blockId)}break;case"delete":if(!this._blocks.hasOwnProperty(t.blockId)||this._blocks[t.blockId].shadow)return;this._blocks[t.blockId].topLevel&&this.runtime.quietGlow(t.blockId),this.deleteBlock(t.blockId);break;case"var_create":if(t.isLocal&&r&&!r.isStage&&!t.isCloud)r.lookupVariableById(t.varId)||(r.createVariable(t.varId,t.varName,t.varType),this.emitProjectChanged());else{if(e.lookupVariableById(t.varId))return;var u=this.runtime.targets.filter(function(t){return t.isOriginal}),c=!0,l=!1,h=void 0;try{for(var f,d=u[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){if(f.value.lookupVariableByNameAndType(t.varName,t.varType,!0))return}}catch(t){l=!0,h=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}e.createVariable(t.varId,t.varName,t.varType,t.isCloud),this.emitProjectChanged()}break;case"var_rename":if(r&&r.variables.hasOwnProperty(t.varId))r.renameVariable(t.varId,t.newName),r.blocks.updateBlocksAfterVarRename(t.varId,t.newName);else{e.renameVariable(t.varId,t.newName);for(var g=this.runtime.targets,m=0;m<g.length;m++){g[m].blocks.updateBlocksAfterVarRename(t.varId,t.newName)}}this.emitProjectChanged();break;case"var_delete":(r&&r.variables.hasOwnProperty(t.varId)?r:e).deleteVariable(t.varId),this.emitProjectChanged();break;case"comment_create":if(this.runtime.getEditingTarget()){var v=this.runtime.getEditingTarget();v.createComment(t.commentId,t.blockId,t.text,t.xy.x,t.xy.y,t.width,t.height,t.minimized),null===v.comments[t.commentId].x&&null===v.comments[t.commentId].y&&(v.comments[t.commentId].x=t.xy.x,v.comments[t.commentId].y=t.xy.y)}this.emitProjectChanged();break;case"comment_change":if(this.runtime.getEditingTarget()){var _=this.runtime.getEditingTarget();if(!_.comments.hasOwnProperty(t.commentId))return void p.warn("Cannot change comment with id ".concat(t.commentId," because it does not exist."));var y=_.comments[t.commentId],b=t.newContents_;b.hasOwnProperty("minimized")&&(y.minimized=b.minimized),b.hasOwnProperty("width")&&b.hasOwnProperty("height")&&(y.width=b.width,y.height=b.height),b.hasOwnProperty("text")&&(y.text=b.text),this.emitProjectChanged()}break;case"comment_move":if(this.runtime.getEditingTarget()){var k=this.runtime.getEditingTarget();if(k&&!k.comments.hasOwnProperty(t.commentId))return void p.warn("Cannot change comment with id ".concat(t.commentId," because it does not exist."));var T=k.comments[t.commentId],S=t.newCoordinate_;T.x=S.x,T.y=S.y,this.emitProjectChanged()}break;case"comment_delete":if(this.runtime.getEditingTarget()){var w=this.runtime.getEditingTarget();if(!w.comments.hasOwnProperty(t.commentId))return;if(delete w.comments[t.commentId],t.blockId){var E=w.blocks.getBlock(t.blockId);if(!E)return void p.warn("Could not find block referenced by comment with id: ".concat(t.commentId));delete E.comment}this.emitProjectChanged()}}else this.runtime.toggleScript(t.blockId,{stackClick:!0})}}},{key:"resetCache",value:function(){this._cache.inputs={},this._cache.procedureParamNames={},this._cache.procedureDefinitions={},this._cache._executeCached={},this._cache._monitored=null,this._cache.scripts={}}},{key:"emitProjectChanged",value:function(){this.forceNoGlow||this.runtime.emitProjectChanged()}},{key:"createBlock",value:function(t){this._blocks.hasOwnProperty(t.id)||(this._blocks[t.id]=t,t.topLevel&&this._addScript(t.id),this.resetCache(),this.emitProjectChanged())}},{key:"changeBlock",value:function(t){if(-1!==["field","mutation","checkbox"].indexOf(t.element)){var e=this._blocks[t.id];if(void 0!==e){switch(t.element){case"field":if(!e.fields[t.name])return;if("VARIABLE"===t.name||"LIST"===t.name||"BROADCAST_OPTION"===t.name){var r=this.runtime.getEditingTarget().lookupVariableById(t.value);r&&(e.fields[t.name].value=r.name,e.fields[t.name].id=t.value)}else{var n,i;if(e.fields[t.name].value=t.value,"sensing_of_object_menu"===e.opcode&&("_stage_"===e.fields.OBJECT.value?this._blocks[e.parent].fields.PROPERTY.value="backdrop #":this._blocks[e.parent].fields.PROPERTY.value="x position",this.runtime.requestBlocksUpdate()),e.shadow&&e.parent){n=this._blocks[e.parent];var o=this.runtime.monitorBlockInfo[n.opcode];o&&o.isSpriteSpecific&&o.getId&&(n.targetId=n.targetId||this.runtime.getEditingTarget().id,i=o.getId(n.targetId,this._getBlockParams(n)),this.runtime._monitorState.has(i)||(i=null))}else e.isMonitored&&(n=e,i=e.id);i&&this.runtime.requestUpdateMonitor(l({id:i,params:this._getBlockParams(n)}))}break;case"mutation":e.mutation=a(t.value);break;case"checkbox":var s=this._getBlockParams(e);if(s&&Object.keys(s).length>0&&"data_variable"!==e.opcode&&"data_listcontents"!==e.opcode){var c=m(e.id,s),h=this.runtime.monitorBlocks.getBlock(c);if(!h){if(!t.value)return;(h=JSON.parse(JSON.stringify(e))).id=c,this.runtime.monitorBlocks.createBlock(h)}e=h}var f=e.isMonitored;e.isMonitored=t.value;var p=!1;"data_variable"===e.opcode?p=!this.runtime.getTargetForStage().variables[e.fields.VARIABLE.id]:"data_listcontents"===e.opcode&&(p=!this.runtime.getTargetForStage().variables[e.fields.LIST.id]);var d=this.runtime.monitorBlockInfo.hasOwnProperty(e.opcode)&&this.runtime.monitorBlockInfo[e.opcode].isSpriteSpecific;d&&this.runtime.monitorBlockInfo[e.opcode].hasOwnProperty("deviceId")&&(d=!!this.runtime.monitorBlockInfo[e.opcode].deviceId),"function"==typeof d&&(d=d(e));var g=p||d;e.targetId=g?e.targetId||this.runtime.getEditingTarget().id:null,f&&!e.isMonitored?this.runtime.requestHideMonitor(e.id):!f&&e.isMonitored&&(this.runtime.requestShowMonitor(e.id)||this.runtime.requestAddMonitor(u({id:e.id,targetId:e.targetId,spriteName:e.targetId?this.runtime.getTargetById(e.targetId).getName():null,opcode:e.opcode,params:this._getBlockParams(e),value:"",mode:"data_listcontents"===e.opcode?"list":"default"})))}this.emitProjectChanged(),this.resetCache()}}}},{key:"moveBlock",value:function(t){if(this._blocks.hasOwnProperty(t.id)){var e=this._blocks[t.id],r=!1;if(t.newCoordinate&&(r=e.x!==t.newCoordinate.x||e.y!==t.newCoordinate.y,e.x=t.newCoordinate.x,e.y=t.newCoordinate.y),void 0!==t.oldParent){var n=this._blocks[t.oldParent];void 0!==t.oldInput&&n.inputs[t.oldInput].block===t.id?n.inputs[t.oldInput].block=null:n.next===t.id&&(n.next=null),this._blocks[t.id].parent=null,r=!0}if(void 0===t.newParent)this._addScript(t.id);else{if(this._deleteScript(t.id),void 0===t.newInput)this._blocks[t.newParent].next=t.id;else{var i=null;this._blocks[t.newParent].inputs.hasOwnProperty(t.newInput)&&(i=this._blocks[t.newParent].inputs[t.newInput].shadow),this._blocks[t.id].shadow&&(i=t.id),this._blocks[t.newParent].inputs[t.newInput]={name:t.newInput,block:t.id,shadow:i}}this._blocks[t.id].parent=t.newParent,r=!0}this.resetCache(),r&&this.emitProjectChanged()}}},{key:"runAllMonitored",value:function(t){var e=this;null===this._cache._monitored&&(this._cache._monitored=Object.keys(this._blocks).filter(function(t){return e.getBlock(t).isMonitored}).map(function(r){var n=e.getBlock(r).targetId;return{blockId:r,target:n?t.getTargetById(n):null}}));for(var r=this._cache._monitored,n=0;n<r.length;n++){var i=r[n],o=i.blockId,a=i.target;t.addMonitorScript(o,a)}}},{key:"deleteBlock",value:function(t){var e=this._blocks[t];if(e){for(var r in null!==e.next&&this.deleteBlock(e.next),e.inputs)null!==e.inputs[r].block&&this.deleteBlock(e.inputs[r].block),null!==e.inputs[r].shadow&&e.inputs[r].shadow!==e.inputs[r].block&&this.deleteBlock(e.inputs[r].shadow);this._deleteScript(t),delete this._blocks[t],this.resetCache(),this.emitProjectChanged()}}},{key:"getAllVariableAndListReferences",value:function(t,e){var r=t||this._blocks,n=Object.create(null);for(var i in r){var o=null,a=null;if(r[i].fields.VARIABLE?(o=r[i].fields.VARIABLE,a=d.SCALAR_TYPE):r[i].fields.LIST?(o=r[i].fields.LIST,a=d.LIST_TYPE):e&&r[i].fields.BROADCAST_OPTION&&(o=r[i].fields.BROADCAST_OPTION,a=d.BROADCAST_MESSAGE_TYPE),o){var s=o.id;n[s]?n[s].push({referencingField:o,type:a}):n[s]=[{referencingField:o,type:a}]}}return n}},{key:"updateBlocksAfterVarRename",value:function(t,e){var r=this._blocks;for(var n in r){var i=null;if(r[n].fields.VARIABLE?i=r[n].fields.VARIABLE:r[n].fields.LIST&&(i=r[n].fields.LIST),i)t===i.id&&(i.value=e)}}},{key:"updateTargetSpecificBlocks",value:function(t){var e=this._blocks;for(var r in e)t&&"event_whenthisspriteclicked"===e[r].opcode?e[r].opcode="event_whenstageclicked":t||"event_whenstageclicked"!==e[r].opcode||(e[r].opcode="event_whenthisspriteclicked")}},{key:"updateAssetName",value:function(t,e,r){var n;if("costume"===r)n=this._getCostumeField.bind(this);else if("sound"===r)n=this._getSoundField.bind(this);else if("backdrop"===r)n=this._getBackdropField.bind(this);else{if("sprite"!==r)return;n=this._getSpriteField.bind(this)}var i=this._blocks;for(var o in i){var a=n(o);a&&a.value===t&&(a.value=e)}}},{key:"_getCostumeField",value:function(t){var e=this.getBlock(t);return e&&e.fields.hasOwnProperty("COSTUME")?e.fields.COSTUME:null}},{key:"_getSoundField",value:function(t){var e=this.getBlock(t);return e&&e.fields.hasOwnProperty("SOUND_MENU")?e.fields.SOUND_MENU:null}},{key:"_getBackdropField",value:function(t){var e=this.getBlock(t);return e&&e.fields.hasOwnProperty("BACKDROP")?e.fields.BACKDROP:null}},{key:"_getSpriteField",value:function(t){var e=this.getBlock(t);if(!e)return null;for(var r=["TOWARDS","TO","OBJECT","VIDEOONMENU2","DISTANCETOMENU","TOUCHINGOBJECTMENU","CLONE_OPTION"],n=0;n<r.length;n++){var i=r[n];if(e.fields.hasOwnProperty(i))return e.fields[i]}return null}},{key:"toXML",value:function(t){var e=this;return this._scripts.map(function(r){return e.blockToXML(r,t)}).join()}},{key:"blockToXML",value:function(t,e){var r=this._blocks[t];if(r){var n=r.shadow?"shadow":"block",i="<".concat(n,'\n                id="').concat(r.id,'"\n                type="').concat(r.opcode,'"\n                ').concat(r.topLevel?'x="'.concat(r.x,'" y="').concat(r.y,'"'):"","\n            >"),o=r.comment;for(var a in o&&(e?e.hasOwnProperty(o)?i+=e[o].toXML():p.warn("Could not find comment with id: ".concat(o," in provided comment descriptions.")):p.warn("Cannot serialize comment with id: ".concat(o,"; no comment descriptions provided."))),r.mutation&&(i+=this.mutationToXML(r.mutation)),r.inputs)if(r.inputs.hasOwnProperty(a)){var u=r.inputs[a];(u.block||u.shadow)&&(i+='<value name="'.concat(u.name,'">'),u.block&&(i+=this.blockToXML(u.block,e)),u.shadow&&u.shadow!==u.block&&(i+=this.blockToXML(u.shadow,e)),i+="</value>")}for(var c in r.fields)if(r.fields.hasOwnProperty(c)){var l=r.fields[c];i+='<field name="'.concat(l.name,'"');var h=l.id;h&&(i+=' id="'.concat(h,'"'));var f=l.variableType;"string"==typeof f&&(i+=' variabletype="'.concat(f,'"'));var d=l.value;"string"==typeof d&&(d=s(l.value)),i+=">".concat(d,"</field>")}return r.next&&(i+="<next>".concat(this.blockToXML(r.next,e),"</next>")),i+="</".concat(n,">")}}},{key:"mutationToXML",value:function(t){var e="<".concat(t.tagName);for(var r in t)if("children"!==r&&"tagName"!==r){var n="string"==typeof t[r]?s(t[r]):t[r];"blockInfo"===r&&(n=s(JSON.stringify(t[r]))),e+=" ".concat(r,'="').concat(n,'"')}e+=">";for(var i=0;i<t.children.length;i++)e+=this.mutationToXML(t.children[i]);return e+="</".concat(t.tagName,">")}},{key:"_getBlockParams",value:function(t){var e={};for(var r in t.fields)e[r]=t.fields[r].value;for(var n in t.inputs){var i=t.inputs[n].block,o=this.runtime.flyoutBlocks.getBlock(i)||this.getBlock(i);if(o)for(var a in e[n]={},o.fields)e[n][a]=o.fields[a].value}return e}},{key:"_getCustomBlockInternal",value:function(t){if(t.inputs&&t.inputs.custom_block)return this._blocks[t.inputs.custom_block.block]}},{key:"_addScript",value:function(t){this._scripts.indexOf(t)>-1||(this._scripts.push(t),this._blocks[t].topLevel=!0)}},{key:"_deleteScript",value:function(t){var e=this._scripts.indexOf(t);e>-1&&this._scripts.splice(e,1),this._blocks[t]&&(this._blocks[t].topLevel=!1)}}],[{key:"BRANCH_INPUT_PREFIX",get:function(){return"SUBSTACK"}}]),t}();h.getCached=function(t,e,r){var n=t._cache._executeCached[e];if(void 0!==n)return n;var i=t.getBlock(e);return void 0===i?null:(n=void 0===r?{id:e,opcode:t.getOpcode(i),fields:t.getFields(i),inputs:t.getInputs(i),mutation:t.getMutation(i)}:new r(t,{id:e,opcode:t.getOpcode(i),fields:t.getFields(i),inputs:t.getInputs(i),mutation:t.getMutation(i)}),t._cache._executeCached[e]=n,n)};var _=f._RuntimeScriptCache;f.getScripts=function(t,e){var r=t._cache.scripts[e];if(!r){r=t._cache.scripts[e]=[];for(var n=t._scripts,i=0;i<n.length;i++){var o=n[i];t.getBlock(o).opcode===e&&r.push(new _(t,o))}}return r},t.exports=v},function(t,e,r){var n=r(3);t.exports=function(t){if("string"!=typeof t){if(!Array.isArray(t))return n.error("Unexpected input recieved in replaceUnsafeChars"),t;t=String(t)}return t.replace(/[<>&'"]/g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})}},function(t,e,r){var n=r(23),i=n.enable,o=n.disable,a="undefined"!=typeof navigator&&/chrome/i.test(navigator.userAgent),s=r(26);if(n.defaultBackend=a?s.minilog:s,"undefined"!=typeof window){try{n.enable(JSON.parse(window.localStorage.minilogSettings))}catch(t){}if(window.location&&window.location.search){var u=RegExp("[?&]minilog=([^&]*)").exec(window.location.search);u&&n.enable(decodeURIComponent(u[1]))}}n.enable=function(){i.call(n,!0);try{window.localStorage.minilogSettings=JSON.stringify(!0)}catch(t){}return this},n.disable=function(){o.call(n);try{delete window.localStorage.minilogSettings}catch(t){}return this},(t.exports=n).backends={array:r(29),browser:n.defaultBackend,localStorage:r(30),jQuery:r(31)}},function(t,e,r){var n=r(1),i=r(25),o=new n,a=Array.prototype.slice;(e=t.exports=function(t){var r=function(){return o.write(t,void 0,a.call(arguments)),r};return r.debug=function(){return o.write(t,"debug",a.call(arguments)),r},r.info=function(){return o.write(t,"info",a.call(arguments)),r},r.warn=function(){return o.write(t,"warn",a.call(arguments)),r},r.error=function(){return o.write(t,"error",a.call(arguments)),r},r.log=r.debug,r.suggest=e.suggest,r.format=o.format,r}).defaultBackend=e.defaultFormatter=null,e.pipe=function(t){return o.pipe(t)},e.end=e.unpipe=e.disable=function(t){return o.unpipe(t)},e.Transform=n,e.Filter=i,e.suggest=new i,e.enable=function(){return e.defaultFormatter?o.pipe(e.suggest).pipe(e.defaultFormatter).pipe(e.defaultBackend):o.pipe(e.suggest).pipe(e.defaultBackend)}},function(t,e){function r(){this._events={}}r.prototype={on:function(t,e){this._events||(this._events={});var r=this._events;return(r[t]||(r[t]=[])).push(e),this},removeListener:function(t,e){var r,n=this._events[t]||[];for(r=n.length-1;r>=0&&n[r];r--)n[r]!==e&&n[r].cb!==e||n.splice(r,1)},removeAllListeners:function(t){t?this._events[t]&&(this._events[t]=[]):this._events={}},listeners:function(t){return this._events&&this._events[t]||[]},emit:function(t){this._events||(this._events={});var e,r=Array.prototype.slice.call(arguments,1),n=this._events[t]||[];for(e=n.length-1;e>=0&&n[e];e--)n[e].apply(this,r);return this},when:function(t,e){return this.once(t,e,!0)},once:function(t,e,r){if(!e)return this;function n(){r||this.removeListener(t,n),e.apply(this,arguments)&&r&&this.removeListener(t,n)}return n.cb=e,this.on(t,n),this}},r.mixin=function(t){var e,n=r.prototype;for(e in n)n.hasOwnProperty(e)&&(t.prototype[e]=n[e])},t.exports=r},function(t,e,r){var n={debug:1,info:2,warn:3,error:4};function i(){this.enabled=!0,this.defaultResult=!0,this.clear()}function o(t,e){return t.n.test?t.n.test(e):t.n==e}r(1).mixin(i),i.prototype.allow=function(t,e){return this._white.push({n:t,l:n[e]}),this},i.prototype.deny=function(t,e){return this._black.push({n:t,l:n[e]}),this},i.prototype.clear=function(){return this._white=[],this._black=[],this},i.prototype.test=function(t,e){var r,i=Math.max(this._white.length,this._black.length);for(r=0;r<i;r++){if(this._white[r]&&o(this._white[r],t)&&n[e]>=this._white[r].l)return!0;if(this._black[r]&&o(this._black[r],t)&&n[e]<=this._black[r].l)return!1}return this.defaultResult},i.prototype.write=function(t,e,r){if(!this.enabled||this.test(t,e))return this.emit("item",t,e,r)},t.exports=i},function(t,e,r){var n=/\n+$/,i=new(r(1));i.write=function(t,e,r){var i=r.length-1;if("undefined"!=typeof console&&console.log){if(console.log.apply)return console.log.apply(console,[t,e].concat(r));if(JSON&&JSON.stringify){r[i]&&"string"==typeof r[i]&&(r[i]=r[i].replace(n,""));try{for(i=0;i<r.length;i++)r[i]=JSON.stringify(r[i])}catch(t){}console.log(r.join(" "))}}},i.formatters=["color","minilog"],i.color=r(27),i.minilog=r(28),t.exports=i},function(t,e,r){var n=r(1),i=r(13),o={debug:["cyan"],info:["purple"],warn:["yellow",!0],error:["red",!0]},a=new n;a.write=function(t,e,r){console.log;console[e]&&console[e].apply&&console[e].apply(console,["%c"+t+" %c"+e,i("gray"),i.apply(i,o[e])].concat(r))},a.pipe=function(){},t.exports=a},function(t,e,r){var n=r(1),i=r(13),o={debug:["gray"],info:["purple"],warn:["yellow",!0],error:["red",!0]},a=new n;a.write=function(t,e,r){var n=console.log;"debug"!=e&&console[e]&&(n=console[e]);var a=0;if("info"!=e){for(;a<r.length&&"string"==typeof r[a];a++);n.apply(console,["%c"+t+" "+r.slice(0,a).join(" "),i.apply(i,o[e])].concat(r.slice(a)))}else n.apply(console,["%c"+t,i.apply(i,o[e])].concat(r))},a.pipe=function(){},t.exports=a},function(t,e,r){var n=[],i=new(r(1));i.write=function(t,e,r){n.push([t,e,r])},i.get=function(){return n},i.empty=function(){n=[]},t.exports=i},function(t,e,r){var n=!1,i=new(r(1));i.write=function(t,e,r){if("undefined"!=typeof window&&"undefined"!=typeof JSON&&JSON.stringify&&JSON.parse)try{n||(n=window.localStorage.minilog?JSON.parse(window.localStorage.minilog):[]),n.push([(new Date).toString(),t,e,r]),window.localStorage.minilog=JSON.stringify(n)}catch(t){}},t.exports=i},function(t,e,r){var n=r(1),i=(new Date).valueOf().toString(36);function o(t){this.url=t.url||"",this.cache=[],this.timer=null,this.interval=t.interval||3e4,this.enabled=!0,this.jQuery=window.jQuery,this.extras={}}n.mixin(o),o.prototype.write=function(t,e,r){this.timer||this.init(),this.cache.push([t,e].concat(r))},o.prototype.init=function(){if(this.enabled&&this.jQuery){var t=this;this.timer=setTimeout(function(){var e,r,n=[],o=t.url;if(0==t.cache.length)return t.init();for(e=0;e<t.cache.length;e++)try{JSON.stringify(t.cache[e]),n.push(t.cache[e])}catch(t){}t.jQuery.isEmptyObject(t.extras)?(r=JSON.stringify({logs:n}),o=t.url+"?client_id="+i):r=JSON.stringify(t.jQuery.extend({logs:n},t.extras)),t.jQuery.ajax(o,{type:"POST",cache:!1,processData:!1,data:r,contentType:"application/json",timeout:1e4}).success(function(e,r,n){e.interval&&(t.interval=Math.max(1e3,e.interval))}).error(function(){t.interval=3e4}).always(function(){t.init()}),t.cache=[]},this.interval)}},o.prototype.end=function(){},o.jQueryWait=function(t){if("undefined"!=typeof window&&(window.jQuery||window.$))return t(window.jQuery||window.$);"undefined"!=typeof window&&setTimeout(function(){o.jQueryWait(t)},200)},t.exports=o},function(t){t.exports={Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",amp:"&",AMP:"&",andand:"",And:"",and:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angmsd:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",apacir:"",ap:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",barwed:"",Barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",because:"",Because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxdl:"",boxdL:"",boxDl:"",boxDL:"",boxdr:"",boxdR:"",boxDr:"",boxDR:"",boxh:"",boxH:"",boxhd:"",boxHd:"",boxhD:"",boxHD:"",boxhu:"",boxHu:"",boxhU:"",boxHU:"",boxminus:"",boxplus:"",boxtimes:"",boxul:"",boxuL:"",boxUl:"",boxUL:"",boxur:"",boxuR:"",boxUr:"",boxUR:"",boxv:"",boxV:"",boxvh:"",boxvH:"",boxVh:"",boxVH:"",boxvl:"",boxvL:"",boxVl:"",boxVL:"",boxvr:"",boxvR:"",boxVr:"",boxVR:"",bprime:"",breve:"",Breve:"",brvbar:"",bscr:"",Bscr:"",bsemi:"",bsim:"",bsime:"",bsolb:"",bsol:"\\",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",capand:"",capbrcup:"",capcap:"",cap:"",Cap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",centerdot:"",CenterDot:"",cfr:"",Cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cir:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",colon:":",Colon:"",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",conint:"",Conint:"",ContourIntegral:"",copf:"",Copf:"",coprod:"",Coproduct:"",copy:"",COPY:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",cross:"",Cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",cupbrcap:"",cupcap:"",CupCap:"",cup:"",Cup:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",dagger:"",Dagger:"",daleth:"",darr:"",Darr:"",dArr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",ddagger:"",ddarr:"",DD:"",dd:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",diamond:"",Diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrowBar:"",downarrow:"",DownArrow:"",Downarrow:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVectorBar:"",DownLeftVector:"",DownRightTeeVector:"",DownRightVectorBar:"",DownRightVector:"",DownTeeArrow:"",DownTee:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",Ecirc:"",ecirc:"",ecir:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",edot:"",eDot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp13:"",emsp14:"",emsp:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",escr:"",Escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",exponentiale:"",ExponentialE:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",forall:"",ForAll:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",fscr:"",Fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",ge:"",gE:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",gescc:"",ges:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",gg:"",Gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gla:"",gl:"",glE:"",glj:"",gnap:"",gnapprox:"",gne:"",gnE:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",gtcc:"",gtcir:"",gt:">",GT:">",Gt:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",harrcir:"",harr:"",hArr:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",hfr:"",Hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",hopf:"",Hopf:"",horbar:"",HorizontalLine:"",hscr:"",Hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",ifr:"",Ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",Im:"",imof:"",imped:"",Implies:"",incare:"",in:"",infin:"",infintie:"",inodot:"",intcal:"",int:"",Int:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",iscr:"",Iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",lang:"",Lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",larrb:"",larrbfs:"",larr:"",Larr:"",lArr:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",latail:"",lAtail:"",lat:"",late:"",lates:"",lbarr:"",lBarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",le:"",lE:"",LeftAngleBracket:"",LeftArrowBar:"",leftarrow:"",LeftArrow:"",Leftarrow:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVectorBar:"",LeftDownVector:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",leftrightarrow:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTeeArrow:"",LeftTee:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangleBar:"",LeftTriangle:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVectorBar:"",LeftUpVector:"",LeftVectorBar:"",LeftVector:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",lescc:"",les:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",llarr:"",ll:"",Ll:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoustache:"",lmoust:"",lnap:"",lnapprox:"",lne:"",lnE:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",longleftarrow:"",LongLeftArrow:"",Longleftarrow:"",longleftrightarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longmapsto:"",longrightarrow:"",LongRightArrow:"",Longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",lscr:"",Lscr:"",lsh:"",Lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",ltcc:"",ltcir:"",lt:"<",LT:"<",Lt:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",midast:"*",midcir:"",mid:"",middot:"",minusb:"",minus:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",mscr:"",Mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natural:"",naturals:"",natur:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",nearhk:"",nearr:"",neArr:"",nearrow:"",ne:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nharr:"",nhArr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlarr:"",nlArr:"",nldr:"",nlE:"",nle:"",nleftarrow:"",nLeftarrow:"",nleftrightarrow:"",nLeftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",nopf:"",Nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangleBar:"",NotLeftTriangle:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangleBar:"",NotRightTriangle:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",nparallel:"",npar:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",nprec:"",npreceq:"",npre:"",nrarrc:"",nrarr:"",nrArr:"",nrarrw:"",nrightarrow:"",nRightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nvdash:"",nvDash:"",nVdash:"",nVDash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwarr:"",nwArr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",Ocirc:"",ocirc:"",ocir:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",orarr:"",Or:"",or:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",otimesas:"",Otimes:"",otimes:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",para:"",parallel:"",par:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plusacir:"",plusb:"",pluscir:"",plus:"+",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",popf:"",Popf:"",pound:"",prap:"",Pr:"",pr:"",prcue:"",precapprox:"",prec:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",pre:"",prE:"",precsim:"",prime:"",Prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportional:"",Proportion:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",qopf:"",Qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",quot:'"',QUOT:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",rang:"",Rang:"",rangd:"",range:"",rangle:"",raquo:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarr:"",Rarr:"",rArr:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",ratail:"",rAtail:"",ratio:"",rationals:"",rbarr:"",rBarr:"",RBarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",real:"",realine:"",realpart:"",reals:"",Re:"",rect:"",reg:"",REG:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",rfr:"",Rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrowBar:"",rightarrow:"",RightArrow:"",Rightarrow:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVectorBar:"",RightDownVector:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTeeArrow:"",RightTee:"",RightTeeVector:"",rightthreetimes:"",RightTriangleBar:"",RightTriangle:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVectorBar:"",RightUpVector:"",RightVectorBar:"",RightVector:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoustache:"",rmoust:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",ropf:"",Ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",rscr:"",Rscr:"",rsh:"",Rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",scap:"",Scaron:"",scaron:"",Sc:"",sc:"",sccue:"",sce:"",scE:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdotb:"",sdot:"",sdote:"",searhk:"",searr:"",seArr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",solbar:"",solb:"",sol:"/",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",square:"",Square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squ:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",sub:"",Sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",subset:"",Subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succapprox:"",succ:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",sum:"",Sum:"",sung:"",sup1:"",sup2:"",sup3:"",sup:"",Sup:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",supset:"",Supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swarr:"",swArr:"",swarrow:"",swnwar:"",szlig:"",Tab:"\t",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",therefore:"",Therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",ThinSpace:"",thinsp:"",thkap:"",thksim:"",THORN:"",thorn:"",tilde:"",Tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",timesbar:"",timesb:"",times:"",timesd:"",tint:"",toea:"",topbot:"",topcir:"",top:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",trade:"",TRADE:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",uarr:"",Uarr:"",uArr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrowBar:"",uparrow:"",UpArrow:"",Uparrow:"",UpArrowDownArrow:"",updownarrow:"",UpDownArrow:"",Updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",upsi:"",Upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTeeArrow:"",UpTee:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",varr:"",vArr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",vBar:"",Vbar:"",vBarv:"",Vcy:"",vcy:"",vdash:"",vDash:"",Vdash:"",VDash:"",Vdashl:"",veebar:"",vee:"",Vee:"",veeeq:"",vellip:"",verbar:"|",Verbar:"",vert:"|",Vert:"",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",wedge:"",Wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xharr:"",xhArr:"",Xi:"",xi:"",xlarr:"",xlArr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrarr:"",xrArr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",yuml:"",Yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",zfr:"",Zfr:"",ZHcy:"",zhcy:"",zigrarr:"",zopf:"",Zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}},function(t){t.exports={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(9),o=r(21),a=function(){function t(e,r,n,o){switch(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e||i(),this.name=r,this.type=n,this.isCloud=o,this.type){case t.SCALAR_TYPE:this.value=0;break;case t.LIST_TYPE:this.value=[];break;case t.BROADCAST_MESSAGE_TYPE:this.value=this.name;break;default:throw new Error("Invalid variable type: ".concat(this.type))}}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"toXML",value:function(t){return t=!0===t,'<variable type="'.concat(this.type,'" id="').concat(this.id,'" islocal="').concat(t,'" iscloud="').concat(this.isCloud,'">').concat(o(this.name),"</variable>")}}],[{key:"SCALAR_TYPE",get:function(){return""}},{key:"LIST_TYPE",get:function(){return"list"}},{key:"BROADCAST_MESSAGE_TYPE",get:function(){return"broadcast_msg"}}]),t}();t.exports=a},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,null,[{key:"BACKGROUND_LAYER",get:function(){return"background"}},{key:"VIDEO_LAYER",get:function(){return"video"}},{key:"PEN_LAYER",get:function(){return"pen"}},{key:"SPRITE_LAYER",get:function(){return"sprite"}},{key:"LAYER_GROUPS",get:function(){return[t.BACKGROUND_LAYER,t.VIDEO_LAYER,t.PEN_LAYER,t.SPRITE_LAYER]}}]),t}();t.exports=n},function(t,e,r){(function(e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.nowObj;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startTime=0,this.nowObj=e}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"time",value:function(){return this.nowObj.now()}},{key:"relativeTime",value:function(){return this.nowObj.now()}},{key:"start",value:function(){this.startTime=this.nowObj.now()}},{key:"timeElapsed",value:function(){return this.nowObj.now()-this.startTime}},{key:"setTimeout",value:function(t,r){return e.setTimeout(t,r)}},{key:"clearTimeout",value:function(t){e.clearTimeout(t)}}],[{key:"USE_PERFORMANCE",get:function(){return!1}},{key:"legacyDateCode",get:function(){return{now:function(){return(new Date).getTime()}}}},{key:"nowObj",get:function(){return t.USE_PERFORMANCE&&"undefined"!=typeof self&&self.performance&&"now"in self.performance?self.performance:Date.now?Date:t.legacyDateCode}}]),t}();t.exports=n}).call(this,r(8))},,,function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(3),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,null,[{key:"withoutTrailingDigits",value:function(t){for(var e=t.length-1;e>=0&&"0123456789".indexOf(t.charAt(e))>-1;)e--;return t.slice(0,e+1)}},{key:"unusedName",value:function(e,r){if(r.indexOf(e)<0)return e;e=t.withoutTrailingDigits(e);for(var n=2;r.indexOf(e+n)>=0;)n++;return e+n}},{key:"splitFirst",value:function(t,e){var r=t.indexOf(e);return r>=0?[t.substring(0,r),t.substring(r+1)]:[t,null]}},{key:"stringify",value:function(t){return JSON.stringify(t,function(t,e){return"number"!=typeof e||e!==1/0&&e!==-1/0&&!isNaN(e)?e:0})}},{key:"replaceUnsafeChars",value:function(t){if("string"!=typeof t){if(!Array.isArray(t))return i.error("Unexpected input recieved in replaceUnsafeChars"),t;t=String(t)}return t.replace(/[<>&'"]/g,function(t){switch(t){case"<":return"lt";case">":return"gt";case"&":return"amp";case"'":return"apos";case'"':return"quot"}})}}]),t}();t.exports=o},function(t,e,r){"use strict";var n,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var u=10;function c(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function l(t,e,r,n){var i,o,a;if("function"!=typeof r)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if(void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),a=o[e]),void 0===a)a=o[e]=r,++t._eventsCount;else if("function"==typeof a?a=o[e]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(i=c(t))>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=a.length,function(t){console&&console.warn&&console.warn(t)}(s)}return t}function h(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,t))}.bind(n);return i.listener=r,n.wrapFn=i,i}function f(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):d(i,i.length)}function p(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=i[t];if(void 0===u)return!1;if("function"==typeof u)o(u,this,e);else{var c=u.length,l=d(u,c);for(r=0;r<c;++r)o(l[r],this,e)}return!0},s.prototype.addListener=function(t,e){return l(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return l(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,h(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,h(this,t,e)),this},s.prototype.removeListener=function(t,e){var r,n,i,o,a;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){a=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},s.prototype.listeners=function(t){return f(this,t,!0)},s.prototype.rawListeners=function(t){return f(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=r(6),o=r(82);t.exports=function(t){return function t(e){var r=Object.create(null);for(var n in r.tagName=e.name,r.children=[],e.attribs)"xmlns"!==n&&(r[n]=o(e.attribs[n]),"blockinfo"===n&&(r.blockInfo=JSON.parse(r.blockinfo),delete r.blockinfo));for(var i=0;i<e.children.length;i++)r.children.push(t(e.children[i]));return r}("object"===n(t)?t:i.parseDOM(t)[0])}},function(t,e,r){var n=r(43),i={input:!0,option:!0,optgroup:!0,select:!0,button:!0,datalist:!0,textarea:!0},o={tr:{tr:!0,th:!0,td:!0},th:{th:!0},td:{thead:!0,th:!0,td:!0},body:{head:!0,link:!0,script:!0},li:{li:!0},p:{p:!0},h1:{p:!0},h2:{p:!0},h3:{p:!0},h4:{p:!0},h5:{p:!0},h6:{p:!0},select:i,input:i,output:i,button:i,datalist:i,textarea:i,option:{option:!0},optgroup:{optgroup:!0}},a={__proto__:null,area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},s={__proto__:null,math:!0,svg:!0},u={__proto__:null,mi:!0,mo:!0,mn:!0,ms:!0,mtext:!0,"annotation-xml":!0,foreignObject:!0,desc:!0,title:!0},c=/\s|\//;function l(t,e){this._options=e||{},this._cbs=t||{},this._tagname="",this._attribname="",this._attribvalue="",this._attribs=null,this._stack=[],this._foreignContext=[],this.startIndex=0,this.endIndex=null,this._lowerCaseTagNames="lowerCaseTags"in this._options?!!this._options.lowerCaseTags:!this._options.xmlMode,this._lowerCaseAttributeNames="lowerCaseAttributeNames"in this._options?!!this._options.lowerCaseAttributeNames:!this._options.xmlMode,this._options.Tokenizer&&(n=this._options.Tokenizer),this._tokenizer=new n(this._options,this),this._cbs.onparserinit&&this._cbs.onparserinit(this)}r(15)(l,r(40).EventEmitter),l.prototype._updatePosition=function(t){null===this.endIndex?this._tokenizer._sectionStart<=t?this.startIndex=0:this.startIndex=this._tokenizer._sectionStart-t:this.startIndex=this.endIndex+1,this.endIndex=this._tokenizer.getAbsoluteIndex()},l.prototype.ontext=function(t){this._updatePosition(1),this.endIndex--,this._cbs.ontext&&this._cbs.ontext(t)},l.prototype.onopentagname=function(t){if(this._lowerCaseTagNames&&(t=t.toLowerCase()),this._tagname=t,!this._options.xmlMode&&t in o)for(var e;(e=this._stack[this._stack.length-1])in o[t];this.onclosetag(e));!this._options.xmlMode&&t in a||(this._stack.push(t),t in s?this._foreignContext.push(!0):t in u&&this._foreignContext.push(!1)),this._cbs.onopentagname&&this._cbs.onopentagname(t),this._cbs.onopentag&&(this._attribs={})},l.prototype.onopentagend=function(){this._updatePosition(1),this._attribs&&(this._cbs.onopentag&&this._cbs.onopentag(this._tagname,this._attribs),this._attribs=null),!this._options.xmlMode&&this._cbs.onclosetag&&this._tagname in a&&this._cbs.onclosetag(this._tagname),this._tagname=""},l.prototype.onclosetag=function(t){if(this._updatePosition(1),this._lowerCaseTagNames&&(t=t.toLowerCase()),!this._stack.length||t in a&&!this._options.xmlMode)this._options.xmlMode||"br"!==t&&"p"!==t||(this.onopentagname(t),this._closeCurrentTag());else{var e=this._stack.lastIndexOf(t);if(-1!==e)if(this._cbs.onclosetag)for(e=this._stack.length-e;e--;)this._cbs.onclosetag(this._stack.pop());else this._stack.length=e;else"p"!==t||this._options.xmlMode||(this.onopentagname(t),this._closeCurrentTag())}},l.prototype.onselfclosingtag=function(){this._options.xmlMode||this._options.recognizeSelfClosing||this._foreignContext[this._foreignContext.length-1]?this._closeCurrentTag():this.onopentagend()},l.prototype._closeCurrentTag=function(){var t=this._tagname;this.onopentagend(),this._stack[this._stack.length-1]===t&&(this._cbs.onclosetag&&this._cbs.onclosetag(t),this._stack.pop(),(t in s||t in u)&&this._foreignContext.pop())},l.prototype.onattribname=function(t){this._lowerCaseAttributeNames&&(t=t.toLowerCase()),this._attribname=t},l.prototype.onattribdata=function(t){this._attribvalue+=t},l.prototype.onattribend=function(){this._cbs.onattribute&&this._cbs.onattribute(this._attribname,this._attribvalue),this._attribs&&!Object.prototype.hasOwnProperty.call(this._attribs,this._attribname)&&(this._attribs[this._attribname]=this._attribvalue),this._attribname="",this._attribvalue=""},l.prototype._getInstructionName=function(t){var e=t.search(c),r=e<0?t:t.substr(0,e);return this._lowerCaseTagNames&&(r=r.toLowerCase()),r},l.prototype.ondeclaration=function(t){if(this._cbs.onprocessinginstruction){var e=this._getInstructionName(t);this._cbs.onprocessinginstruction("!"+e,"!"+t)}},l.prototype.onprocessinginstruction=function(t){if(this._cbs.onprocessinginstruction){var e=this._getInstructionName(t);this._cbs.onprocessinginstruction("?"+e,"?"+t)}},l.prototype.oncomment=function(t){this._updatePosition(4),this._cbs.oncomment&&this._cbs.oncomment(t),this._cbs.oncommentend&&this._cbs.oncommentend()},l.prototype.oncdata=function(t){this._updatePosition(1),this._options.xmlMode||this._options.recognizeCDATA?(this._cbs.oncdatastart&&this._cbs.oncdatastart(),this._cbs.ontext&&this._cbs.ontext(t),this._cbs.oncdataend&&this._cbs.oncdataend()):this.oncomment("[CDATA["+t+"]]")},l.prototype.onerror=function(t){this._cbs.onerror&&this._cbs.onerror(t)},l.prototype.onend=function(){if(this._cbs.onclosetag)for(var t=this._stack.length;t>0;this._cbs.onclosetag(this._stack[--t]));this._cbs.onend&&this._cbs.onend()},l.prototype.reset=function(){this._cbs.onreset&&this._cbs.onreset(),this._tokenizer.reset(),this._tagname="",this._attribname="",this._attribs=null,this._stack=[],this._cbs.onparserinit&&this._cbs.onparserinit(this)},l.prototype.parseComplete=function(t){this.reset(),this.end(t)},l.prototype.write=function(t){this._tokenizer.write(t)},l.prototype.end=function(t){this._tokenizer.end(t)},l.prototype.pause=function(){this._tokenizer.pause()},l.prototype.resume=function(){this._tokenizer.resume()},l.prototype.parseChunk=l.prototype.write,l.prototype.done=l.prototype.end,t.exports=l},function(t,e,r){t.exports=mt;var n=r(44),i=r(32),o=r(45),a=r(33),s=0,u=s++,c=s++,l=s++,h=s++,f=s++,p=s++,d=s++,g=s++,m=s++,v=s++,_=s++,y=s++,b=s++,k=s++,T=s++,S=s++,w=s++,E=s++,I=s++,A=s++,O=s++,N=s++,x=s++,C=s++,D=s++,R=s++,M=s++,L=s++,P=s++,B=s++,U=s++,j=s++,F=s++,V=s++,q=s++,z=s++,G=s++,Y=s++,H=s++,W=s++,J=s++,K=s++,X=s++,Z=s++,Q=s++,$=s++,tt=s++,et=s++,rt=s++,nt=s++,it=s++,ot=s++,at=s++,st=s++,ut=s++,ct=0,lt=ct++,ht=ct++,ft=ct++;function pt(t){return" "===t||"\n"===t||"\t"===t||"\f"===t||"\r"===t}function dt(t,e,r){var n=t.toLowerCase();return t===n?function(t){t===n?this._state=e:(this._state=r,this._index--)}:function(i){i===n||i===t?this._state=e:(this._state=r,this._index--)}}function gt(t,e){var r=t.toLowerCase();return function(n){n===r||n===t?this._state=e:(this._state=l,this._index--)}}function mt(t,e){this._state=u,this._buffer="",this._sectionStart=0,this._index=0,this._bufferOffset=0,this._baseState=u,this._special=lt,this._cbs=e,this._running=!0,this._ended=!1,this._xmlMode=!(!t||!t.xmlMode),this._decodeEntities=!(!t||!t.decodeEntities)}mt.prototype._stateText=function(t){"<"===t?(this._index>this._sectionStart&&this._cbs.ontext(this._getSection()),this._state=c,this._sectionStart=this._index):this._decodeEntities&&this._special===lt&&"&"===t&&(this._index>this._sectionStart&&this._cbs.ontext(this._getSection()),this._baseState=u,this._state=it,this._sectionStart=this._index)},mt.prototype._stateBeforeTagName=function(t){"/"===t?this._state=f:"<"===t?(this._cbs.ontext(this._getSection()),this._sectionStart=this._index):">"===t||this._special!==lt||pt(t)?this._state=u:"!"===t?(this._state=T,this._sectionStart=this._index+1):"?"===t?(this._state=w,this._sectionStart=this._index+1):(this._state=this._xmlMode||"s"!==t&&"S"!==t?l:U,this._sectionStart=this._index)},mt.prototype._stateInTagName=function(t){("/"===t||">"===t||pt(t))&&(this._emitToken("onopentagname"),this._state=g,this._index--)},mt.prototype._stateBeforeCloseingTagName=function(t){pt(t)||(">"===t?this._state=u:this._special!==lt?"s"===t||"S"===t?this._state=j:(this._state=u,this._index--):(this._state=p,this._sectionStart=this._index))},mt.prototype._stateInCloseingTagName=function(t){(">"===t||pt(t))&&(this._emitToken("onclosetag"),this._state=d,this._index--)},mt.prototype._stateAfterCloseingTagName=function(t){">"===t&&(this._state=u,this._sectionStart=this._index+1)},mt.prototype._stateBeforeAttributeName=function(t){">"===t?(this._cbs.onopentagend(),this._state=u,this._sectionStart=this._index+1):"/"===t?this._state=h:pt(t)||(this._state=m,this._sectionStart=this._index)},mt.prototype._stateInSelfClosingTag=function(t){">"===t?(this._cbs.onselfclosingtag(),this._state=u,this._sectionStart=this._index+1):pt(t)||(this._state=g,this._index--)},mt.prototype._stateInAttributeName=function(t){("="===t||"/"===t||">"===t||pt(t))&&(this._cbs.onattribname(this._getSection()),this._sectionStart=-1,this._state=v,this._index--)},mt.prototype._stateAfterAttributeName=function(t){"="===t?this._state=_:"/"===t||">"===t?(this._cbs.onattribend(),this._state=g,this._index--):pt(t)||(this._cbs.onattribend(),this._state=m,this._sectionStart=this._index)},mt.prototype._stateBeforeAttributeValue=function(t){'"'===t?(this._state=y,this._sectionStart=this._index+1):"'"===t?(this._state=b,this._sectionStart=this._index+1):pt(t)||(this._state=k,this._sectionStart=this._index,this._index--)},mt.prototype._stateInAttributeValueDoubleQuotes=function(t){'"'===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=g):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=it,this._sectionStart=this._index)},mt.prototype._stateInAttributeValueSingleQuotes=function(t){"'"===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=g):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=it,this._sectionStart=this._index)},mt.prototype._stateInAttributeValueNoQuotes=function(t){pt(t)||">"===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=g,this._index--):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=it,this._sectionStart=this._index)},mt.prototype._stateBeforeDeclaration=function(t){this._state="["===t?N:"-"===t?E:S},mt.prototype._stateInDeclaration=function(t){">"===t&&(this._cbs.ondeclaration(this._getSection()),this._state=u,this._sectionStart=this._index+1)},mt.prototype._stateInProcessingInstruction=function(t){">"===t&&(this._cbs.onprocessinginstruction(this._getSection()),this._state=u,this._sectionStart=this._index+1)},mt.prototype._stateBeforeComment=function(t){"-"===t?(this._state=I,this._sectionStart=this._index+1):this._state=S},mt.prototype._stateInComment=function(t){"-"===t&&(this._state=A)},mt.prototype._stateAfterComment1=function(t){this._state="-"===t?O:I},mt.prototype._stateAfterComment2=function(t){">"===t?(this._cbs.oncomment(this._buffer.substring(this._sectionStart,this._index-2)),this._state=u,this._sectionStart=this._index+1):"-"!==t&&(this._state=I)},mt.prototype._stateBeforeCdata1=dt("C",x,S),mt.prototype._stateBeforeCdata2=dt("D",C,S),mt.prototype._stateBeforeCdata3=dt("A",D,S),mt.prototype._stateBeforeCdata4=dt("T",R,S),mt.prototype._stateBeforeCdata5=dt("A",M,S),mt.prototype._stateBeforeCdata6=function(t){"["===t?(this._state=L,this._sectionStart=this._index+1):(this._state=S,this._index--)},mt.prototype._stateInCdata=function(t){"]"===t&&(this._state=P)},mt.prototype._stateAfterCdata1=function(t){this._state="]"===t?B:L},mt.prototype._stateAfterCdata2=function(t){">"===t?(this._cbs.oncdata(this._buffer.substring(this._sectionStart,this._index-2)),this._state=u,this._sectionStart=this._index+1):"]"!==t&&(this._state=L)},mt.prototype._stateBeforeSpecial=function(t){"c"===t||"C"===t?this._state=F:"t"===t||"T"===t?this._state=X:(this._state=l,this._index--)},mt.prototype._stateBeforeSpecialEnd=function(t){this._special!==ht||"c"!==t&&"C"!==t?this._special!==ft||"t"!==t&&"T"!==t?this._state=u:this._state=tt:this._state=Y},mt.prototype._stateBeforeScript1=gt("R",V),mt.prototype._stateBeforeScript2=gt("I",q),mt.prototype._stateBeforeScript3=gt("P",z),mt.prototype._stateBeforeScript4=gt("T",G),mt.prototype._stateBeforeScript5=function(t){("/"===t||">"===t||pt(t))&&(this._special=ht),this._state=l,this._index--},mt.prototype._stateAfterScript1=dt("R",H,u),mt.prototype._stateAfterScript2=dt("I",W,u),mt.prototype._stateAfterScript3=dt("P",J,u),mt.prototype._stateAfterScript4=dt("T",K,u),mt.prototype._stateAfterScript5=function(t){">"===t||pt(t)?(this._special=lt,this._state=p,this._sectionStart=this._index-6,this._index--):this._state=u},mt.prototype._stateBeforeStyle1=gt("Y",Z),mt.prototype._stateBeforeStyle2=gt("L",Q),mt.prototype._stateBeforeStyle3=gt("E",$),mt.prototype._stateBeforeStyle4=function(t){("/"===t||">"===t||pt(t))&&(this._special=ft),this._state=l,this._index--},mt.prototype._stateAfterStyle1=dt("Y",et,u),mt.prototype._stateAfterStyle2=dt("L",rt,u),mt.prototype._stateAfterStyle3=dt("E",nt,u),mt.prototype._stateAfterStyle4=function(t){">"===t||pt(t)?(this._special=lt,this._state=p,this._sectionStart=this._index-5,this._index--):this._state=u},mt.prototype._stateBeforeEntity=dt("#",ot,at),mt.prototype._stateBeforeNumericEntity=dt("X",ut,st),mt.prototype._parseNamedEntityStrict=function(){if(this._sectionStart+1<this._index){var t=this._buffer.substring(this._sectionStart+1,this._index),e=this._xmlMode?a:i;e.hasOwnProperty(t)&&(this._emitPartial(e[t]),this._sectionStart=this._index+1)}},mt.prototype._parseLegacyEntity=function(){var t=this._sectionStart+1,e=this._index-t;for(e>6&&(e=6);e>=2;){var r=this._buffer.substr(t,e);if(o.hasOwnProperty(r))return this._emitPartial(o[r]),void(this._sectionStart+=e+1);e--}},mt.prototype._stateInNamedEntity=function(t){";"===t?(this._parseNamedEntityStrict(),this._sectionStart+1<this._index&&!this._xmlMode&&this._parseLegacyEntity(),this._state=this._baseState):(t<"a"||t>"z")&&(t<"A"||t>"Z")&&(t<"0"||t>"9")&&(this._xmlMode||this._sectionStart+1===this._index||(this._baseState!==u?"="!==t&&this._parseNamedEntityStrict():this._parseLegacyEntity()),this._state=this._baseState,this._index--)},mt.prototype._decodeNumericEntity=function(t,e){var r=this._sectionStart+t;if(r!==this._index){var i=this._buffer.substring(r,this._index),o=parseInt(i,e);this._emitPartial(n(o)),this._sectionStart=this._index}else this._sectionStart--;this._state=this._baseState},mt.prototype._stateInNumericEntity=function(t){";"===t?(this._decodeNumericEntity(2,10),this._sectionStart++):(t<"0"||t>"9")&&(this._xmlMode?this._state=this._baseState:this._decodeNumericEntity(2,10),this._index--)},mt.prototype._stateInHexEntity=function(t){";"===t?(this._decodeNumericEntity(3,16),this._sectionStart++):(t<"a"||t>"f")&&(t<"A"||t>"F")&&(t<"0"||t>"9")&&(this._xmlMode?this._state=this._baseState:this._decodeNumericEntity(3,16),this._index--)},mt.prototype._cleanup=function(){this._sectionStart<0?(this._buffer="",this._bufferOffset+=this._index,this._index=0):this._running&&(this._state===u?(this._sectionStart!==this._index&&this._cbs.ontext(this._buffer.substr(this._sectionStart)),this._buffer="",this._bufferOffset+=this._index,this._index=0):this._sectionStart===this._index?(this._buffer="",this._bufferOffset+=this._index,this._index=0):(this._buffer=this._buffer.substr(this._sectionStart),this._index-=this._sectionStart,this._bufferOffset+=this._sectionStart),this._sectionStart=0)},mt.prototype.write=function(t){this._ended&&this._cbs.onerror(Error(".write() after done!")),this._buffer+=t,this._parse()},mt.prototype._parse=function(){for(;this._index<this._buffer.length&&this._running;){var t=this._buffer.charAt(this._index);this._state===u?this._stateText(t):this._state===c?this._stateBeforeTagName(t):this._state===l?this._stateInTagName(t):this._state===f?this._stateBeforeCloseingTagName(t):this._state===p?this._stateInCloseingTagName(t):this._state===d?this._stateAfterCloseingTagName(t):this._state===h?this._stateInSelfClosingTag(t):this._state===g?this._stateBeforeAttributeName(t):this._state===m?this._stateInAttributeName(t):this._state===v?this._stateAfterAttributeName(t):this._state===_?this._stateBeforeAttributeValue(t):this._state===y?this._stateInAttributeValueDoubleQuotes(t):this._state===b?this._stateInAttributeValueSingleQuotes(t):this._state===k?this._stateInAttributeValueNoQuotes(t):this._state===T?this._stateBeforeDeclaration(t):this._state===S?this._stateInDeclaration(t):this._state===w?this._stateInProcessingInstruction(t):this._state===E?this._stateBeforeComment(t):this._state===I?this._stateInComment(t):this._state===A?this._stateAfterComment1(t):this._state===O?this._stateAfterComment2(t):this._state===N?this._stateBeforeCdata1(t):this._state===x?this._stateBeforeCdata2(t):this._state===C?this._stateBeforeCdata3(t):this._state===D?this._stateBeforeCdata4(t):this._state===R?this._stateBeforeCdata5(t):this._state===M?this._stateBeforeCdata6(t):this._state===L?this._stateInCdata(t):this._state===P?this._stateAfterCdata1(t):this._state===B?this._stateAfterCdata2(t):this._state===U?this._stateBeforeSpecial(t):this._state===j?this._stateBeforeSpecialEnd(t):this._state===F?this._stateBeforeScript1(t):this._state===V?this._stateBeforeScript2(t):this._state===q?this._stateBeforeScript3(t):this._state===z?this._stateBeforeScript4(t):this._state===G?this._stateBeforeScript5(t):this._state===Y?this._stateAfterScript1(t):this._state===H?this._stateAfterScript2(t):this._state===W?this._stateAfterScript3(t):this._state===J?this._stateAfterScript4(t):this._state===K?this._stateAfterScript5(t):this._state===X?this._stateBeforeStyle1(t):this._state===Z?this._stateBeforeStyle2(t):this._state===Q?this._stateBeforeStyle3(t):this._state===$?this._stateBeforeStyle4(t):this._state===tt?this._stateAfterStyle1(t):this._state===et?this._stateAfterStyle2(t):this._state===rt?this._stateAfterStyle3(t):this._state===nt?this._stateAfterStyle4(t):this._state===it?this._stateBeforeEntity(t):this._state===ot?this._stateBeforeNumericEntity(t):this._state===at?this._stateInNamedEntity(t):this._state===st?this._stateInNumericEntity(t):this._state===ut?this._stateInHexEntity(t):this._cbs.onerror(Error("unknown _state"),this._state),this._index++}this._cleanup()},mt.prototype.pause=function(){this._running=!1},mt.prototype.resume=function(){this._running=!0,this._index<this._buffer.length&&this._parse(),this._ended&&this._finish()},mt.prototype.end=function(t){this._ended&&this._cbs.onerror(Error(".end() after done!")),t&&this.write(t),this._ended=!0,this._running&&this._finish()},mt.prototype._finish=function(){this._sectionStart<this._index&&this._handleTrailingData(),this._cbs.onend()},mt.prototype._handleTrailingData=function(){var t=this._buffer.substr(this._sectionStart);this._state===L||this._state===P||this._state===B?this._cbs.oncdata(t):this._state===I||this._state===A||this._state===O?this._cbs.oncomment(t):this._state!==at||this._xmlMode?this._state!==st||this._xmlMode?this._state!==ut||this._xmlMode?this._state!==l&&this._state!==g&&this._state!==_&&this._state!==v&&this._state!==m&&this._state!==b&&this._state!==y&&this._state!==k&&this._state!==p&&this._cbs.ontext(t):(this._decodeNumericEntity(3,16),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData())):(this._decodeNumericEntity(2,10),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData())):(this._parseLegacyEntity(),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData()))},mt.prototype.reset=function(){mt.call(this,{xmlMode:this._xmlMode,decodeEntities:this._decodeEntities},this._cbs)},mt.prototype.getAbsoluteIndex=function(){return this._bufferOffset+this._index},mt.prototype._getSection=function(){return this._buffer.substring(this._sectionStart,this._index)},mt.prototype._emitToken=function(t){this._cbs[t](this._getSection()),this._sectionStart=-1},mt.prototype._emitPartial=function(t){this._baseState!==u?this._cbs.onattribdata(t):this._cbs.ontext(t)}},function(t,e,r){var n=r(61);t.exports=function(t){if(t>=55296&&t<=57343||t>1114111)return"";t in n&&(t=n[t]);var e="";t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t);return e+=String.fromCharCode(t)}},function(t){t.exports={Aacute:"",aacute:"",Acirc:"",acirc:"",acute:"",AElig:"",aelig:"",Agrave:"",agrave:"",amp:"&",AMP:"&",Aring:"",aring:"",Atilde:"",atilde:"",Auml:"",auml:"",brvbar:"",Ccedil:"",ccedil:"",cedil:"",cent:"",copy:"",COPY:"",curren:"",deg:"",divide:"",Eacute:"",eacute:"",Ecirc:"",ecirc:"",Egrave:"",egrave:"",ETH:"",eth:"",Euml:"",euml:"",frac12:"",frac14:"",frac34:"",gt:">",GT:">",Iacute:"",iacute:"",Icirc:"",icirc:"",iexcl:"",Igrave:"",igrave:"",iquest:"",Iuml:"",iuml:"",laquo:"",lt:"<",LT:"<",macr:"",micro:"",middot:"",nbsp:"",not:"",Ntilde:"",ntilde:"",Oacute:"",oacute:"",Ocirc:"",ocirc:"",Ograve:"",ograve:"",ordf:"",ordm:"",Oslash:"",oslash:"",Otilde:"",otilde:"",Ouml:"",ouml:"",para:"",plusmn:"",pound:"",quot:'"',QUOT:'"',raquo:"",reg:"",REG:"",sect:"",shy:"",sup1:"",sup2:"",sup3:"",szlig:"",THORN:"",thorn:"",times:"",Uacute:"",uacute:"",Ucirc:"",ucirc:"",Ugrave:"",ugrave:"",uml:"",Uuml:"",uuml:"",Yacute:"",yacute:"",yen:"",yuml:""}},function(t,e){var r=t.exports={get firstChild(){var t=this.children;return t&&t[0]||null},get lastChild(){var t=this.children;return t&&t[t.length-1]||null},get nodeType(){return i[this.type]||i.element}},n={tagName:"name",childNodes:"children",parentNode:"parent",previousSibling:"prev",nextSibling:"next",nodeValue:"data"},i={element:1,text:3,cdata:4,comment:8};Object.keys(n).forEach(function(t){var e=n[t];Object.defineProperty(r,t,{get:function(){return this[e]||null},set:function(t){return this[e]=t,t}})})},function(t,e,r){t.exports=s;var n=r(42),i=r(66).Writable,o=r(67).StringDecoder,a=r(14).Buffer;function s(t,e){var r=this._parser=new n(t,e),a=this._decoder=new o;i.call(this,{decodeStrings:!1}),this.once("finish",function(){r.end(a.end())})}r(15)(s,i),i.prototype._write=function(t,e,r){t instanceof a&&(t=this._decoder.write(t)),this._parser.write(t),r()}},function(t,e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t,e){var n="";for(var i in e){var o=e[i];"object"===r(o)&&(o="value"in o?o.value:Object.values(o)[0]),"CURRENTMENU"===i&&(o=o.toLowerCase()),n+="_".concat(o)}return"".concat(t).concat(n)}},,,,,,,function(t,e,r){e.getCached=function(){throw new Error("blocks.js has not initialized BlocksExecuteCache")},r(20)},function(t,e,r){e.getScripts=function(){throw new Error("blocks.js has not initialized BlocksRuntimeCache")},e._RuntimeScriptCache=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this.blockId=r;var n=e.getBlock(r),i=e.getFields(n);if(this.fieldsOfInputs=Object.assign({},i),0===Object.keys(i).length){var o=e.getInputs(n);for(var a in o)if(o.hasOwnProperty(a)){var s=o[a].block,u=e.getBlock(s),c=e.getFields(u);Object.assign(this.fieldsOfInputs,c)}}for(var l in this.fieldsOfInputs){var h=this.fieldsOfInputs[l]=Object.assign({},this.fieldsOfInputs[l]);h.value.toUpperCase&&(h.value=h.value.toUpperCase())}},r(20)},function(t,e){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}var o=[],a=function(){function t(e){r(this,t),this.isLoop=!1,this.warpMode=e,this.justReported=null,this.reporting="",this.reported=null,this.waitingReporter=null,this.params=null,this.executionContext=null}return i(t,[{key:"reset",value:function(){return this.isLoop=!1,this.warpMode=!1,this.justReported=null,this.reported=null,this.waitingReporter=null,this.params=null,this.executionContext=null,this}},{key:"reuse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.warpMode;return this.reset(),this.warpMode=Boolean(t),this}}],[{key:"create",value:function(e){var r=o.pop();return void 0!==r?(r.warpMode=Boolean(e),r):new t(e)}},{key:"release",value:function(t){void 0!==t&&o.push(t.reset())}}]),t}(),s=function(){function t(e){r(this,t),this.topBlock=e,this.stack=[],this.stackFrames=[],this.status=0,this.isKilled=!1,this.target=null,this.blockContainer=null,this.requestScriptGlowInFrame=!1,this.blockGlowInFrame=null,this.warpTimer=null,this.justReported=null}return i(t,[{key:"pushStack",value:function(t){if(this.stack.push(t),this.stack.length>this.stackFrames.length){var e=this.stackFrames[this.stackFrames.length-1];this.stackFrames.push(a.create(void 0!==e&&e.warpMode))}}},{key:"reuseStackForNextBlock",value:function(t){this.stack[this.stack.length-1]=t,this.stackFrames[this.stackFrames.length-1].reuse()}},{key:"popStack",value:function(){return a.release(this.stackFrames.pop()),this.stack.pop()}},{key:"stopThisScript",value:function(){for(var e=this.peekStack();null!==e;){var r=this.target.blocks.getBlock(e);if(void 0!==r&&"procedures_call"===r.opcode)break;this.popStack(),e=this.peekStack()}0===this.stack.length&&(this.requestScriptGlowInFrame=!1,this.status=t.STATUS_DONE)}},{key:"peekStack",value:function(){return this.stack.length>0?this.stack[this.stack.length-1]:null}},{key:"peekStackFrame",value:function(){return this.stackFrames.length>0?this.stackFrames[this.stackFrames.length-1]:null}},{key:"peekParentStackFrame",value:function(){return this.stackFrames.length>1?this.stackFrames[this.stackFrames.length-2]:null}},{key:"pushReportedValue",value:function(t){this.justReported=void 0===t?null:t}},{key:"initParams",value:function(){var t=this.peekStackFrame();null===t.params&&(t.params={})}},{key:"pushParam",value:function(t,e){this.peekStackFrame().params[t]=e}},{key:"getParam",value:function(t){for(var e=this.stackFrames.length-1;e>=0;e--){var r=this.stackFrames[e];if(null!==r.params)return r.params.hasOwnProperty(t)?r.params[t]:null}return null}},{key:"atStackTop",value:function(){return this.peekStack()===this.topBlock}},{key:"goToNextBlock",value:function(){var t=this.target.blocks.getNextBlock(this.peekStack());this.reuseStackForNextBlock(t)}},{key:"isRecursiveCall",value:function(t){for(var e=5,r=this.stack.length-1-1;r>=0;r--){var n=this.target.blocks.getBlock(this.stack[r]);if("procedures_call"===n.opcode&&n.mutation.proccode===t)return!0;if(--e<0)return!1}return!1}}],[{key:"STATUS_RUNNING",get:function(){return 0}},{key:"STATUS_PROMISE_WAIT",get:function(){return 1}},{key:"STATUS_YIELD",get:function(){return 2}},{key:"STATUS_YIELD_TICK",get:function(){return 3}},{key:"STATUS_DONE",get:function(){return 4}}]),t}();t.exports=s},function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u=r(3),c=r(5),l=r(39),h=r(2),f=r(4),p=r(59),d=r(35),g=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=o(this,a(e).call(this,r,t.blocks))).sprite=t,n.renderer=null,n.runtime&&(n.renderer=n.runtime.renderer),n.drawableID=null,n.dragging=!1,n.effects={color:0,fisheye:0,whirl:0,pixelate:0,mosaic:0,brightness:0,ghost:0},n.isOriginal=!0,n.isStage=!1,n.x=0,n.y=0,n.direction=90,n.draggable=!1,n.visible=!0,n.size=100,n.currentCostume=0,n.rotationStyle=e.ROTATION_STYLE_ALL_AROUND,n.volume=100,n.tempo=60,n.videoTransparency=50,n.videoState=e.VIDEO_STATE.ON,n.textToSpeechLanguage=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(e,p),function(t,e,r){e&&i(t.prototype,e),r&&i(t,r)}(e,[{key:"initDrawable",value:function(t){this.renderer&&(this.drawableID=this.renderer.createDrawable(t)),this.isOriginal||this.runtime.startHats("control_start_as_clone",null,this)}},{key:"initAudio",value:function(){}},{key:"setXY",value:function(t,r,n){if(!this.isStage&&(!this.dragging||n)){var i=this.x,o=this.y;if(this.renderer){var a=this.renderer.getFencedPositionOfDrawable(this.drawableID,[t,r]);this.x=a[0],this.y=a[1],this.renderer.updateDrawablePosition(this.drawableID,a),this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())}else this.x=t,this.y=r;this.emit(e.EVENT_TARGET_MOVED,this,i,o,n),this.runtime.requestTargetsUpdate(this)}}},{key:"_getRenderedDirectionAndScale",value:function(){var t=this.direction,r=[this.size,this.size];if(this.rotationStyle===e.ROTATION_STYLE_NONE)t=90;else if(this.rotationStyle===e.ROTATION_STYLE_LEFT_RIGHT){t=90,r=[(this.direction<0?-1:1)*this.size,this.size]}return{direction:t,scale:r}}},{key:"setDirection",value:function(t){if(!this.isStage&&isFinite(t)){if(this.direction=c.wrapClamp(t,-179,180),this.renderer){var r=this._getRenderedDirectionAndScale(),n=r.direction,i=r.scale;this.renderer.updateDrawableDirectionScale(this.drawableID,n,i),this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}}},{key:"setDraggable",value:function(t){this.isStage||(this.draggable=!!t,this.runtime.requestTargetsUpdate(this))}},{key:"setSay",value:function(t,e){this.isStage||(t&&e?u.info("Setting say bubble:",t,e):u.info("Clearing say bubble"))}},{key:"setVisible",value:function(t){this.isStage||(this.visible=!!t,this.renderer&&(this.renderer.updateDrawableVisible(this.drawableID,this.visible),this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())),this.runtime.requestTargetsUpdate(this))}},{key:"setSize",value:function(t){if(!this.isStage){if(this.renderer){var r=this.renderer.getCurrentSkinSize(this.drawableID),n=r[0],i=r[1],o=Math.min(1,Math.max(5/n,5/i)),a=Math.min(1.5*this.runtime.constructor.STAGE_WIDTH/n,1.5*this.runtime.constructor.STAGE_HEIGHT/i);this.size=100*c.clamp(t/100,o,a);var s=this._getRenderedDirectionAndScale(),u=s.direction,l=s.scale;this.renderer.updateDrawableDirectionScale(this.drawableID,u,l),this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}}},{key:"setEffect",value:function(t,r){this.effects.hasOwnProperty(t)&&(this.effects[t]=r,this.renderer&&(this.renderer.updateDrawableEffect(this.drawableID,t,r),this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())))}},{key:"clearEffects",value:function(){for(var t in this.effects)this.effects.hasOwnProperty(t)&&(this.effects[t]=0);if(this.renderer){for(var r in this.effects)this.effects.hasOwnProperty(r)&&this.renderer.updateDrawableEffect(this.drawableID,r,0);this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())}}},{key:"setCostume",value:function(t){if(t=Math.round(t),[1/0,-1/0,NaN].includes(t)&&(t=0),this.currentCostume=c.wrapClamp(t,0,this.sprite.costumes.length-1),this.renderer){var r=this.getCostumes()[this.currentCostume];if(void 0!==r.rotationCenterX&&void 0!==r.rotationCenterY){var n=r.bitmapResolution||2,i=[r.rotationCenterX/n,r.rotationCenterY/n];this.renderer.updateDrawableSkinIdRotationCenter(this.drawableID,r.skinId,i)}else this.renderer.updateDrawableSkinId(this.drawableID,r.skinId);this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}},{key:"addCostume",value:function(t,e){"number"!=typeof e||isNaN(e)?this.sprite.addCostumeAt(t,this.sprite.costumes.length):this.sprite.addCostumeAt(t,e)}},{key:"renameCostume",value:function(t,e){var r=this.sprite.costumes.filter(function(e,r){return t!==r}).map(function(t){return t.name}),n=this.getCostumes()[t].name,i=l.unusedName(e,r);if(this.getCostumes()[t].name=i,this.isStage)for(var o=this.runtime.targets,a=0;a<o.length;a++){o[a].blocks.updateAssetName(n,i,"backdrop")}else this.blocks.updateAssetName(n,i,"costume")}},{key:"deleteCostume",value:function(t){var e=this.sprite.costumes.length;if(1===e)return null;if(t<0||t>=e)return null;var r=this.sprite.deleteCostumeAt(t);return t===this.currentCostume&&t===e-1?this.setCostume(t-1):t<this.currentCostume?this.setCostume(this.currentCostume-1):this.setCostume(this.currentCostume),this.runtime.requestTargetsUpdate(this),r}},{key:"addSound",value:function(t,e){var r=this.sprite.sounds.map(function(t){return t.name});t.name=l.unusedName(t.name,r),"number"!=typeof e||isNaN(e)?this.sprite.sounds.push(t):this.sprite.sounds.splice(e,0,t)}},{key:"renameSound",value:function(t,e){var r=this.sprite.sounds.filter(function(e,r){return t!==r}).map(function(t){return t.name}),n=this.sprite.sounds[t].name,i=l.unusedName(e,r);this.sprite.sounds[t].name=i,this.blocks.updateAssetName(n,i,"sound")}},{key:"deleteSound",value:function(t){if(t<0||t>=this.sprite.sounds.length)return null;var e=this.sprite.sounds.splice(t,1)[0];return this.runtime.requestTargetsUpdate(this),e}},{key:"setRotationStyle",value:function(t){if(t===e.ROTATION_STYLE_NONE?this.rotationStyle=e.ROTATION_STYLE_NONE:t===e.ROTATION_STYLE_ALL_AROUND?this.rotationStyle=e.ROTATION_STYLE_ALL_AROUND:t===e.ROTATION_STYLE_LEFT_RIGHT&&(this.rotationStyle=e.ROTATION_STYLE_LEFT_RIGHT),this.renderer){var r=this._getRenderedDirectionAndScale(),n=r.direction,i=r.scale;this.renderer.updateDrawableDirectionScale(this.drawableID,n,i),this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}},{key:"getCostumeIndexByName",value:function(t){for(var e=0;e<this.sprite.costumes.length;e++)if(this.getCostumes()[e].name===t)return e;return-1}},{key:"getCurrentCostume",value:function(){return this.getCostumes()[this.currentCostume]}},{key:"getCostumes",value:function(){return this.sprite.costumes}},{key:"reorderCostume",value:function(t,e){if((e=c.clamp(e,0,this.sprite.costumes.length-1))===(t=c.clamp(t,0,this.sprite.costumes.length-1)))return!1;var r=this.getCurrentCostume(),n=this.sprite.costumes[t];return this.sprite.deleteCostumeAt(t),this.addCostume(n,e),this.currentCostume=this.getCostumeIndexByName(r.name),!0}},{key:"reorderSound",value:function(t,e){if((e=c.clamp(e,0,this.sprite.sounds.length-1))===(t=c.clamp(t,0,this.sprite.sounds.length-1)))return!1;var r=this.sprite.sounds[t];return this.deleteSound(t),this.addSound(r,e),!0}},{key:"getSounds",value:function(){return this.sprite.sounds}},{key:"updateAllDrawableProperties",value:function(){if(this.renderer){var t=this._getRenderedDirectionAndScale(),r=t.direction,n=t.scale;this.renderer.updateDrawablePosition(this.drawableID,[this.x,this.y]),this.renderer.updateDrawableDirectionScale(this.drawableID,r,n),this.renderer.updateDrawableVisible(this.drawableID,this.visible);var i=this.getCostumes()[this.currentCostume],o=i.bitmapResolution||2;for(var a in this.renderer.updateDrawableSkinIdRotationCenter(this.drawableID,i.skinId,[i.rotationCenterX/o,i.rotationCenterY/o]),this.effects)this.effects.hasOwnProperty(a)&&this.renderer.updateDrawableEffect(this.drawableID,a,this.effects[a]);this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw())}this.runtime.requestTargetsUpdate(this)}},{key:"getName",value:function(){return this.sprite.name}},{key:"isSprite",value:function(){return!this.isStage&&this.isOriginal}},{key:"getBounds",value:function(){return this.renderer?this.runtime.renderer.getBounds(this.drawableID):null}},{key:"getBoundsForBubble",value:function(){return this.renderer?this.runtime.renderer.getBoundsForBubble(this.drawableID):null}},{key:"isTouchingObject",value:function(t){if("_mouse_"===t){if(!this.runtime.ioDevices.mouse)return!1;var e=this.runtime.ioDevices.mouse.getClientX(),r=this.runtime.ioDevices.mouse.getClientY();return this.isTouchingPoint(e,r)}return"_edge_"===t?this.isTouchingEdge():this.isTouchingSprite(t)}},{key:"isTouchingPoint",value:function(t,e){return!!this.renderer&&this.renderer.drawableTouching(this.drawableID,t,e)}},{key:"isTouchingEdge",value:function(){if(this.renderer){var t=this.runtime.constructor.STAGE_WIDTH,e=this.runtime.constructor.STAGE_HEIGHT,r=this.getBounds();if(r.left<-t/2||r.right>t/2||r.top>e/2||r.bottom<-e/2)return!0}return!1}},{key:"isTouchingSprite",value:function(t){t=h.toString(t);var e=this.runtime.getSpriteTargetByName(t);if(!e||!this.renderer)return!1;var r=e.sprite.clones.filter(function(t){return!t.dragging}).map(function(t){return t.drawableID});return this.renderer.isTouchingDrawables(this.drawableID,r)}},{key:"isTouchingColor",value:function(t){return!!this.renderer&&this.renderer.isTouchingColor(this.drawableID,t)}},{key:"colorIsTouchingColor",value:function(t,e){return!!this.renderer&&this.renderer.isTouchingColor(this.drawableID,t,e)}},{key:"getLayerOrder",value:function(){return this.renderer?this.renderer.getDrawableOrder(this.drawableID):null}},{key:"goToFront",value:function(){this.renderer&&this.renderer.setDrawableOrder(this.drawableID,1/0,d.SPRITE_LAYER),this.runtime.setExecutablePosition(this,1/0)}},{key:"goToBack",value:function(){this.renderer&&this.renderer.setDrawableOrder(this.drawableID,-1/0,d.SPRITE_LAYER,!1),this.runtime.setExecutablePosition(this,-1/0)}},{key:"goForwardLayers",value:function(t){this.renderer&&this.renderer.setDrawableOrder(this.drawableID,t,d.SPRITE_LAYER,!0),this.runtime.moveExecutable(this,t)}},{key:"goBackwardLayers",value:function(t){this.renderer&&this.renderer.setDrawableOrder(this.drawableID,-t,d.SPRITE_LAYER,!0),this.runtime.moveExecutable(this,-t)}},{key:"goBehindOther",value:function(t){if(this.renderer){var e=this.renderer.setDrawableOrder(t.drawableID,0,d.SPRITE_LAYER,!0);this.renderer.setDrawableOrder(this.drawableID,e,d.SPRITE_LAYER)}var r=this.runtime.executableTargets.indexOf(t);this.runtime.setExecutablePosition(this,r)}},{key:"keepInFence",value:function(t,e,r){var n=r;n||(n={left:-this.runtime.constructor.STAGE_WIDTH/2,right:this.runtime.constructor.STAGE_WIDTH/2,top:this.runtime.constructor.STAGE_HEIGHT/2,bottom:-this.runtime.constructor.STAGE_HEIGHT/2});var i=this.getBounds();if(i){i.left+=t-this.x,i.right+=t-this.x,i.top+=e-this.y,i.bottom+=e-this.y;var o=0,a=0;return i.left<n.left&&(o+=n.left-i.left),i.right>n.right&&(o+=n.right-i.right),i.top>n.top&&(a+=n.top-i.top),i.bottom<n.bottom&&(a+=n.bottom-i.bottom),[t+o,e+a]}}},{key:"makeClone",value:function(){if(!this.runtime.clonesAvailable()||this.isStage)return null;this.runtime.changeCloneCounter(1);var t=this.sprite.createClone();return t.x=this.x,t.y=this.y,t.direction=this.direction,t.draggable=this.draggable,t.visible=this.visible,t.size=this.size,t.currentCostume=this.currentCostume,t.rotationStyle=this.rotationStyle,t.effects=f.simple(this.effects),t.variables=this.duplicateVariables(),t._edgeActivatedHatValues=f.simple(this._edgeActivatedHatValues),t.initDrawable(d.SPRITE_LAYER),t.updateAllDrawableProperties(),t}},{key:"duplicate",value:function(){var t=this;return this.sprite.duplicate().then(function(e){var r=e.createClone();return r.x=400*(Math.random()-.5)/2,r.y=300*(Math.random()-.5)/2,r.direction=t.direction,r.draggable=t.draggable,r.visible=t.visible,r.size=t.size,r.currentCostume=t.currentCostume,r.rotationStyle=t.rotationStyle,r.effects=JSON.parse(JSON.stringify(t.effects)),r.variables=t.duplicateVariables(r.blocks),r.updateAllDrawableProperties(),r})}},{key:"onGreenFlag",value:function(){this.clearEffects()}},{key:"onStopAll",value:function(){this.clearEffects()}},{key:"postSpriteInfo",value:function(t){var e=t.hasOwnProperty("force")?t.force:null,r=t.hasOwnProperty("x"),n=t.hasOwnProperty("y");(r||n)&&this.setXY(r?t.x:this.x,n?t.y:this.y,e),t.hasOwnProperty("direction")&&this.setDirection(t.direction),t.hasOwnProperty("draggable")&&this.setDraggable(t.draggable),t.hasOwnProperty("rotationStyle")&&this.setRotationStyle(t.rotationStyle),t.hasOwnProperty("visible")&&this.setVisible(t.visible),t.hasOwnProperty("size")&&this.setSize(t.size)}},{key:"startDrag",value:function(){this.dragging=!0}},{key:"stopDrag",value:function(){this.dragging=!1}},{key:"toJSON",value:function(){var t=this.getCostumes();return{id:this.id,name:this.getName(),isStage:this.isStage,x:this.x,y:this.y,size:this.size,direction:this.direction,draggable:this.draggable,currentCostume:this.currentCostume,costume:t[this.currentCostume],costumeCount:t.length,visible:this.visible,rotationStyle:this.rotationStyle,comments:this.comments,blocks:this.blocks._blocks,variables:this.variables,costumes:t,sounds:this.getSounds(),textToSpeechLanguage:this.textToSpeechLanguage,tempo:this.tempo,volume:this.volume,videoTransparency:this.videoTransparency,videoState:this.videoState}}},{key:"dispose",value:function(){this.runtime.changeCloneCounter(-1),this.runtime.stopForTarget(this),this.runtime.removeExecutable(this),this.sprite.removeClone(this),this.renderer&&null!==this.drawableID&&(this.renderer.destroyDrawable(this.drawableID,this.isStage?d.BACKGROUND_LAYER:d.SPRITE_LAYER),this.visible&&(this.emit(e.EVENT_TARGET_VISUAL_CHANGE,this),this.runtime.requestRedraw()))}},{key:"audioPlayer",get:function(){var t=this;console.warn("get audioPlayer deprecated, please update to use .sprite.soundBank methods"),console.warn(new Error("stack for debug").stack);var e=this.sprite.soundBank,r={playSound:function(r){return e.play(t,r)}};return Object.defineProperty(this,"audioPlayer",{configurable:!1,enumerable:!0,writable:!1,value:r}),r}}],[{key:"EVENT_TARGET_MOVED",get:function(){return"TARGET_MOVED"}},{key:"EVENT_TARGET_VISUAL_CHANGE",get:function(){return"EVENT_TARGET_VISUAL_CHANGE"}},{key:"ROTATION_STYLE_ALL_AROUND",get:function(){return"all around"}},{key:"ROTATION_STYLE_LEFT_RIGHT",get:function(){return"left-right"}},{key:"ROTATION_STYLE_NONE",get:function(){return"don't rotate"}},{key:"VIDEO_STATE",get:function(){return{OFF:"off",ON:"on",ON_FLIPPED:"on-flipped"}}}]),e}();t.exports=g},function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u=r(40),c=r(20),l=r(34),h=r(84),f=r(9),p=r(19).Map,d=r(3),g=r(39),m=r(85),v=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=o(this,a(e).call(this)),r||(r=new c(t)),n.runtime=t,n.id=f(),n.blocks=r,n.variables={},n.comments={},n._customState={},n._edgeActivatedHatValues={},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(e,u),function(t,e,r){e&&i(t.prototype,e),r&&i(t,r)}(e,[{key:"onGreenFlag",value:function(){}},{key:"getName",value:function(){return this.id}},{key:"updateEdgeActivatedValue",value:function(t,e){var r=this._edgeActivatedHatValues[t];return this._edgeActivatedHatValues[t]=e,r}},{key:"hasEdgeActivatedValue",value:function(t){return this._edgeActivatedHatValues.hasOwnProperty(t)}},{key:"clearEdgeActivatedValues",value:function(){this._edgeActivatedHatValues={}}},{key:"lookupOrCreateVariable",value:function(t,e){var r=this.lookupVariableById(t);if(r)return r;if(r=this.lookupVariableByNameAndType(e,l.SCALAR_TYPE))return r;var n=new l(t,e,l.SCALAR_TYPE,!1);return this.variables[t]=n,n}},{key:"lookupBroadcastMsg",value:function(t,e){var r;if(t?r=this.lookupVariableById(t):e?r=this.lookupBroadcastByInputValue(e):d.error("Cannot find broadcast message if neither id nor name are provided."),r)return e&&r.name.toLowerCase()!==e.toLowerCase()&&d.error("Found broadcast message with id: ".concat(t,", but")+"its name, ".concat(r.name," did not match expected name ").concat(e,".")),r.type!==l.BROADCAST_MESSAGE_TYPE&&d.error("Found variable with id: ".concat(t,", but its type ").concat(r.type)+"did not match expected type ".concat(l.BROADCAST_MESSAGE_TYPE)),r}},{key:"lookupBroadcastByInputValue",value:function(t){var e=this.variables;for(var r in e)if(e[r].type===l.BROADCAST_MESSAGE_TYPE&&e[r].name.toLowerCase()===t.toLowerCase())return e[r]}},{key:"lookupVariableById",value:function(t){if(this.variables.hasOwnProperty(t))return this.variables[t];if(this.runtime&&!this.isStage){var e=this.runtime.getTargetForStage();if(e&&e.variables.hasOwnProperty(t))return e.variables[t]}}},{key:"lookupVariableByNameAndType",value:function(t,e,r){if("string"==typeof t){for(var n in"string"!=typeof e&&(e=l.SCALAR_TYPE),r=r||!1,this.variables){var i=this.variables[n];if(i.name===t&&i.type===e)return i}if(!r&&this.runtime&&!this.isStage){var o=this.runtime.getTargetForStage();if(o)for(var a in o.variables){var s=o.variables[a];if(s.name===t&&s.type===e)return s}}return null}}},{key:"lookupOrCreateList",value:function(t,e){var r=this.lookupVariableById(t);if(r)return r;if(r=this.lookupVariableByNameAndType(e,l.LIST_TYPE))return r;var n=new l(t,e,l.LIST_TYPE,!1);return this.variables[t]=n,n}},{key:"createVariable",value:function(t,e,r,n){if(!this.variables.hasOwnProperty(t)){var i=new l(t,e,r,!1);n&&this.isStage&&this.runtime.canAddCloudVariable()&&(i.isCloud=!0,this.runtime.addCloudVariable(),this.runtime.ioDevices.cloud.requestCreateVariable(i)),this.variables[t]=i}}},{key:"createComment",value:function(t,e,r,n,i,o,a,s){if(!this.comments.hasOwnProperty(t)){var u=new h(t,r,n,i,o,a,s);if(e){u.blockId=e;var c=this.blocks.getBlock(e);c?c.comment=t:d.warn("Could not find block with id ".concat(e," associated with commentId: ").concat(t))}this.comments[t]=u}}},{key:"renameVariable",value:function(t,e){if(this.variables.hasOwnProperty(t)){var r=this.variables[t];if(r.id===t){var n=r.name;if(r.name=e,this.runtime){r.isCloud&&this.isStage&&this.runtime.ioDevices.cloud.requestRenameVariable(n,e);var i=this.runtime.monitorBlocks;i.changeBlock({id:t,element:"field",name:"list"===r.type?"LIST":"VARIABLE",value:t},this.runtime);var o=i.getBlock(r.id);o&&this.runtime.requestUpdateMonitor(p({id:t,params:i._getBlockParams(o)}))}}}}},{key:"deleteVariable",value:function(t){if(this.variables.hasOwnProperty(t)){var e=this.variables[t].name,r=this.variables[t].isCloud;delete this.variables[t],this.runtime&&(r&&this.isStage&&(this.runtime.ioDevices.cloud.requestDeleteVariable(e),this.runtime.removeCloudVariable()),this.runtime.monitorBlocks.deleteBlock(t),this.runtime.requestRemoveMonitor(t))}}},{key:"deleteMonitors",value:function(){var t,e=this;this.runtime.requestRemoveMonitorByTargetId(this.id),t=this.isStage?Object.keys(this.variables):Object.keys(this.runtime.monitorBlocks._blocks).filter(function(t){return e.runtime.monitorBlocks._blocks[t].targetId===e.id});var r=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value;this.runtime.monitorBlocks.deleteBlock(s)}}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}}},{key:"duplicateVariable",value:function(t,e){if(this.variables.hasOwnProperty(t)){var r=this.variables[t],n=new l(e?t:null,r.name,r.type,r.isCloud);return n.type===l.LIST_TYPE?n.value=r.value.slice(0):n.value=r.value,n}return null}},{key:"duplicateVariables",value:function(t){var e,r=this;return t&&(e=t.getAllVariableAndListReferences()),Object.keys(this.variables).reduce(function(n,i){var o=r.duplicateVariable(i,!t);if(n[o.id]=o,t&&e){var a=e[i];a&&r.mergeVariables(i,o.id,a)}return n},{})}},{key:"postSpriteInfo",value:function(){}},{key:"getCustomState",value:function(t){return this._customState[t]}},{key:"setCustomState",value:function(t,e){this._customState[t]=e}},{key:"dispose",value:function(){this._customState={},this.runtime&&this.runtime.removeExecutable(this)}},{key:"getAllVariableNamesInScopeByType",value:function(t,e){"string"!=typeof t&&(t=l.SCALAR_TYPE),e=e||!1;var r=Object.values(this.variables).filter(function(e){return e.type===t}).map(function(t){return t.name});if(e||this.isStage||!this.runtime)return r;var n=this.runtime.getTargetForStage().getAllVariableNamesInScopeByType(t);return r.concat(n)}},{key:"mergeVariables",value:function(t,e,r,n){var i=r||this.blocks.getAllVariableAndListReferences()[t];m.updateVariableIdentifiers(i,e,n)}},{key:"shareLocalVariableToStage",value:function(t,e){if(this.runtime){var r=this.variables[t];if(r){var n=this.runtime.getTargetForStage(),i="StageVarFromLocal_".concat(t),o=n.lookupVariableById(i);if(!o){var a=r.name,s=r.type,u="Stage: ".concat(a);o=this.runtime.createNewGlobalVariable(u,i,s)}this.mergeVariables(t,o.id,e,o.name)}else d.warn("Cannot share a local variable to the stage if it's not local.")}}},{key:"shareLocalVariableToSprite",value:function(t,e,r){if(this.runtime&&!this.isStage){var n=this.variables[t];if(n){var i,o=n.name,a=n.type,s=e.lookupVariableByNameAndType(o,a);if(s)i=s.id;else{var u=new l(null,o,a);i=u.id,e.variables[i]=u}this.mergeVariables(t,i,r)}else d.warn("Tried to call 'shareLocalVariableToSprite' with a non-local variable.")}}},{key:"resolveVariableSharingConflictsWithTarget",value:function(t,e){if(!this.isStage){var r=this.blocks.getAllVariableAndListReferences(t);for(var n in r){if(this.variables[n]){var i=r[n];e.isStage?this.shareLocalVariableToStage(n,i):this.shareLocalVariableToSprite(n,e,i)}}}}},{key:"fixUpVariableReferences",value:function(){var t=this;if(this.runtime&&!this.isStage){var e=this.runtime.getTargetForStage();if(e&&e.variables){var r=function(r,n,i){if(e.lookupVariableByNameAndType(n,i)){var o=g.unusedName("".concat(t.getName(),": ").concat(n),t.getAllVariableNamesInScopeByType(i));return t.renameVariable(r,o),o}return null},n=this.blocks.getAllVariableAndListReferences(),i=[];if(Object.keys(this.variables).length>0)for(var o in this.variables)this.variables.hasOwnProperty(o)&&(n[o]||i.push(o));var a=Object.create(null),s=Object.create(null),u={},c=function(e){var r=u[e];return r||(u[e]=t.runtime.getAllVarNamesOfType(e),u[e])};for(var l in n){var h=n[l][0],f=h.referencingField.value,p=h.type;if(this.lookupVariableById(l))this.variables.hasOwnProperty(l)&&function(){var t=r(l,f,p);t&&n[l].map(function(e){return e.referencingField.value=t,e})}();else{var d=e.lookupVariableByNameAndType(f,p);if(d)a[l]||(a[l]=d.id);else{var m=c(p),v=g.unusedName(f,m);e.createVariable(l,v,p),s[l]||(s[l]=v)}}}for(var _ in i){var y=i[_],b=this.variables[y].name,k=this.variables[y].type;r(y,b,k)}for(var T in a){var S=a[T],w=n[T];this.mergeVariables(T,S,w)}var E=function(t){var e=s[t];n[t].map(function(t){return t.referencingField.value=e,t})};for(var I in s)E(I)}}}}]),e}();t.exports=v},function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=r(41),o=r(6),a=r(9),s=function t(e,r,n,o){e.attribs.id||(e.attribs.id=a());var s={id:e.attribs.id,opcode:e.attribs.type,inputs:{},fields:{},next:null,topLevel:n,parent:o,shadow:"shadow"===e.name,x:e.attribs.x,y:e.attribs.y};r[s.id]=s;for(var u=0;u<e.children.length;u++){for(var c=e.children[u],l=null,h=null,f=0;f<c.children.length;f++){var p=c.children[f];if(p.name){var d=p.name.toLowerCase();"block"===d?l=p:"shadow"===d&&(h=p)}}switch(!l&&h&&(l=h),c.name.toLowerCase()){case"field":var g=c.attribs.name,m=c.attribs.id,v="";v=c.children.length>0&&c.children[0].data?c.children[0].data:"",s.fields[g]={name:g,id:m,value:v};var _=c.attribs.variabletype;"string"==typeof _&&(s.fields[g].variableType=_);break;case"comment":s.comment=c.attribs.id;break;case"value":case"statement":t(l,r,!1,s.id),h&&l!==h&&t(h,r,!1,s.id);var y=c.attribs.name;s.inputs[y]={name:y,block:l.attribs.id,shadow:h?h.attribs.id:null};break;case"next":if(!l||!l.attribs)continue;t(l,r,!1,s.id),s.next=l.attribs.id;break;case"mutation":s.mutation=i(c)}}};t.exports=function(t){if("object"===n(t)&&"object"===n(t.xml))return function(t){for(var e={},r=0;r<t.length;r++){var n=t[r];if(n.name&&n.attribs){var i=n.name.toLowerCase();"block"!==i&&"shadow"!==i||s(n,e,!0,null)}}var o=[];for(var a in e)e.hasOwnProperty(a)&&o.push(e[a]);return o}(o.parseDOM(t.xml.outerHTML,{decodeEntities:!0}))}},function(t){t.exports={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376}},function(t,e,r){var n=r(7),i=/\s+/g,o=r(46),a=r(63);function s(t,e,r){"object"==typeof t?(r=e,e=t,t=null):"function"==typeof e&&(r=e,e=u),this._callback=t,this._options=e||u,this._elementCB=r,this.dom=[],this._done=!1,this._tagStack=[],this._parser=this._parser||null}var u={normalizeWhitespace:!1,withStartIndices:!1,withEndIndices:!1};s.prototype.onparserinit=function(t){this._parser=t},s.prototype.onreset=function(){s.call(this,this._callback,this._options,this._elementCB)},s.prototype.onend=function(){this._done||(this._done=!0,this._parser=null,this._handleCallback(null))},s.prototype._handleCallback=s.prototype.onerror=function(t){if("function"==typeof this._callback)this._callback(t,this.dom);else if(t)throw t},s.prototype.onclosetag=function(){var t=this._tagStack.pop();this._options.withEndIndices&&t&&(t.endIndex=this._parser.endIndex),this._elementCB&&this._elementCB(t)},s.prototype._createDomElement=function(t){if(!this._options.withDomLvl1)return t;var e;for(var r in e="tag"===t.type?Object.create(a):Object.create(o),t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},s.prototype._addDomElement=function(t){var e=this._tagStack[this._tagStack.length-1],r=e?e.children:this.dom,n=r[r.length-1];t.next=null,this._options.withStartIndices&&(t.startIndex=this._parser.startIndex),this._options.withEndIndices&&(t.endIndex=this._parser.endIndex),n?(t.prev=n,n.next=t):t.prev=null,r.push(t),t.parent=e||null},s.prototype.onopentag=function(t,e){var r={type:"script"===t?n.Script:"style"===t?n.Style:n.Tag,name:t,attribs:e,children:[]},i=this._createDomElement(r);this._addDomElement(i),this._tagStack.push(i)},s.prototype.ontext=function(t){var e,r=this._options.normalizeWhitespace||this._options.ignoreWhitespace;if(!this._tagStack.length&&this.dom.length&&(e=this.dom[this.dom.length-1]).type===n.Text)r?e.data=(e.data+t).replace(i," "):e.data+=t;else if(this._tagStack.length&&(e=this._tagStack[this._tagStack.length-1])&&(e=e.children[e.children.length-1])&&e.type===n.Text)r?e.data=(e.data+t).replace(i," "):e.data+=t;else{r&&(t=t.replace(i," "));var o=this._createDomElement({data:t,type:n.Text});this._addDomElement(o)}},s.prototype.oncomment=function(t){var e=this._tagStack[this._tagStack.length-1];if(e&&e.type===n.Comment)e.data+=t;else{var r={data:t,type:n.Comment},i=this._createDomElement(r);this._addDomElement(i),this._tagStack.push(i)}},s.prototype.oncdatastart=function(){var t={children:[{data:"",type:n.Text}],type:n.CDATA},e=this._createDomElement(t);this._addDomElement(e),this._tagStack.push(e)},s.prototype.oncommentend=s.prototype.oncdataend=function(){this._tagStack.pop()},s.prototype.onprocessinginstruction=function(t,e){var r=this._createDomElement({name:t,data:e,type:n.Directive});this._addDomElement(r)},t.exports=s},function(t,e,r){var n=r(46),i=t.exports=Object.create(n),o={tagName:"name"};Object.keys(o).forEach(function(t){var e=o[t];Object.defineProperty(i,t,{get:function(){return this[e]||null},set:function(t){return this[e]=t,t}})})},function(t,e,r){var n=r(6),i=n.DomHandler,o=n.DomUtils;function a(t,e){this.init(t,e)}function s(t,e){return o.getElementsByTagName(t,e,!0)}function u(t,e){return o.getElementsByTagName(t,e,!0,1)[0]}function c(t,e,r){return o.getText(o.getElementsByTagName(t,e,r,1)).trim()}function l(t,e,r,n,i){var o=c(r,n,i);o&&(t[e]=o)}r(15)(a,i),a.prototype.init=i;var h=function(t){return"rss"===t||"feed"===t||"rdf:RDF"===t};a.prototype.onend=function(){var t,e,r={},n=u(h,this.dom);n&&("feed"===n.name?(e=n.children,r.type="atom",l(r,"id","id",e),l(r,"title","title",e),(t=u("link",e))&&(t=t.attribs)&&(t=t.href)&&(r.link=t),l(r,"description","subtitle",e),(t=c("updated",e))&&(r.updated=new Date(t)),l(r,"author","email",e,!0),r.items=s("entry",e).map(function(t){var e,r={};return l(r,"id","id",t=t.children),l(r,"title","title",t),(e=u("link",t))&&(e=e.attribs)&&(e=e.href)&&(r.link=e),(e=c("summary",t)||c("content",t))&&(r.description=e),(e=c("updated",t))&&(r.pubDate=new Date(e)),r})):(e=u("channel",n.children).children,r.type=n.name.substr(0,3),r.id="",l(r,"title","title",e),l(r,"link","link",e),l(r,"description","description",e),(t=c("lastBuildDate",e))&&(r.updated=new Date(t)),l(r,"author","managingEditor",e,!0),r.items=s("item",n.children).map(function(t){var e,r={};return l(r,"id","guid",t=t.children),l(r,"title","title",t),l(r,"link","link",t),l(r,"description","description",t),(e=c("pubDate",t))&&(r.pubDate=new Date(e)),r}))),this.dom=r,i.prototype._handleCallback.call(this,n?null:Error("couldn't find root of feed"))},t.exports=a},function(t,e,r){t.exports=i;var n=r(47);function i(t){n.call(this,new o(this),t)}function o(t){this.scope=t}r(15)(i,n),i.prototype.readable=!0;var a=r(6).EVENTS;Object.keys(a).forEach(function(t){if(0===a[t])o.prototype["on"+t]=function(){this.scope.emit(t)};else if(1===a[t])o.prototype["on"+t]=function(e){this.scope.emit(t,e)};else{if(2!==a[t])throw Error("wrong number of arguments!");o.prototype["on"+t]=function(e,r){this.scope.emit(t,e,r)}}})},function(t,e){},function(t,e,r){"use strict";var n=r(68).Buffer,i=n.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(n.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=c,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=l,this.end=h,e=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(e)}function a(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function s(t){var e=this.lastTotal-this.lastNeed,r=function(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,""}}(this,t);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function l(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function h(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e},o.prototype.text=function(t,e){var r=function(t,e,r){var n=e.length-1;if(n<r)return 0;var i=a(e[n]);if(i>=0)return i>0&&(t.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if((i=a(e[n]))>=0)return i>0&&(t.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if((i=a(e[n]))>=0)return i>0&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,r){var n=r(14),i=n.Buffer;function o(t,e){for(var r in t)e[r]=t[r]}function a(t,e,r){return i(t,e,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(o(n,e),e.Buffer=a),o(i,a),a.from=function(t,e,r){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,r)},a.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=i(t);return void 0!==e?"string"==typeof r?n.fill(e,r):n.fill(e):n.fill(0),n},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},function(t,e,r){function n(t){this._cbs=t||{}}t.exports=n;var i=r(6).EVENTS;Object.keys(i).forEach(function(t){if(0===i[t])t="on"+t,n.prototype[t]=function(){this._cbs[t]&&this._cbs[t]()};else if(1===i[t])t="on"+t,n.prototype[t]=function(e){this._cbs[t]&&this._cbs[t](e)};else{if(2!==i[t])throw Error("wrong number of arguments");t="on"+t,n.prototype[t]=function(e,r){this._cbs[t]&&this._cbs[t](e,r)}}})},function(t,e,r){var n=t.exports;[r(71),r(76),r(77),r(78),r(79),r(80)].forEach(function(t){Object.keys(t).forEach(function(e){n[e]=t[e].bind(n)})})},function(t,e,r){var n=r(7),i=r(72),o=n.isTag;t.exports={getInnerHTML:function(t,e){return t.children?t.children.map(function(t){return i(t,e)}).join(""):""},getOuterHTML:i,getText:function t(e){if(Array.isArray(e))return e.map(t).join("");if(o(e))return"br"===e.name?"\n":t(e.children);if(e.type===n.CDATA)return t(e.children);if(e.type===n.Text)return e.data;return""}}},function(t,e,r){var n=r(7),i=r(73),o={__proto__:null,style:!0,script:!0,xmp:!0,iframe:!0,noembed:!0,noframes:!0,plaintext:!0,noscript:!0};var a={__proto__:null,area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},s=t.exports=function(t,e){Array.isArray(t)||t.cheerio||(t=[t]),e=e||{};for(var r="",i=0;i<t.length;i++){var o=t[i];"root"===o.type?r+=s(o.children,e):n.isTag(o)?r+=u(o,e):o.type===n.Directive?r+=c(o):o.type===n.Comment?r+=f(o):o.type===n.CDATA?r+=h(o):r+=l(o,e)}return r};function u(t,e){"svg"===t.name&&(e={decodeEntities:e.decodeEntities,xmlMode:!0});var r="<"+t.name,n=function(t,e){if(t){var r,n="";for(var o in t)r=t[o],n&&(n+=" "),n+=o,(null!==r&&""!==r||e.xmlMode)&&(n+='="'+(e.decodeEntities?i.encodeXML(r):r)+'"');return n}}(t.attribs,e);return n&&(r+=" "+n),!e.xmlMode||t.children&&0!==t.children.length?(r+=">",t.children&&(r+=s(t.children,e)),a[t.name]&&!e.xmlMode||(r+="</"+t.name+">")):r+="/>",r}function c(t){return"<"+t.data+">"}function l(t,e){var r=t.data||"";return!e.decodeEntities||t.parent&&t.parent.name in o||(r=i.encodeXML(r)),r}function h(t){return"<![CDATA["+t.children[0].data+"]]>"}function f(t){return"\x3c!--"+t.data+"--\x3e"}},function(t,e,r){var n=r(74),i=r(75);e.decode=function(t,e){return(!e||e<=0?i.XML:i.HTML)(t)},e.decodeStrict=function(t,e){return(!e||e<=0?i.XML:i.HTMLStrict)(t)},e.encode=function(t,e){return(!e||e<=0?n.XML:n.HTML)(t)},e.encodeXML=n.XML,e.encodeHTML4=e.encodeHTML5=e.encodeHTML=n.HTML,e.decodeXML=e.decodeXMLStrict=i.XML,e.decodeHTML4=e.decodeHTML5=e.decodeHTML=i.HTML,e.decodeHTML4Strict=e.decodeHTML5Strict=e.decodeHTMLStrict=i.HTMLStrict,e.escape=n.escape},function(t,e,r){var n=s(r(33)),i=u(n);e.XML=p(n,i);var o=s(r(32)),a=u(o);function s(t){return Object.keys(t).sort().reduce(function(e,r){return e[t[r]]="&"+r+";",e},{})}function u(t){var e=[],r=[];return Object.keys(t).forEach(function(t){1===t.length?e.push("\\"+t):r.push(t)}),r.unshift("["+e.join("")+"]"),new RegExp(r.join("|"),"g")}e.HTML=p(o,a);var c=/[^\0-\x7F]/g,l=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;function h(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"}function f(t){return"&#x"+(1024*(t.charCodeAt(0)-55296)+t.charCodeAt(1)-56320+65536).toString(16).toUpperCase()+";"}function p(t,e){function r(e){return t[e]}return function(t){return t.replace(e,r).replace(l,f).replace(c,h)}}var d=u(n);e.escape=function(t){return t.replace(d,h).replace(l,f).replace(c,h)}},function(t,e,r){var n=r(32),i=r(45),o=r(33),a=r(44),s=c(o),u=c(n);function c(t){var e=Object.keys(t).join("|"),r=f(t),n=new RegExp("&(?:"+(e+="|#[xX][\\da-fA-F]+|#\\d+")+");","g");return function(t){return String(t).replace(n,r)}}var l=function(){for(var t=Object.keys(i).sort(h),e=Object.keys(n).sort(h),r=0,o=0;r<e.length;r++)t[o]===e[r]?(e[r]+=";?",o++):e[r]+=";";var a=new RegExp("&(?:"+e.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),s=f(n);function u(t){return";"!==t.substr(-1)&&(t+=";"),s(t)}return function(t){return String(t).replace(a,u)}}();function h(t,e){return t<e?1:-1}function f(t){return function(e){return"#"===e.charAt(1)?"X"===e.charAt(2)||"x"===e.charAt(2)?a(parseInt(e.substr(3),16)):a(parseInt(e.substr(2),10)):t[e.slice(1,-1)]}}t.exports={XML:s,HTML:l,HTMLStrict:u}},function(t,e){var r=e.getChildren=function(t){return t.children},n=e.getParent=function(t){return t.parent};e.getSiblings=function(t){var e=n(t);return e?r(e):[t]},e.getAttributeValue=function(t,e){return t.attribs&&t.attribs[e]},e.hasAttrib=function(t,e){return!!t.attribs&&hasOwnProperty.call(t.attribs,e)},e.getName=function(t){return t.name}},function(t,e){e.removeElement=function(t){if(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.parent){var e=t.parent.children;e.splice(e.lastIndexOf(t),1)}},e.replaceElement=function(t,e){var r=e.prev=t.prev;r&&(r.next=e);var n=e.next=t.next;n&&(n.prev=e);var i=e.parent=t.parent;if(i){var o=i.children;o[o.lastIndexOf(t)]=e}},e.appendChild=function(t,e){if(e.parent=t,1!==t.children.push(e)){var r=t.children[t.children.length-2];r.next=e,e.prev=r,e.next=null}},e.append=function(t,e){var r=t.parent,n=t.next;if(e.next=n,e.prev=t,t.next=e,e.parent=r,n){if(n.prev=e,r){var i=r.children;i.splice(i.lastIndexOf(n),0,e)}}else r&&r.children.push(e)},e.prepend=function(t,e){var r=t.parent;if(r){var n=r.children;n.splice(n.lastIndexOf(t),0,e)}t.prev&&(t.prev.next=e),e.parent=r,e.prev=t.prev,e.next=t,t.prev=e}},function(t,e,r){var n=r(7).isTag;function i(t,e,r,n){for(var o,a=[],s=0,u=e.length;s<u&&!(t(e[s])&&(a.push(e[s]),--n<=0))&&(o=e[s].children,!(r&&o&&o.length>0&&(o=i(t,o,r,n),a=a.concat(o),(n-=o.length)<=0)));s++);return a}t.exports={filter:function(t,e,r,n){Array.isArray(e)||(e=[e]);"number"==typeof n&&isFinite(n)||(n=1/0);return i(t,e,!1!==r,n)},find:i,findOneChild:function(t,e){for(var r=0,n=e.length;r<n;r++)if(t(e[r]))return e[r];return null},findOne:function t(e,r){var i=null;for(var o=0,a=r.length;o<a&&!i;o++)n(r[o])&&(e(r[o])?i=r[o]:r[o].children.length>0&&(i=t(e,r[o].children)));return i},existsOne:function t(e,r){for(var i=0,o=r.length;i<o;i++)if(n(r[i])&&(e(r[i])||r[i].children.length>0&&t(e,r[i].children)))return!0;return!1},findAll:function(t,e){var r=[],i=e.slice();for(;i.length;){var o=i.shift();n(o)&&(o.children&&o.children.length>0&&i.unshift.apply(i,o.children),t(o)&&r.push(o))}return r}}},function(t,e,r){var n=r(7),i=e.isTag=n.isTag;e.testElement=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){if("tag_name"===r){if(!i(e)||!t.tag_name(e.name))return!1}else if("tag_type"===r){if(!t.tag_type(e.type))return!1}else if("tag_contains"===r){if(i(e)||!t.tag_contains(e.data))return!1}else if(!e.attribs||!t[r](e.attribs[r]))return!1}else;return!0};var o={tag_name:function(t){return"function"==typeof t?function(e){return i(e)&&t(e.name)}:"*"===t?i:function(e){return i(e)&&e.name===t}},tag_type:function(t){return"function"==typeof t?function(e){return t(e.type)}:function(e){return e.type===t}},tag_contains:function(t){return"function"==typeof t?function(e){return!i(e)&&t(e.data)}:function(e){return!i(e)&&e.data===t}}};function a(t,e){return"function"==typeof e?function(r){return r.attribs&&e(r.attribs[t])}:function(r){return r.attribs&&r.attribs[t]===e}}function s(t,e){return function(r){return t(r)||e(r)}}e.getElements=function(t,e,r,n){var i=Object.keys(t).map(function(e){var r=t[e];return e in o?o[e](r):a(e,r)});return 0===i.length?[]:this.filter(i.reduce(s),e,r,n)},e.getElementById=function(t,e,r){return Array.isArray(e)||(e=[e]),this.findOne(a("id",t),e,!1!==r)},e.getElementsByTagName=function(t,e,r,n){return this.filter(o.tag_name(t),e,r,n)},e.getElementsByTagType=function(t,e,r,n){return this.filter(o.tag_type(t),e,r,n)}},function(t,e){e.removeSubsets=function(t){for(var e,r,n,i=t.length;--i>-1;){for(e=r=t[i],t[i]=null,n=!0;r;){if(t.indexOf(r)>-1){n=!1,t.splice(i,1);break}r=r.parent}n&&(t[i]=e)}return t};var r=1,n=2,i=4,o=8,a=16,s=e.compareDocumentPosition=function(t,e){var s,u,c,l,h,f,p=[],d=[];if(t===e)return 0;for(s=t;s;)p.unshift(s),s=s.parent;for(s=e;s;)d.unshift(s),s=s.parent;for(f=0;p[f]===d[f];)f++;return 0===f?r:(c=(u=p[f-1]).children,l=p[f],h=d[f],c.indexOf(l)>c.indexOf(h)?u===e?i|a:i:u===t?n|o:n)};e.uniqueSort=function(t){var e,r,o=t.length;for(t=t.slice();--o>-1;)e=t[o],(r=t.indexOf(e))>-1&&r<o&&t.splice(o,1);return t.sort(function(t,e){var r=s(t,e);return r&n?-1:r&i?1:0}),t}},function(t,e,r){function n(t){this._cbs=t||{},this.events=[]}t.exports=n;var i=r(6).EVENTS;Object.keys(i).forEach(function(t){if(0===i[t])t="on"+t,n.prototype[t]=function(){this.events.push([t]),this._cbs[t]&&this._cbs[t]()};else if(1===i[t])t="on"+t,n.prototype[t]=function(e){this.events.push([t,e]),this._cbs[t]&&this._cbs[t](e)};else{if(2!==i[t])throw Error("wrong number of arguments");t="on"+t,n.prototype[t]=function(e,r){this.events.push([t,e,r]),this._cbs[t]&&this._cbs[t](e,r)}}}),n.prototype.onreset=function(){this.events=[],this._cbs.onreset&&this._cbs.onreset()},n.prototype.restart=function(){this._cbs.onreset&&this._cbs.onreset();for(var t=0,e=this.events.length;t<e;t++)if(this._cbs[this.events[t][0]]){var r=this.events[t].length;1===r?this._cbs[this.events[t][0]]():2===r?this._cbs[this.events[t][0]](this.events[t][1]):this._cbs[this.events[t][0]](this.events[t][1],this.events[t][2])}}},function(t,e){var r={amp:"&",apos:"'",lt:"<",gt:">",quot:'"',nbsp:""},n=/&([a-z]+);/gi;t.exports=function(t){return t.replace(n,function(t,e){return e=e.toLowerCase(),r.hasOwnProperty(e)?r[e]:t})}},function(t,e,r){var n=(0,r(19).Record)({id:null,spriteName:null,targetId:null,opcode:null,value:null,params:null,mode:"default",sliderMin:0,sliderMax:100,isDiscrete:!0,x:null,y:null,width:0,height:0,visible:!0});t.exports=n},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(9),o=r(21),a=function(){function t(e,r,n,o,a,s,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e||i(),this.text=r,this.x=n,this.y=o,this.width=Math.max(Number(a),t.MIN_WIDTH),this.height=Math.max(Number(s),t.MIN_HEIGHT),this.minimized=u||!1,this.blockId=null}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"toXML",value:function(){return'<comment id="'.concat(this.id,'" x="').concat(this.x,'" y="').concat(this.y,'" w="').concat(this.width,'" h="').concat(this.height,'" pinned="').concat(null!==this.blockId,'" minimized="').concat(this.minimized,'">').concat(o(this.text),"</comment>")}}],[{key:"MIN_WIDTH",get:function(){return 20}},{key:"MIN_HEIGHT",get:function(){return 20}},{key:"DEFAULT_WIDTH",get:function(){return 100}},{key:"DEFAULT_HEIGHT",get:function(){return 100}}]),t}();t.exports=a},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,null,[{key:"_mergeVarRefObjects",value:function(t,e){for(var r in e)t[r]?t[r]=t[r].concat(e[r]):t[r]=e[r];return t}},{key:"getAllVarRefsForTargets",value:function(e,r){return e.map(function(t){return t.blocks.getAllVariableAndListReferences(null,r)}).reduce(t._mergeVarRefObjects,{})}},{key:"updateVariableIdentifiers",value:function(t,e,r){t.map(function(t){return t.referencingField.id=e,r&&(t.referencingField.value=r),t})}}]),t}();t.exports=n},,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){function n(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=r(183),a=r(55),s=r(3),u=r(57),c=r(19).Map,l=r(2),h=new o,f=-1,p=function(t){return null!==t&&"object"===i(t)&&"function"==typeof t.then},d=function(t,e,r,n,i){var o=n.id,a=n.opcode,s=n._isHat;if(r.pushReportedValue(t),s)if(e.runtime.getIsEdgeActivatedHat(a)){if(!r.stackClick){var l=r.target.hasEdgeActivatedValue(o),h=r.target.updateEdgeActivatedValue(o,t);(l?!h&&t:t)||e.retireThread(r)}}else t?r.status=u.STATUS_RUNNING:e.retireThread(r);else{if(i&&void 0!==t&&r.atStackTop()&&(r.stackClick&&e.runtime.visualReport(o,t),r.updateMonitor)){var f=e.runtime.monitorBlocks.getBlock(o),p=f&&f.targetId;if(p&&!e.runtime.getTargetById(p))return;e.runtime.requestUpdateMonitor(c({id:o,spriteName:p?e.runtime.getTargetById(p).getName():null,value:t}))}r.status=u.STATUS_RUNNING}},g=function(t,e,r,n,i){r.status===u.STATUS_RUNNING&&(r.status=u.STATUS_PROMISE_WAIT),t.then(function(t){if(d(t,e,r,n,i),i&&(void 0===t||!0===t&&n._isHat)){var o,a;do{var s=r.popStack();if(null===s)return;if(null!==(a=r.target.blocks.getNextBlock(s)))break;o=r.peekStackFrame()}while(null!==o&&!o.isLoop);r.pushStack(a)}else i&&!n._parentKey&&r.popStack()},function(t){s.warn("Primitive rejected promise: ",t),r.status=u.STATUS_RUNNING,r.popStack()})},m=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=r.id,this.opcode=r.opcode,this.fields=r.fields,this.inputs=r.inputs,this.mutation=r.mutation,this._profiler=null,this._profilerFrame=null,this._isHat=!1,this._blockFunction=null,this._definedBlockFunction=!1,this._isShadowBlock=!1,this._shadowValue=null,this._fields=Object.assign({},this.fields),this._inputs=Object.assign({},this.inputs),this._argValues={mutation:this.mutation},this._parentKey=null,this._parentValues=null,this._shadowOps=[],this._ops=[];var i=h.sequencer.runtime,o=this.opcode,s=this.fields,u=this.inputs;this._isHat=i.getIsHat(o),this._blockFunction=i.getOpcodeFunction(o),this._definedBlockFunction=void 0!==this._blockFunction;var c=Object.keys(s);for(var l in this._isShadowBlock=!this._definedBlockFunction&&1===c.length&&0===Object.keys(u).length,this._shadowValue=this._isShadowBlock&&s[c[0]].value,s)this._argValues[l]="VARIABLE"===l||"LIST"===l||"BROADCAST_OPTION"===l?{id:s[l].id,name:s[l].value}:s[l].value;if(delete this._inputs.custom_block,"BROADCAST_INPUT"in this._inputs){this._argValues.BROADCAST_OPTION={id:null,name:null};var f=this._inputs.BROADCAST_INPUT;if(f.block===f.shadow){var p=e.getBlock(f.shadow).fields.BROADCAST_OPTION;this._argValues.BROADCAST_OPTION.id=p.id,this._argValues.BROADCAST_OPTION.name=p.value,delete this._inputs.BROADCAST_INPUT}}for(var d in this._inputs){var g=this._inputs[d];if(g.block){var m,v,_=a.getCached(e,g.block,t);if(_._isHat)continue;(m=this._shadowOps).push.apply(m,n(_._shadowOps)),(v=this._ops).push.apply(v,n(_._ops)),_._parentKey=d,_._parentValues=this._argValues,_._isShadowBlock&&(this._argValues[d]=_._shadowValue)}}!this._isHat&&this._isShadowBlock?this._shadowOps.push(this):this._definedBlockFunction&&this._ops.push(this)};t.exports=function(t,e){var r=t.runtime;h.sequencer=t,h.thread=e;var n=e.peekStack(),i=e.peekStackFrame(),o=e.blockContainer,s=a.getCached(o,n,m);if(null!==s||(o=r.flyoutBlocks,null!==(s=a.getCached(o,n,m)))){var c=s._ops,v=c.length,_=0;if(null!==i.reported){for(var y=i.reported,b=function(){var t=y[_],e=t.opCached,r=t.inputValue,n=c.find(function(t){return t.id===e});if(n){var i=n._parentKey,o=n._parentValues;"BROADCAST_INPUT"===i?(o.BROADCAST_OPTION.id=null,o.BROADCAST_OPTION.name=l.toString(r)):o[i]=r}};_<y.length;_++)b();if(y.length>0){var k=y.reverse().find(function(t){return c.find(function(e){return e.id===t.opCached})});_=k?c.findIndex(function(t){return t.id===k.opCached})+1:0}if(null!==e.justReported&&c[_]&&c[_].id===i.reporting){var T=c[_],S=e.justReported;e.justReported=null;var w=T._parentKey,E=T._parentValues;"BROADCAST_INPUT"===w?(E.BROADCAST_OPTION.id=null,E.BROADCAST_OPTION.name=l.toString(S)):E[w]=S,_+=1}i.reporting=null,i.reported=null}for(var I=_;_<v;_++){var A=_===v-1,O=c[_],N=O._blockFunction,x=O._argValues;o.forceNoGlow||(e.requestScriptGlowInFrame=!0);var C=N(x,h);if(p(C)){g(C,t,e,O,A),e.justReported=null,i.reporting=c[_].id,i.reported=c.slice(0,_).map(function(t){var e=t._parentKey,r=t._parentValues;return"BROADCAST_INPUT"===e?{opCached:t.id,inputValue:r[e].BROADCAST_OPTION.name}:{opCached:t.id,inputValue:r[e]}});break}if(e.status===u.STATUS_RUNNING)if(A)d(C,t,e,O,A);else{var D=O._parentKey,R=O._parentValues;"BROADCAST_INPUT"===D?(R.BROADCAST_OPTION.id=null,R.BROADCAST_OPTION.name=l.toString(C)):R[D]=C}}if(null!==r.profiler){s._profiler!==r.profiler&&function(t,e){e._profiler=t,-1===f&&(f=t.idByName("blockFunction"));for(var r=e._ops,n=0;n<r.length;n++)r[n]._profilerFrame=t.frame(f,r[n].opcode)}(r.profiler,s);for(var M=Math.min(_+1,v),L=I;L<M;L++)c[L]._profilerFrame.count+=1}}else t.retireThread(e)}},function(t,e){var r="long",n="short",i="numeric";t.exports={number:{decimal:{style:"decimal"},integer:{style:"decimal",maximumFractionDigits:0},currency:{style:"currency",currency:"USD"},percent:{style:"percent"},default:{style:"decimal"}},date:{short:{month:i,day:i,year:"2-digit"},medium:{month:n,day:i,year:i},long:{month:r,day:i,year:i},full:{month:r,day:i,year:i,weekday:r},default:{month:n,day:i,year:i}},time:{short:{hour:i,minute:i},medium:{hour:i,minute:i,second:i},long:{hour:i,minute:i,second:i,timeZoneName:n},full:{hour:i,minute:i,second:i,timeZoneName:n},default:{hour:i,minute:i,second:i}},duration:{default:{hours:{minimumIntegerDigits:1,maximumFractionDigits:0},minutes:{minimumIntegerDigits:2,maximumFractionDigits:0},seconds:{minimumIntegerDigits:2,maximumFractionDigits:3}}},parseNumberPattern:function(t){if(t){var e={},r=t.match(/\b[A-Z]{3}\b/i),n=t.replace(/[^]/g,"").length;if(!n&&r&&(n=1),n?(e.style="currency",e.currencyDisplay=1===n?"symbol":2===n?"code":"name",e.currency=r?r[0].toUpperCase():"USD"):t.indexOf("%")>=0&&(e.style="percent"),!/[@#0]/.test(t))return e.style?e:void 0;if(e.useGrouping=t.indexOf(",")>=0,/E\+?[@#0]+/i.test(t)||t.indexOf("@")>=0){var i=t.replace(/E\+?[@#0]+|[^@#0]/gi,"");e.minimumSignificantDigits=Math.min(Math.max(i.replace(/[^@0]/g,"").length,1),21),e.maximumSignificantDigits=Math.min(Math.max(i.length,1),21)}else{for(var o=t.replace(/[^#0.]/g,"").split("."),a=o[0],s=a.length-1;"0"===a[s];)--s;e.minimumIntegerDigits=Math.min(Math.max(a.length-1-s,1),21);var u=o[1]||"";for(s=0;"0"===u[s];)++s;for(e.minimumFractionDigits=Math.min(Math.max(s,0),20);"#"===u[s];)++s;e.maximumFractionDigits=Math.min(Math.max(s,0),20)}return e}},parseDatePattern:function(t){if(t){for(var e={},o=0;o<t.length;){for(var a=t[o],s=1;t[++o]===a;)++s;switch(a){case"G":e.era=5===s?"narrow":4===s?r:n;break;case"y":case"Y":e.year=2===s?"2-digit":i;break;case"M":case"L":s=Math.min(Math.max(s-1,0),4),e.month=[i,"2-digit",n,r,"narrow"][s];break;case"E":case"e":case"c":e.weekday=5===s?"narrow":4===s?r:n;break;case"d":case"D":e.day=2===s?"2-digit":i;break;case"h":case"K":e.hour12=!0,e.hour=2===s?"2-digit":i;break;case"H":case"k":e.hour12=!1,e.hour=2===s?"2-digit":i;break;case"m":e.minute=2===s?"2-digit":i;break;case"s":case"S":e.second=2===s?"2-digit":i;break;case"z":case"Z":case"v":case"V":e.timeZoneName=1===s?n:r}}return Object.keys(e).length?e:void 0}}}},function(t,e){t.exports=function(t,e){if("string"==typeof t&&e[t])return t;for(var r=[].concat(t||[]),n=0,i=r.length;n<i;++n)for(var o=r[n].split("-");o.length;){var a=o.join("-");if(e[a])return a;o.pop()}}},function(t,e,r){"use strict";var n="one",i="two",o="few",a="many",s="other",u=[function(t){return 1===+t?n:s},function(t){var e=+t;return 0<=e&&e<=1?n:s},function(t){return 0===Math.floor(Math.abs(+t))||1===+t?n:s},function(t){var e=+t;return 0===e?"zero":1===e?n:2===e?i:3<=e%100&&e%100<=10?o:11<=e%100&&e%100<=99?a:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length;return 1===e&&0===r?n:s},function(t){var e=+t;return e%10==1&&e%100!=11?n:2<=e%10&&e%10<=4&&(e%100<12||14<e%100)?o:e%10==0||5<=e%10&&e%10<=9||11<=e%100&&e%100<=14?a:s},function(t){var e=+t;return e%10==1&&e%100!=11&&e%100!=71&&e%100!=91?n:e%10==2&&e%100!=12&&e%100!=72&&e%100!=92?i:(3<=e%10&&e%10<=4||e%10==9)&&(e%100<10||19<e%100)&&(e%100<70||79<e%100)&&(e%100<90||99<e%100)?o:0!==e&&e%1e6==0?a:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length,i=+(t+".").split(".")[1];return 0===r&&e%10==1&&e%100!=11||i%10==1&&i%100!=11?n:0===r&&2<=e%10&&e%10<=4&&(e%100<12||14<e%100)||2<=i%10&&i%10<=4&&(i%100<12||14<i%100)?o:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length;return 1===e&&0===r?n:2<=e&&e<=4&&0===r?o:0!==r?a:s},function(t){var e=+t;return 0===e?"zero":1===e?n:2===e?i:3===e?o:6===e?a:s},function(t){var e=Math.floor(Math.abs(+t)),r=+(""+t).replace(/^[^.]*.?|0+$/g,"");return 1===+t||0!==r&&(0===e||1===e)?n:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length,a=+(t+".").split(".")[1];return 0===r&&e%100==1||a%100==1?n:0===r&&e%100==2||a%100==2?i:0===r&&3<=e%100&&e%100<=4||3<=a%100&&a%100<=4?o:s},function(t){var e=Math.floor(Math.abs(+t));return 0===e||1===e?n:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length,i=+(t+".").split(".")[1];return 0===r&&(1===e||2===e||3===e)||0===r&&e%10!=4&&e%10!=6&&e%10!=9||0!==r&&i%10!=4&&i%10!=6&&i%10!=9?n:s},function(t){var e=+t;return 1===e?n:2===e?i:3<=e&&e<=6?o:7<=e&&e<=10?a:s},function(t){var e=+t;return 1===e||11===e?n:2===e||12===e?i:3<=e&&e<=10||13<=e&&e<=19?o:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length;return 0===r&&e%10==1?n:0===r&&e%10==2?i:0!==r||e%100!=0&&e%100!=20&&e%100!=40&&e%100!=60&&e%100!=80?0!==r?a:s:o},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length,o=+t;return 1===e&&0===r?n:2===e&&0===r?i:0===r&&(o<0||10<o)&&o%10==0?a:s},function(t){var e=Math.floor(Math.abs(+t)),r=+(""+t).replace(/^[^.]*.?|0+$/g,"");return 0===r&&e%10==1&&e%100!=11||0!==r?n:s},function(t){var e=+t;return 1===e?n:2===e?i:s},function(t){var e=+t;return 0===e?"zero":1===e?n:s},function(t){var e=Math.floor(Math.abs(+t)),r=+t;return 0===r?"zero":0!==e&&1!==e||0===r?s:n},function(t){var e=+(t+".").split(".")[1],r=+t;return r%10==1&&(r%100<11||19<r%100)?n:2<=r%10&&r%10<=9&&(r%100<11||19<r%100)?o:0!==e?a:s},function(t){var e=(t+".").split(".")[1].length,r=+(t+".").split(".")[1],i=+t;return i%10==0||11<=i%100&&i%100<=19||2===e&&11<=r%100&&r%100<=19?"zero":i%10==1&&i%100!=11||2===e&&r%10==1&&r%100!=11||2!==e&&r%10==1?n:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length,i=+(t+".").split(".")[1];return 0===r&&e%10==1&&e%100!=11||i%10==1&&i%100!=11?n:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length,i=+t;return 1===e&&0===r?n:0!==r||0===i||1!==i&&1<=i%100&&i%100<=19?o:s},function(t){var e=+t;return 1===e?n:0===e||2<=e%100&&e%100<=10?o:11<=e%100&&e%100<=19?a:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length;return 1===e&&0===r?n:0===r&&2<=e%10&&e%10<=4&&(e%100<12||14<e%100)?o:0===r&&1!==e&&0<=e%10&&e%10<=1||0===r&&5<=e%10&&e%10<=9||0===r&&12<=e%100&&e%100<=14?a:s},function(t){var e=Math.floor(Math.abs(+t));return 0<=e&&e<=1?n:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length;return 0===r&&e%10==1&&e%100!=11?n:0===r&&2<=e%10&&e%10<=4&&(e%100<12||14<e%100)?o:0===r&&e%10==0||0===r&&5<=e%10&&e%10<=9||0===r&&11<=e%100&&e%100<=14?a:s},function(t){var e=+t;return 0===Math.floor(Math.abs(+t))||1===e?n:2<=e&&e<=10?o:s},function(t){var e=Math.floor(Math.abs(+t)),r=+(t+".").split(".")[1],i=+t;return 0===i||1===i||0===e&&1===r?n:s},function(t){var e=Math.floor(Math.abs(+t)),r=(t+".").split(".")[1].length;return 0===r&&e%100==1?n:0===r&&e%100==2?i:0===r&&3<=e%100&&e%100<=4||0!==r?o:s},function(t){var e=+t;return 0<=e&&e<=1||11<=e&&e<=99?n:s},function(t){var e=+t;return 1===e||5===e||7===e||8===e||9===e||10===e?n:2===e||3===e?i:4===e?o:6===e?a:s},function(t){var e=Math.floor(Math.abs(+t));return e%10==1||e%10==2||e%10==5||e%10==7||e%10==8||e%100==20||e%100==50||e%100==70||e%100==80?n:e%10==3||e%10==4||e%1e3==100||e%1e3==200||e%1e3==300||e%1e3==400||e%1e3==500||e%1e3==600||e%1e3==700||e%1e3==800||e%1e3==900?o:0===e||e%10==6||e%100==40||e%100==60||e%100==90?a:s},function(t){var e=+t;return e%10!=2&&e%10!=3||e%100==12||e%100==13?s:o},function(t){var e=+t;return 1===e||3===e?n:2===e?i:4===e?o:s},function(t){var e=+t;return 0===e||7===e||8===e||9===e?"zero":1===e?n:2===e?i:3===e||4===e?o:5===e||6===e?a:s},function(t){var e=+t;return e%10==1&&e%100!=11?n:e%10==2&&e%100!=12?i:e%10==3&&e%100!=13?o:s},function(t){var e=+t;return 1===e?n:2===e||3===e?i:4===e?o:6===e?a:s},function(t){var e=+t;return 1===e||5===e?n:s},function(t){var e=+t;return 11===e||8===e||80===e||800===e?a:s},function(t){var e=Math.floor(Math.abs(+t));return 1===e?n:0===e||2<=e%100&&e%100<=20||e%100==40||e%100==60||e%100==80?a:s},function(t){var e=+t;return e%10==6||e%10==9||e%10==0&&0!==e?a:s},function(t){var e=Math.floor(Math.abs(+t));return e%10==1&&e%100!=11?n:e%10==2&&e%100!=12?i:e%10!=7&&e%10!=8||e%100==17||e%100==18?s:a},function(t){var e=+t;return 1===e?n:2===e||3===e?i:4===e?o:s},function(t){var e=+t;return 1<=e&&e<=4?n:s},function(t){var e=+t;return 1===e||5===e||7<=e&&e<=9?n:2===e||3===e?i:4===e?o:6===e?a:s},function(t){var e=+t;return 1===e?n:e%10==4&&e%100!=14?a:s},function(t){var e=+t;return e%10!=1&&e%10!=2||e%100==11||e%100==12?s:n},function(t){var e=+t;return e%10==6||e%10==9||10===e?o:s},function(t){var e=+t;return e%10==3&&e%100!=13?o:s}];t.exports={af:{cardinal:u[0]},ak:{cardinal:u[1]},am:{cardinal:u[2]},ar:{cardinal:u[3]},ars:{cardinal:u[3]},as:{cardinal:u[2],ordinal:u[34]},asa:{cardinal:u[0]},ast:{cardinal:u[4]},az:{cardinal:u[0],ordinal:u[35]},be:{cardinal:u[5],ordinal:u[36]},bem:{cardinal:u[0]},bez:{cardinal:u[0]},bg:{cardinal:u[0]},bh:{cardinal:u[1]},bn:{cardinal:u[2],ordinal:u[34]},br:{cardinal:u[6]},brx:{cardinal:u[0]},bs:{cardinal:u[7]},ca:{cardinal:u[4],ordinal:u[37]},ce:{cardinal:u[0]},cgg:{cardinal:u[0]},chr:{cardinal:u[0]},ckb:{cardinal:u[0]},cs:{cardinal:u[8]},cy:{cardinal:u[9],ordinal:u[38]},da:{cardinal:u[10]},de:{cardinal:u[4]},dsb:{cardinal:u[11]},dv:{cardinal:u[0]},ee:{cardinal:u[0]},el:{cardinal:u[0]},en:{cardinal:u[4],ordinal:u[39]},eo:{cardinal:u[0]},es:{cardinal:u[0]},et:{cardinal:u[4]},eu:{cardinal:u[0]},fa:{cardinal:u[2]},ff:{cardinal:u[12]},fi:{cardinal:u[4]},fil:{cardinal:u[13],ordinal:u[0]},fo:{cardinal:u[0]},fr:{cardinal:u[12],ordinal:u[0]},fur:{cardinal:u[0]},fy:{cardinal:u[4]},ga:{cardinal:u[14],ordinal:u[0]},gd:{cardinal:u[15]},gl:{cardinal:u[4]},gsw:{cardinal:u[0]},gu:{cardinal:u[2],ordinal:u[40]},guw:{cardinal:u[1]},gv:{cardinal:u[16]},ha:{cardinal:u[0]},haw:{cardinal:u[0]},he:{cardinal:u[17]},hi:{cardinal:u[2],ordinal:u[40]},hr:{cardinal:u[7]},hsb:{cardinal:u[11]},hu:{cardinal:u[0],ordinal:u[41]},hy:{cardinal:u[12],ordinal:u[0]},io:{cardinal:u[4]},is:{cardinal:u[18]},it:{cardinal:u[4],ordinal:u[42]},iu:{cardinal:u[19]},iw:{cardinal:u[17]},jgo:{cardinal:u[0]},ji:{cardinal:u[4]},jmc:{cardinal:u[0]},ka:{cardinal:u[0],ordinal:u[43]},kab:{cardinal:u[12]},kaj:{cardinal:u[0]},kcg:{cardinal:u[0]},kk:{cardinal:u[0],ordinal:u[44]},kkj:{cardinal:u[0]},kl:{cardinal:u[0]},kn:{cardinal:u[2]},ks:{cardinal:u[0]},ksb:{cardinal:u[0]},ksh:{cardinal:u[20]},ku:{cardinal:u[0]},kw:{cardinal:u[19]},ky:{cardinal:u[0]},lag:{cardinal:u[21]},lb:{cardinal:u[0]},lg:{cardinal:u[0]},ln:{cardinal:u[1]},lt:{cardinal:u[22]},lv:{cardinal:u[23]},mas:{cardinal:u[0]},mg:{cardinal:u[1]},mgo:{cardinal:u[0]},mk:{cardinal:u[24],ordinal:u[45]},ml:{cardinal:u[0]},mn:{cardinal:u[0]},mo:{cardinal:u[25],ordinal:u[0]},mr:{cardinal:u[2],ordinal:u[46]},mt:{cardinal:u[26]},nah:{cardinal:u[0]},naq:{cardinal:u[19]},nb:{cardinal:u[0]},nd:{cardinal:u[0]},ne:{cardinal:u[0],ordinal:u[47]},nl:{cardinal:u[4]},nn:{cardinal:u[0]},nnh:{cardinal:u[0]},no:{cardinal:u[0]},nr:{cardinal:u[0]},nso:{cardinal:u[1]},ny:{cardinal:u[0]},nyn:{cardinal:u[0]},om:{cardinal:u[0]},or:{cardinal:u[0],ordinal:u[48]},os:{cardinal:u[0]},pa:{cardinal:u[1]},pap:{cardinal:u[0]},pl:{cardinal:u[27]},prg:{cardinal:u[23]},ps:{cardinal:u[0]},pt:{cardinal:u[28]},"pt-PT":{cardinal:u[4]},rm:{cardinal:u[0]},ro:{cardinal:u[25],ordinal:u[0]},rof:{cardinal:u[0]},ru:{cardinal:u[29]},rwk:{cardinal:u[0]},saq:{cardinal:u[0]},scn:{cardinal:u[4],ordinal:u[42]},sd:{cardinal:u[0]},sdh:{cardinal:u[0]},se:{cardinal:u[19]},seh:{cardinal:u[0]},sh:{cardinal:u[7]},shi:{cardinal:u[30]},si:{cardinal:u[31]},sk:{cardinal:u[8]},sl:{cardinal:u[32]},sma:{cardinal:u[19]},smi:{cardinal:u[19]},smj:{cardinal:u[19]},smn:{cardinal:u[19]},sms:{cardinal:u[19]},sn:{cardinal:u[0]},so:{cardinal:u[0]},sq:{cardinal:u[0],ordinal:u[49]},sr:{cardinal:u[7]},ss:{cardinal:u[0]},ssy:{cardinal:u[0]},st:{cardinal:u[0]},sv:{cardinal:u[4],ordinal:u[50]},sw:{cardinal:u[4]},syr:{cardinal:u[0]},ta:{cardinal:u[0]},te:{cardinal:u[0]},teo:{cardinal:u[0]},ti:{cardinal:u[1]},tig:{cardinal:u[0]},tk:{cardinal:u[0],ordinal:u[51]},tl:{cardinal:u[13],ordinal:u[0]},tn:{cardinal:u[0]},tr:{cardinal:u[0]},ts:{cardinal:u[0]},tzm:{cardinal:u[33]},ug:{cardinal:u[0]},uk:{cardinal:u[29],ordinal:u[52]},ur:{cardinal:u[4]},uz:{cardinal:u[0]},ve:{cardinal:u[0]},vo:{cardinal:u[0]},vun:{cardinal:u[0]},wa:{cardinal:u[1]},wae:{cardinal:u[0]},xh:{cardinal:u[0]},xog:{cardinal:u[0]},yi:{cardinal:u[4]},zu:{cardinal:u[2]},lo:{ordinal:u[0]},ms:{ordinal:u[0]},vi:{ordinal:u[0]}}},function(t,e,r){function n(t,e,r){return(n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&i(o,r.prototype),o}).apply(null,arguments)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=r(35),u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e,this.provider=null,this._skinId=-1,this._drawable=-1,this._ghost=0,this._forceTransparentPreview=!1}return function(t,e,r){e&&a(t.prototype,e),r&&a(t,r)}(t,[{key:"setProvider",value:function(t){this.provider=t}},{key:"enableVideo",value:function(){var t=this;return this.provider?this.provider.enableVideo().then(function(){return t._setupPreview()}):null}},{key:"disableVideo",value:function(){if(this._disablePreview(),!this.provider)return null;this.provider.disableVideo()}},{key:"getFrame",value:function(e){var r=e.dimensions,n=void 0===r?t.DIMENSIONS:r,i=e.mirror,o=void 0===i?this.mirror:i,a=e.format,s=void 0===a?t.FORMAT_IMAGE_DATA:a,u=e.cacheTimeout,c=void 0===u?this._frameCacheTimeout:u;return this.provider?this.provider.getFrame({dimensions:n,mirror:o,format:s,cacheTimeout:c}):null}},{key:"setPreviewGhost",value:function(t){this._ghost=t,-1!==this._drawable&&this.runtime.renderer.updateDrawableProperties(this._drawable,{ghost:this._forceTransparentPreview?100:t})}},{key:"_disablePreview",value:function(){-1!==this._skinId&&(this.runtime.renderer.updateBitmapSkin(this._skinId,n(ImageData,o(t.DIMENSIONS)),1),this.runtime.renderer.updateDrawableProperties(this._drawable,{visible:!1})),this._renderPreviewFrame=null}},{key:"_setupPreview",value:function(){var e=this,r=this.runtime.renderer;r&&(-1===this._skinId&&-1===this._drawable&&(this._skinId=r.createBitmapSkin(n(ImageData,o(t.DIMENSIONS)),1),this._drawable=r.createDrawable(s.VIDEO_LAYER),r.updateDrawableProperties(this._drawable,{skinId:this._skinId})),this._renderPreviewFrame||(r.updateDrawableProperties(this._drawable,{ghost:this._forceTransparentPreview?100:this._ghost,visible:!0}),this._renderPreviewFrame=function(){if(clearTimeout(e._renderPreviewTimeout),e._renderPreviewFrame){e._renderPreviewTimeout=setTimeout(e._renderPreviewFrame,e.runtime.currentStepTime);var i=e.getFrame({format:t.FORMAT_IMAGE_DATA,cacheTimeout:e.runtime.currentStepTime});i?(r.updateBitmapSkin(e._skinId,i,1),e.runtime.requestRedraw()):r.updateBitmapSkin(e._skinId,n(ImageData,o(t.DIMENSIONS)),1)}},this._renderPreviewFrame()))}},{key:"postData",value:function(t){var e=t.forceTransparentPreview;this._forceTransparentPreview=e,this.setPreviewGhost(this._ghost)}},{key:"videoReady",get:function(){return!!this.provider&&this.provider.videoReady}}],[{key:"FORMAT_IMAGE_DATA",get:function(){return"image-data"}},{key:"FORMAT_CANVAS",get:function(){return"canvas"}},{key:"DIMENSIONS",get:function(){return[480,360]}},{key:"ORDER",get:function(){return 1}}]),t}();t.exports=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(180),o=r(10),a=r(11),s=r(4),u=r(2),c=r(112),l=r(206),h=function(t){return t.default},f={MOTION:"motion",DIRECTION:"direction"},p={STAGE:"Stage",SPRITE:"this sprite"},d={OFF:"off",ON:"on",ON_FLIPPED:"on-flipped"},g=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e,h=r,this.detect=new l,this._lastUpdate=null,this.firstInstall=!0,this.runtime.ioDevices&&(this.runtime.on(i.PROJECT_LOADED,this.updateVideoDisplay.bind(this)),this.runtime.on(i.PROJECT_RUN_START,this.reset.bind(this)),this._loop())}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"updateVideoDisplay",value:function(){this.setVideoTransparency({TRANSPARENCY:this.globalVideoTransparency}),this.videoToggle({VIDEO_STATE:this.globalVideoState})}},{key:"reset",value:function(){this.detect.reset();for(var e=this.runtime.targets,r=0;r<e.length;r++){var n=e[r].getCustomState(t.STATE_KEY);n&&(n.motionAmount=0,n.motionDirection=0)}}},{key:"_loop",value:function(){setTimeout(this._loop.bind(this),Math.max(this.runtime.currentStepTime,t.INTERVAL));var e=Date.now();if(null===this._lastUpdate&&(this._lastUpdate=e),e-this._lastUpdate>t.INTERVAL){var r=this.runtime.ioDevices.video.getFrame({format:c.FORMAT_IMAGE_DATA,dimensions:t.DIMENSIONS});r&&(this._lastUpdate=e,this.detect.addFrame(r.data))}}},{key:"_buildMenu",value:function(t){return t.map(function(t,e){var r={};return r.text=t.name,r.value=t.value||String(e+1),r})}},{key:"_getMotionState",value:function(e){var r=e.getCustomState(t.STATE_KEY);return r||(r=s.simple(t.DEFAULT_MOTION_STATE),e.setCustomState(t.STATE_KEY,r)),r}},{key:"getInfo",value:function(){return this.firstInstall&&(this.globalVideoState=d.ON,this.globalVideoTransparency=50,this.updateVideoDisplay(),this.firstInstall=!1),{id:"videoSensing",name:h({id:"videoSensing.categoryName",default:"Video Sensing",description:"Label for the video sensing extension category"}),blockIconURI:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDBweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDAgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjIgKDY3MTQ1KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5FeHRlbnNpb25zL1NvZnR3YXJlL1ZpZGVvLVNlbnNpbmctQmxvY2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iRXh0ZW5zaW9ucy9Tb2Z0d2FyZS9WaWRlby1TZW5zaW5nLUJsb2NrIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2Utb3BhY2l0eT0iMC4xNSI+CiAgICAgICAgPGcgaWQ9InZpZGVvLW1vdGlvbiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDEwLjAwMDAwMCkiIGZpbGwtcnVsZT0ibm9uemVybyIgc3Ryb2tlPSIjMDAwMDAwIj4KICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC1Db3B5IiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwLjI1IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGN4PSIzMiIgY3k9IjE2IiByPSI0LjUiPjwvY2lyY2xlPgogICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsLUNvcHkiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjeD0iMzIiIGN5PSIxMiIgcj0iNC41Ij48L2NpcmNsZT4KICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC1Db3B5IiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwLjc1IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGN4PSIzMiIgY3k9IjgiIHI9IjQuNSI+PC9jaXJjbGU+CiAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgY3g9IjMyIiBjeT0iNCIgcj0iNC41Ij48L2NpcmNsZT4KICAgICAgICAgICAgPHBhdGggZD0iTTIyLjY3MTk0NzcsNC40MTk1NzY0OSBMMTYuNSw4LjQxOTkxMjk4IEwxNi41LDYuMSBDMTYuNSw0LjA4OTc2NDU0IDE0LjkzNzE4MDYsMi41IDEzLDIuNSBMNC4xLDIuNSBDMi4wNzYxNDIzNywyLjUgMC41LDQuMDc2MTQyMzcgMC41LDYuMSBMMC41LDE0IEMwLjUsMTUuOTI3Mzk4NyAyLjA4NDQ5ODM5LDE3LjUxMTg5NzEgNC4xLDE3LjYgTDEzLDE3LjYgQzE0LjkwMTY2MDIsMTcuNiAxNi41LDE1Ljk0NjU0NSAxNi41LDE0IEwxNi41LDExLjcxNjkwNDggTDIyLjc1NzI0NzksMTUuNDcxMjUzNSBMMjIuODUzNTUzNCwxNS41NDY0NDY2IEMyMi44NzM3ODg2LDE1LjU2NjY4MTggMjIuOTUxNTMxLDE1LjYgMjMsMTUuNiBDMjMuMjY2OTg2NSwxNS42IDIzLjUsMTUuMzgyNTIwNyAyMy41LDE1LjEgTDIzLjUsNC44IEMyMy41LDQuODM2NzY1MzggMjMuNDQzODA1OCw0LjcwNTY0NTYzIDIzLjM3MTI1MzUsNC41NTcyNDc4OCBDMjMuMjI1OTA1Niw0LjMxNTAwMTM5IDIyLjk0MTU5MzcsNC4yNTgxMzg5OSAyMi42NzE5NDc3LDQuNDE5NTc2NDkgWiIgaWQ9InZpZGVvXzM3XyIgZmlsbD0iIzRENEQ0RCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",menuIconURI:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjIgKDY3MTQ1KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5FeHRlbnNpb25zL1NvZnR3YXJlL1ZpZGVvLVNlbnNpbmctTWVudTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJFeHRlbnNpb25zL1NvZnR3YXJlL1ZpZGVvLVNlbnNpbmctTWVudSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9InZpZGVvLW1vdGlvbiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDUuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC1Db3B5IiBmaWxsPSIjMEVCRDhDIiBvcGFjaXR5PSIwLjI1IiBjeD0iMTYiIGN5PSI4IiByPSIyIj48L2NpcmNsZT4KICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC1Db3B5IiBmaWxsPSIjMEVCRDhDIiBvcGFjaXR5PSIwLjUiIGN4PSIxNiIgY3k9IjYiIHI9IjIiPjwvY2lyY2xlPgogICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsLUNvcHkiIGZpbGw9IiMwRUJEOEMiIG9wYWNpdHk9IjAuNzUiIGN4PSIxNiIgY3k9IjQiIHI9IjIiPjwvY2lyY2xlPgogICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsIiBmaWxsPSIjMEVCRDhDIiBjeD0iMTYiIGN5PSIyIiByPSIyIj48L2NpcmNsZT4KICAgICAgICAgICAgPHBhdGggZD0iTTExLjMzNTk3MzksMi4yMDk3ODgyNSBMOC4yNSw0LjIwOTk1NjQ5IEw4LjI1LDMuMDUgQzguMjUsMi4wNDQ4ODIyNyA3LjQ2ODU5MDMxLDEuMjUgNi41LDEuMjUgTDIuMDUsMS4yNSBDMS4wMzgwNzExOSwxLjI1IDAuMjUsMi4wMzgwNzExOSAwLjI1LDMuMDUgTDAuMjUsNyBDMC4yNSw3Ljk2MzY5OTM3IDEuMDQyMjQ5MTksOC43NTU5NDg1NiAyLjA1LDguOCBMNi41LDguOCBDNy40NTA4MzAwOSw4LjggOC4yNSw3Ljk3MzI3MjUgOC4yNSw3IEw4LjI1LDUuODU4NDUyNDEgTDguNjI4NjIzOTQsNi4wODU2MjY3NyBMMTEuNDI2Nzc2Nyw3Ljc3MzIyMzMgQzExLjQzNjg5NDMsNy43ODMzNDA5MSAxMS40NzU3NjU1LDcuOCAxMS41LDcuOCBDMTEuNjMzNDkzMiw3LjggMTEuNzUsNy42OTEyNjAzNCAxMS43NSw3LjU1IEwxMS43NSwyLjQgQzExLjc1LDIuNDE4MzgyNjkgMTEuNzIxOTAyOSwyLjM1MjgyMjgyIDExLjY4NTYyNjgsMi4yNzg2MjM5NCBDMTEuNjEyOTUyOCwyLjE1NzUwMDY5IDExLjQ3MDc5NjgsMi4xMjkwNjk1IDExLjMzNTk3MzksMi4yMDk3ODgyNSBaIiBpZD0idmlkZW9fMzdfIiBzdHJva2Utb3BhY2l0eT0iMC4xNSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjAuNSIgZmlsbD0iIzRENEQ0RCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",blocks:[{opcode:"whenMotionGreaterThan",text:h({id:"videoSensing.whenMotionGreaterThan",default:"when video motion > [REFERENCE]",description:"Event that triggers when the amount of motion is greater than [REFERENCE]"}),blockType:a.HAT,arguments:{REFERENCE:{type:o.NUMBER,defaultValue:10}}},{opcode:"videoOn",blockType:a.REPORTER,text:h({id:"videoSensing.videoOn",default:"video [ATTRIBUTE] on [SUBJECT]",description:"Reporter that returns the amount of [ATTRIBUTE] for the selected [SUBJECT]"}),arguments:{ATTRIBUTE:{type:o.NUMBER,menu:"ATTRIBUTE",defaultValue:f.MOTION},SUBJECT:{type:o.NUMBER,menu:"SUBJECT",defaultValue:p.SPRITE}}},{opcode:"videoToggle",text:h({id:"videoSensing.videoToggle",default:"turn video [VIDEO_STATE]",description:"Controls display of the video preview layer"}),arguments:{VIDEO_STATE:{type:o.NUMBER,menu:"VIDEO_STATE",defaultValue:d.ON}}},{opcode:"setVideoTransparency",text:h({id:"videoSensing.setVideoTransparency",default:"set video transparency to [TRANSPARENCY]",description:"Controls transparency of the video preview layer"}),arguments:{TRANSPARENCY:{type:o.NUMBER,defaultValue:50}}}],menus:{ATTRIBUTE:{acceptReporters:!0,items:this._buildMenu(this.ATTRIBUTE_INFO)},SUBJECT:{acceptReporters:!0,items:this._buildMenu(this.SUBJECT_INFO)},VIDEO_STATE:{acceptReporters:!0,items:this._buildMenu(this.VIDEO_STATE_INFO)}}}}},{key:"_analyzeLocalMotion",value:function(t){var e=this.runtime.renderer._allDrawables[t.drawableID],r=this._getMotionState(t);return this.detect.getLocalMotion(e,r),r}},{key:"videoOn",value:function(t,e){this.detect.analyzeFrame();var r=this.detect;return t.SUBJECT===p.SPRITE&&(r=this._analyzeLocalMotion(e.target)),t.ATTRIBUTE===f.MOTION?r.motionAmount:r.motionDirection}},{key:"whenMotionGreaterThan",value:function(t,e){return this.detect.analyzeFrame(),this._analyzeLocalMotion(e.target).motionAmount>Number(t.REFERENCE)}},{key:"videoToggle",value:function(t){var e=t.VIDEO_STATE;this.globalVideoState=e,e===d.OFF?this.runtime.ioDevices.video.disableVideo():(this.runtime.ioDevices.video.enableVideo(),this.runtime.ioDevices.video.mirror=e===d.ON)}},{key:"setVideoTransparency",value:function(t){var e=u.toNumber(t.TRANSPARENCY);this.globalVideoTransparency=e,this.runtime.ioDevices.video.setPreviewGhost(e)}},{key:"globalVideoTransparency",get:function(){var t=this.runtime.getTargetForStage();return t?t.videoTransparency:50},set:function(t){var e=this.runtime.getTargetForStage();return e&&(e.videoTransparency=t),t}},{key:"globalVideoState",get:function(){var t=this.runtime.getTargetForStage();return t?t.videoState:d.OFF},set:function(t){var e=this.runtime.getTargetForStage();return e&&(e.videoState=t),t}},{key:"ATTRIBUTE_INFO",get:function(){return[{name:h({id:"videoSensing.motion",default:"motion",description:'Attribute for the "video [ATTRIBUTE] on [SUBJECT]" block'}),value:f.MOTION},{name:h({id:"videoSensing.direction",default:"direction",description:'Attribute for the "video [ATTRIBUTE] on [SUBJECT]" block'}),value:f.DIRECTION}]}},{key:"SUBJECT_INFO",get:function(){return[{name:h({id:"videoSensing.sprite",default:"sprite",description:'Subject for the "video [ATTRIBUTE] on [SUBJECT]" block'}),value:p.SPRITE},{name:h({id:"videoSensing.stage",default:"stage",description:'Subject for the "video [ATTRIBUTE] on [SUBJECT]" block'}),value:p.STAGE}]}},{key:"VIDEO_STATE_INFO",get:function(){return[{name:h({id:"videoSensing.off",default:"off",description:'Option for the "turn video [STATE]" block'}),value:d.OFF},{name:h({id:"videoSensing.on",default:"on",description:'Option for the "turn video [STATE]" block'}),value:d.ON},{name:h({id:"videoSensing.onFlipped",default:"on flipped",description:'Option for the "turn video [STATE]" block that causes the video to be flipped horizontally (reversed as in a mirror)'}),value:d.ON_FLIPPED}]}}],[{key:"INTERVAL",get:function(){return 33}},{key:"DIMENSIONS",get:function(){return[480,360]}},{key:"STATE_KEY",get:function(){return"Scratch.videoSensing"}},{key:"DEFAULT_MOTION_STATE",get:function(){return{motionFrameNumber:0,motionAmount:0,motionDirection:0}}},{key:"SensingAttribute",get:function(){return f}},{key:"SensingSubject",get:function(){return p}},{key:"VideoState",get:function(){return d}}]),t}();t.exports=g},function(t,e,r){function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=r(40),h=r(19).OrderedMap,f=r(10),p=r(20),d=r(56),g=r(11),m=r(181),v=r(182),_=r(108),y=r(184),b=r(185),k=r(57),T=r(3),S=r(186),w=r(35),E=r(34),I=r(21),A=r(190),O=r(191),N=r(192),x=r(193),C=r(194),D=r(195),R=r(196),M=r(112),L=r(39),P=r(9),B={scratch3_control:r(197),scratch3_event:r(198),scratch3_looks:r(199),scratch3_motion:r(200),scratch3_operators:r(201),scratch3_sound:r(202),scratch3_sensing:r(203),scratch3_data:r(204),scratch3_procedures:r(205)},U=["#0FBD8C","#0DA57A","#0B8E69"],j=function(){var t={};return t[f.ANGLE]={shadow:{type:"math_angle",fieldName:"NUM"}},t[f.COLOR]={shadow:{type:"colour_picker",fieldName:"COLOUR"}},t[f.NUMBER]={shadow:{type:"math_number",fieldName:"NUM"}},t[f.STRING]={shadow:{type:"text",fieldName:"TEXT"}},t[f.BOOLEAN]={check:"Boolean"},t[f.MATRIX]={shadow:{type:"matrix",fieldName:"MATRIX"}},t[f.NOTE]={shadow:{type:"note",fieldName:"NOTE"}},t[f.IMAGE]={fieldType:"field_image"},t}(),F=function(){var t=0;return{canAddCloudVariable:function(){return t<10},addCloudVariable:function(){t++},removeCloudVariable:function(){t--},hasCloudVariables:function(){return t>0}}},V=-1,q=-1,z=-1,G=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?u(t):e}(this,s(e).call(this))).targets=[],t.executableTargets=[],t.threads=[],t.sequencer=new v(u(t)),t.flyoutBlocks=new p(u(t),!0),t.monitorBlocks=new p(u(t),!0),t._editingTarget=null,t._primitives={},t._blockInfo=[],t._hats={},t._scriptGlowsPreviousFrame=[],t._nonMonitorThreadCount=0,t._lastStepDoneThreads=null,t._cloneCounter=0,t._refreshTargets=!1,t.monitorBlockInfo={},t._monitorState=h({}),t._prevMonitorState=h({}),t.turboMode=!1,t.compatibilityMode=!1,t._steppingInterval=null,t.currentStepTime=null,t.updateCurrentMSecs(),t.redrawRequested=!1,t._registerBlockPackages(),t.ioDevices={clock:new O(u(t)),cloud:new N(u(t)),keyboard:new x(u(t)),mouse:new C(u(t)),mouseWheel:new D(u(t)),userData:new R,video:new M(u(t))},t.peripheralExtensions={},t.profiler=null;var r=F();return t.hasCloudData=r.hasCloudVariables,t.canAddCloudVariable=r.canAddCloudVariable,t.addCloudVariable=t._initializeAddCloudVariable(r),t.removeCloudVariable=t._initializeRemoveCloudVariable(r),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,l),function(t,e,r){e&&a(t.prototype,e),r&&a(t,r)}(e,[{key:"_initializeAddCloudVariable",value:function(t){var r=this;return function(){var n=r.hasCloudData();t.addCloudVariable(),!n&&r.hasCloudData()&&r.emit(e.HAS_CLOUD_DATA_UPDATE,!0)}}},{key:"_initializeRemoveCloudVariable",value:function(t){var r=this;return function(){var n=r.hasCloudData();t.removeCloudVariable(),n&&!r.hasCloudData()&&r.emit(e.HAS_CLOUD_DATA_UPDATE,!1)}}},{key:"_registerBlockPackages",value:function(){for(var t in B)if(B.hasOwnProperty(t)){var e=new B[t](this);if(e.getPrimitives){var r=e.getPrimitives();for(var n in r)r.hasOwnProperty(n)&&(this._primitives[n]=r[n].bind(e))}if(e.getHats){var i=e.getHats();for(var o in i)i.hasOwnProperty(o)&&(this._hats[o]=i[o])}e.getMonitored&&(this.monitorBlockInfo=Object.assign({},this.monitorBlockInfo,e.getMonitored()))}}},{key:"getMonitorState",value:function(){return this._monitorState}},{key:"_makeExtensionMenuId",value:function(t,e){return"".concat(e,"_menu_").concat(I(t))}},{key:"makeMessageContextForTarget",value:function(t){(t=t||this.getEditingTarget()||this.getTargetForStage())&&(t.isStage?b.STAGE:b.SPRITE)}},{key:"_registerExtensionPrimitives",value:function(t){var r={id:t.id,name:S(t.name),showStatusButton:t.showStatusButton,blockIconURI:t.blockIconURI,menuIconURI:t.menuIconURI};for(var n in t.color1?(r.color1=t.color1,r.color2=t.color2,r.color3=t.color3):(r.color1=U[0],r.color2=U[1],r.color3=U[2]),this._blockInfo.push(r),this._fillExtensionCategory(r,t),r.customFieldTypes)if(t.customFieldTypes.hasOwnProperty(n)){var i=r.customFieldTypes[n];this.emit(e.EXTENSION_FIELD_ADDED,{name:"field_".concat(i.extendedName),implementation:i.fieldImplementation})}this.emit(e.EXTENSION_ADDED,r)}},{key:"_refreshExtensionPrimitives",value:function(t){var r=this._blockInfo.find(function(e){return e.id===t.id});r&&(r.name=S(t.name),this._fillExtensionCategory(r,t),this.emit(e.BLOCKSINFO_UPDATE,r))}},{key:"_fillExtensionCategory",value:function(t,e){for(var r in t.blocks=[],t.customFieldTypes={},t.menus=[],t.menuInfo={},e.menus)if(e.menus.hasOwnProperty(r)){var n=e.menus[r],i=this._buildMenuForScratchBlocks(r,n,t);t.menus.push(i),t.menuInfo[r]=n}for(var o in e.customFieldTypes)if(e.customFieldTypes.hasOwnProperty(o)){var a=e.customFieldTypes[o],s=this._buildCustomFieldInfo(o,a,e.id,t);t.customFieldTypes[o]=s}var u=!0,c=!1,l=void 0;try{for(var h,f=e.blocks[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var p=h.value;try{var d=this._convertForScratchBlocks(p,t);if(t.blocks.push(d),d.json){var m=d.json.type;p.blockType!==g.EVENT&&(this._primitives[m]=d.info.func),p.blockType!==g.EVENT&&p.blockType!==g.HAT||(this._hats[m]={edgeActivated:p.isEdgeActivated,restartExistingThreads:p.shouldRestartExistingThreads})}}catch(t){T.error("Error parsing block: ",{block:p,error:t})}}}catch(t){c=!0,l=t}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}},{key:"_convertMenuItems",value:function(t){if("function"!=typeof t){var e=this.makeMessageContextForTarget();return t.map(function(t){var r=S(t,e);switch(o(r)){case"string":return[r,r];case"object":return[S(t.text,e),t.value];default:throw new Error("Can't interpret menu item: ".concat(JSON.stringify(t)))}})}return t}},{key:"_buildMenuForScratchBlocks",value:function(t,e,r){var n=this._makeExtensionMenuId(t,r.id),i=this._convertMenuItems(e.items);return{json:{message0:"%1",type:n,inputsInline:!0,output:"String",colour:r.color1,colourSecondary:r.color2,colourTertiary:r.color3,outputShape:e.acceptReporters?y.OUTPUT_SHAPE_ROUND:y.OUTPUT_SHAPE_SQUARE,args0:[{type:"field_dropdown",name:t,options:i}]}}}},{key:"_buildCustomFieldInfo",value:function(t,e,r,n){var i="".concat(r,"_").concat(t);return{fieldName:t,extendedName:i,argumentTypeInfo:{shadowType:i,fieldType:"field_".concat(i)},scratchBlocksDefinition:this._buildCustomFieldTypeForScratchBlocks(i,e.output,e.outputShape,n),fieldImplementation:e.implementation}}},{key:"_buildCustomFieldTypeForScratchBlocks",value:function(t,e,r,n){return{json:{type:t,message0:"%1",inputsInline:!0,output:e,colour:n.color1,colourSecondary:n.color2,colourTertiary:n.color3,outputShape:r,args0:[{name:"field_".concat(t),type:"field_".concat(t)}]}}}},{key:"_convertForScratchBlocks",value:function(t,e){return"---"===t?this._convertSeparatorForScratchBlocks(t):t.blockType===g.BUTTON?this._convertButtonForScratchBlocks(t):this._convertBlockForScratchBlocks(t,e)}},{key:"_convertBlockForScratchBlocks",value:function(t,e){var r="".concat(e.id,"_").concat(t.opcode),n={type:r,inputsInline:!0,category:e.name,colour:e.color1,colourSecondary:e.color2,colourTertiary:e.color3},i={argsMap:{},blockJSON:n,categoryInfo:e,blockInfo:t,inputList:[]},o=t.blockIconURI||e.blockIconURI;if(o){n.extensions=["scratch_extension"],n.message0="%1 %2";var a={type:"field_image",src:o,width:40,height:40};n.args0=[a,{type:"field_vertical_separator"}]}switch(t.blockType){case g.COMMAND:n.outputShape=y.OUTPUT_SHAPE_SQUARE,n.previousStatement=null,t.isTerminal||(n.nextStatement=null);break;case g.REPORTER:n.output="String",n.outputShape=y.OUTPUT_SHAPE_ROUND;break;case g.BOOLEAN:n.output="Boolean",n.outputShape=y.OUTPUT_SHAPE_HEXAGONAL;break;case g.HAT:case g.EVENT:t.hasOwnProperty("isEdgeActivated")||(t.isEdgeActivated=!0),n.outputShape=y.OUTPUT_SHAPE_SQUARE,n.nextStatement=null;break;case g.CONDITIONAL:case g.LOOP:t.branchCount=t.branchCount||1,n.outputShape=y.OUTPUT_SHAPE_SQUARE,n.previousStatement=null,t.isTerminal||(n.nextStatement=null)}for(var s=Array.isArray(t.text)?t.text:[t.text],u=0,c=0,l=0,h=this._convertPlaceholders.bind(this,i),f=this.makeMessageContextForTarget();u<s.length||c<t.branchCount;){if(u<s.length){i.outLineNum=l;var p=S(s[u],f).replace(/\[(.+?)]/g,h);n["message".concat(l)]?n["message".concat(l)]+=p:n["message".concat(l)]=p,++u,++l}c<t.branchCount&&(n["message".concat(l)]="%1",n["args".concat(l)]=[{type:"input_statement",name:"SUBSTACK".concat(c>0?c+1:"")}],++c,++l)}t.blockType===g.REPORTER?t.disableMonitor||0!==i.inputList.length||(n.checkboxInFlyout=!0):t.blockType===g.LOOP&&(n["lastDummyAlign".concat(l)]="RIGHT",n["message".concat(l)]="%1",n["args".concat(l)]=[{type:"field_image",src:"./static/blocks-media/repeat.svg",width:24,height:24,alt:"*",flip_rtl:!0}],++l);var d=t.isDynamic?'<mutation blockInfo="'.concat(I(JSON.stringify(t)),'"/>'):"",m=i.inputList.join(""),v='<block type="'.concat(r,'">').concat(d).concat(m,"</block>");return{info:i.blockInfo,json:i.blockJSON,xml:v}}},{key:"_convertSeparatorForScratchBlocks",value:function(t){return{info:t,xml:'<sep gap="36"/>'}}},{key:"_convertButtonForScratchBlocks",value:function(t){["MAKE_A_LIST","MAKE_A_PROCEDURE","MAKE_A_VARIABLE"].indexOf(t.func)<0&&T.error("Custom button callbacks not supported yet: ".concat(t.func));var e=this.makeMessageContextForTarget(),r=S(t.text,e);return{info:t,xml:'<button text="'.concat(r,'" callbackKey="').concat(t.func,'"></button>')}}},{key:"_constructInlineImageJson",value:function(t){return t.dataURI||T.warn("Missing data URI in extension block with argument type IMAGE"),{type:"field_image",src:t.dataURI||"",width:24,height:24,flip_rtl:t.flipRTL||!1}}},{key:"_convertPlaceholders",value:function(t,e,r){r=r.replace(/[<"&]/,"_");var n,i=t.blockInfo.arguments[r]||{},o=j[i.type]||{};if(!j[i.type]&&t.categoryInfo.customFieldTypes[i.type]&&(o=t.categoryInfo.customFieldTypes[i.type].argumentTypeInfo),"field_image"===o.fieldType)n=this._constructInlineImageJson(i);else{n={type:"input_value",name:r};var a,s,u,c=void 0===i.defaultValue?"":I(S(i.defaultValue,this.makeMessageContextForTarget()).toString());if(o.check&&(n.check=o.check),i.menu){var l=t.categoryInfo.menuInfo[i.menu];l.acceptReporters?(a=r,s=this._makeExtensionMenuId(i.menu,t.categoryInfo.id),u=i.menu):(n.type="field_dropdown",n.options=this._convertMenuItems(l.items),a=null,s=null,u=r)}else a=r,s=o.shadow&&o.shadow.type||null,u=o.shadow&&o.shadow.fieldName||null;a&&t.inputList.push('<value name="'.concat(r,'">')),s&&t.inputList.push('<shadow type="'.concat(s,'">')),c&&u&&t.inputList.push('<field name="'.concat(u,'">').concat(c,"</field>")),s&&t.inputList.push("</shadow>"),a&&t.inputList.push("</value>")}var h="args".concat(t.outLineNum),f=t.blockJSON[h]=t.blockJSON[h]||[];n&&f.push(n);var p=f.length;return t.argsMap[r]=p,"%".concat(p)}},{key:"getBlocksXML",value:function(){return this._blockInfo.map(function(t){var e=t.name,r=t.color1,n=t.color2,i=t.blocks.filter(function(t){return!t.info.hideFromPalette}),o='colour="'.concat(r,'" secondaryColour="').concat(n,'"'),a="";t.menuIconURI?a=t.menuIconURI:t.blockIconURI&&(a=t.blockIconURI);var s=a?'iconURI="'.concat(a,'"'):"",u="";return t.showStatusButton&&(u='showStatusButton="true"'),{id:t.id,xml:'<category name="'.concat(e,'" id="').concat(t.id,'" ').concat(u," ").concat(o," ").concat(s,">").concat(i.map(function(t){return t.xml}).join(""),"</category>")}})}},{key:"getBlocksJSON",value:function(){return this._blockInfo.reduce(function(t,e){return t.concat(e.blocks.map(function(t){return t.json}))},[])}},{key:"getScratchLinkSocket",value:function(t){return(this._linkSocketFactory||this._defaultScratchLinkSocketFactory)(t)}},{key:"configureScratchLinkSocketFactory",value:function(t){this._linkSocketFactory=t}},{key:"_defaultScratchLinkSocketFactory",value:function(t){return new A(t)}},{key:"registerPeripheralExtension",value:function(t,e){this.peripheralExtensions[t]=e}},{key:"scanForPeripheral",value:function(t){this.peripheralExtensions[t]&&this.peripheralExtensions[t].scan()}},{key:"connectPeripheral",value:function(t,e){this.peripheralExtensions[t]&&this.peripheralExtensions[t].connect(e)}},{key:"disconnectPeripheral",value:function(t){this.peripheralExtensions[t]&&this.peripheralExtensions[t].disconnect()}},{key:"getPeripheralIsConnected",value:function(t){var e=!1;return this.peripheralExtensions[t]&&(e=this.peripheralExtensions[t].isConnected()),e}},{key:"emitMicListening",value:function(t){this.emit(e.MIC_LISTENING,t)}},{key:"getOpcodeFunction",value:function(t){return this._primitives[t]}},{key:"getIsHat",value:function(t){return this._hats.hasOwnProperty(t)}},{key:"getIsEdgeActivatedHat",value:function(t){return this._hats.hasOwnProperty(t)&&this._hats[t].edgeActivated}},{key:"attachAudioEngine",value:function(t){this.audioEngine=t}},{key:"attachRenderer",value:function(t){this.renderer=t,this.renderer.setLayerGroupOrdering(w.LAYER_GROUPS)}},{key:"attachV2SVGAdapter",value:function(t){this.v2SvgAdapter=t}},{key:"attachV2BitmapAdapter",value:function(t){this.v2BitmapAdapter=t}},{key:"attachStorage",value:function(t){this.storage=t}},{key:"_pushThread",value:function(t,e,r){var n=new k(t);return n.target=e,n.stackClick=Boolean(r&&r.stackClick),n.updateMonitor=Boolean(r&&r.updateMonitor),n.blockContainer=n.updateMonitor?this.monitorBlocks:e.blocks,n.pushStack(t),this.threads.push(n),n}},{key:"_stopThread",value:function(t){t.isKilled=!0,this.sequencer.retireThread(t)}},{key:"_restartThread",value:function(t){var e=new k(t.topBlock);e.target=t.target,e.stackClick=t.stackClick,e.updateMonitor=t.updateMonitor,e.blockContainer=t.blockContainer,e.pushStack(t.topBlock);var r=this.threads.indexOf(t);return r>-1?(this.threads[r]=e,e):(this.threads.push(t),t)}},{key:"isActiveThread",value:function(t){return t.stack.length>0&&t.status!==k.STATUS_DONE&&this.threads.indexOf(t)>-1}},{key:"isWaitingThread",value:function(t){return t.status===k.STATUS_PROMISE_WAIT||t.status===k.STATUS_YIELD_TICK||!this.isActiveThread(t)}},{key:"toggleScript",value:function(t,e){e=Object.assign({target:this._editingTarget,stackClick:!1},e);for(var r=0;r<this.threads.length;r++)if(this.threads[r].topBlock===t&&this.threads[r].status!==k.STATUS_DONE){var n=e.target.blocks,i=n.getOpcode(n.getBlock(t));if(this.getIsEdgeActivatedHat(i)&&this.threads[r].stackClick!==e.stackClick)continue;return void this._stopThread(this.threads[r])}this._pushThread(t,e.target,e)}},{key:"addMonitorScript",value:function(t,e){e||(e=this._editingTarget);for(var r=0;r<this.threads.length;r++)if(this.threads[r].topBlock===t&&this.threads[r].status!==k.STATUS_DONE&&this.threads[r].updateMonitor)return;this._pushThread(t,e,{updateMonitor:!0})}},{key:"allScriptsDo",value:function(t,e){var r=this.executableTargets;e&&(r=[e]);for(var n=r.length-1;n>=0;n--)for(var i=r[n],o=i.blocks.getScripts(),a=0;a<o.length;a++){t(o[a],i)}}},{key:"allScriptsByOpcodeDo",value:function(t,e,r){var n=this.executableTargets;r&&(n=[r]);for(var i=n.length-1;i>=0;i--)for(var o=n[i],a=d.getScripts(o.blocks,t),s=0;s<a.length;s++)e(a[s],o)}},{key:"startHats",value:function(t,e,r){var n=this;if(this._hats.hasOwnProperty(t)){var i=[],o=this._hats[t];for(var a in e)e.hasOwnProperty(a)&&(e[a]=e[a].toUpperCase());return this.allScriptsByOpcodeDo(t,function(t,r){var a=t.blockId,s=t.fieldsOfInputs;for(var u in e)if(s[u].value!==e[u])return;if(o.restartExistingThreads){for(var c=0;c<n.threads.length;c++)if(n.threads[c].target===r&&n.threads[c].topBlock===a&&!n.threads[c].stackClick)return void i.push(n._restartThread(n.threads[c]))}else for(var l=0;l<n.threads.length;l++)if(n.threads[l].target===r&&n.threads[l].topBlock===a&&!n.threads[l].stackClick&&n.threads[l].status!==k.STATUS_DONE)return;i.push(n._pushThread(a,r))},r),i.forEach(function(t){_(n.sequencer,t),t.status===k.STATUS_RUNNING&&t.goToNextBlock()}),i}}},{key:"dispose",value:function(){this.stopAll(),this.targets.forEach(function(t){t.isOriginal&&t.deleteMonitors()}),this.targets.map(this.disposeTarget,this),this._monitorState=h({}),this.emit(e.RUNTIME_DISPOSED),this.hasCloudData()&&this.emit(e.HAS_CLOUD_DATA_UPDATE,!1),this.ioDevices.cloud.clear();var t=F();this.hasCloudData=t.hasCloudVariables,this.canAddCloudVariable=t.canAddCloudVariable,this.addCloudVariable=this._initializeAddCloudVariable(t),this.removeCloudVariable=this._initializeRemoveCloudVariable(t)}},{key:"addTarget",value:function(t){this.targets.push(t),this.executableTargets.push(t)}},{key:"moveExecutable",value:function(t,e){var r=this.executableTargets.indexOf(t);this.executableTargets.splice(r,1);var n=r+e;return n>this.executableTargets.length&&(n=this.executableTargets.length),n<=0&&(n=this.executableTargets.length>0&&this.executableTargets[0].isStage?1:0),this.executableTargets.splice(n,0,t),n}},{key:"setExecutablePosition",value:function(t,e){var r=this.executableTargets.indexOf(t);return this.moveExecutable(t,e-r)}},{key:"removeExecutable",value:function(t){var e=this.executableTargets.indexOf(t);e>-1&&this.executableTargets.splice(e,1)}},{key:"disposeTarget",value:function(t){this.targets=this.targets.filter(function(e){return t!==e||(e.dispose(),!1)})}},{key:"stopForTarget",value:function(t,r){this.emit(e.STOP_FOR_TARGET,t,r);for(var n=0;n<this.threads.length;n++)this.threads[n]!==r&&this.threads[n].target===t&&this._stopThread(this.threads[n])}},{key:"greenFlag",value:function(){this.stopAll(),this.emit(e.PROJECT_START),this.ioDevices.clock.resetProjectTimer(),this.targets.forEach(function(t){return t.clearEdgeActivatedValues()});for(var t=0;t<this.targets.length;t++)this.targets[t].onGreenFlag();this.startHats("event_whenflagclicked")}},{key:"stopAll",value:function(){this.emit(e.PROJECT_STOP_ALL);for(var t=[],r=0;r<this.targets.length;r++)this.targets[r].onStopAll(),this.targets[r].hasOwnProperty("isOriginal")&&!this.targets[r].isOriginal?this.targets[r].dispose():t.push(this.targets[r]);this.targets=t,null!==this.sequencer.activeThread&&this._stopThread(this.sequencer.activeThread),this.threads=[]}},{key:"_step",value:function(){for(var t in null!==this.profiler&&(-1===V&&(V=this.profiler.idByName("Runtime._step")),this.profiler.start(V)),this.threads=this.threads.filter(function(t){return!t.isKilled}),this._hats){if(this._hats.hasOwnProperty(t))this._hats[t].edgeActivated&&this.startHats(t)}this.redrawRequested=!1,this._pushMonitors(),null!==this.profiler&&(-1===q&&(q=this.profiler.idByName("Sequencer.stepThreads")),this.profiler.start(q));var r=this.sequencer.stepThreads();null!==this.profiler&&this.profiler.stop(),this._updateGlows(r),this._emitProjectRunStatus(this.threads.length+r.length-this._getMonitorThreadCount([].concat(i(this.threads),i(r)))),this._lastStepDoneThreads=r,this.renderer&&(null!==this.profiler&&(-1===z&&(z=this.profiler.idByName("RenderWebGL.draw")),this.profiler.start(z)),this.renderer.draw(),null!==this.profiler&&this.profiler.stop()),this._refreshTargets&&(this.emit(e.TARGETS_UPDATE,!1),this._refreshTargets=!1),this._prevMonitorState.equals(this._monitorState)||(this.emit(e.MONITORS_UPDATE,this._monitorState),this._prevMonitorState=this._monitorState),null!==this.profiler&&(this.profiler.stop(),this.profiler.reportFrames())}},{key:"_getMonitorThreadCount",value:function(t){var e=0;return t.forEach(function(t){t.updateMonitor&&e++}),e}},{key:"_pushMonitors",value:function(){this.monitorBlocks.runAllMonitored(this)}},{key:"setEditingTarget",value:function(t){var e=this._editingTarget;this._editingTarget=t,this._scriptGlowsPreviousFrame=[],this._updateGlows(),e!==this._editingTarget&&this.requestToolboxExtensionsUpdate()}},{key:"setCompatibilityMode",value:function(t){this.compatibilityMode=t,this._steppingInterval&&(clearInterval(this._steppingInterval),this._steppingInterval=null,this.start())}},{key:"_updateGlows",value:function(t){var e=[];e.push.apply(e,this.threads),t&&e.push.apply(e,t);for(var r=[],n=[],i=0;i<e.length;i++){var o=e[i],a=o.target;if(a===this._editingTarget){var s=o.blockGlowInFrame;if(o.requestScriptGlowInFrame||o.stackClick){var u=a.blocks.getTopLevelScript(s);u||(u=this.flyoutBlocks.getTopLevelScript(s)),u&&r.push(u)}}}for(var c=0;c<this._scriptGlowsPreviousFrame.length;c++){var l=this._scriptGlowsPreviousFrame[c];r.indexOf(l)<0?this.glowScript(l,!1):n.push(l)}for(var h=0;h<r.length;h++){var f=r[h];this._scriptGlowsPreviousFrame.indexOf(f)<0&&(this.glowScript(f,!0),n.push(f))}this._scriptGlowsPreviousFrame=n}},{key:"_emitProjectRunStatus",value:function(t){0===this._nonMonitorThreadCount&&t>0&&this.emit(e.PROJECT_RUN_START),this._nonMonitorThreadCount>0&&0===t&&this.emit(e.PROJECT_RUN_STOP),this._nonMonitorThreadCount=t}},{key:"quietGlow",value:function(t){var e=this._scriptGlowsPreviousFrame.indexOf(t);e>-1&&this._scriptGlowsPreviousFrame.splice(e,1)}},{key:"glowBlock",value:function(t,r){r?this.emit(e.BLOCK_GLOW_ON,{id:t}):this.emit(e.BLOCK_GLOW_OFF,{id:t})}},{key:"glowScript",value:function(t,r){r?this.emit(e.SCRIPT_GLOW_ON,{id:t}):this.emit(e.SCRIPT_GLOW_OFF,{id:t})}},{key:"emitBlockDragUpdate",value:function(t){this.emit(e.BLOCK_DRAG_UPDATE,t)}},{key:"emitBlockEndDrag",value:function(t,r){this.emit(e.BLOCK_DRAG_END,t,r)}},{key:"visualReport",value:function(t,r){this.emit(e.VISUAL_REPORT,{id:t,value:String(r)})}},{key:"requestAddMonitor",value:function(t){var e=t.get("id");this.requestUpdateMonitor(t)||(this._monitorState=this._monitorState.set(e,t))}},{key:"requestUpdateMonitor",value:function(t){var e=t.get("id");return!!this._monitorState.has(e)&&(this._monitorState=this._monitorState.set(e,this._monitorState.get(e).mergeWith(function(t,e){return void 0===e||null===e?t:e},t)),!0)}},{key:"requestRemoveMonitor",value:function(t){this._monitorState=this._monitorState.delete(t)}},{key:"requestHideMonitor",value:function(t){return this.requestUpdateMonitor(new Map([["id",t],["visible",!1]]))}},{key:"requestShowMonitor",value:function(t){return this.requestUpdateMonitor(new Map([["id",t],["visible",!0]]))}},{key:"requestRemoveMonitorByTargetId",value:function(t){this._monitorState=this._monitorState.filterNot(function(e){return e.targetId===t})}},{key:"getTargetById",value:function(t){for(var e=0;e<this.targets.length;e++){var r=this.targets[e];if(r.id===t)return r}}},{key:"getSpriteTargetByName",value:function(t){for(var e=0;e<this.targets.length;e++){var r=this.targets[e];if(!r.isStage&&(r.sprite&&r.sprite.name===t))return r}}},{key:"getTargetByDrawableId",value:function(t){for(var e=0;e<this.targets.length;e++){var r=this.targets[e];if(r.drawableID===t)return r}}},{key:"changeCloneCounter",value:function(t){this._cloneCounter+=t}},{key:"clonesAvailable",value:function(){return this._cloneCounter<e.MAX_CLONES}},{key:"emitProjectLoaded",value:function(){this.emit(e.PROJECT_LOADED)}},{key:"emitProjectChanged",value:function(){this.emit(e.PROJECT_CHANGED)}},{key:"fireTargetWasCreated",value:function(t,e){this.emit("targetWasCreated",t,e)}},{key:"fireTargetWasRemoved",value:function(t){this.emit("targetWasRemoved",t)}},{key:"getTargetForStage",value:function(){for(var t=0;t<this.targets.length;t++){var e=this.targets[t];if(e.isStage)return e}}},{key:"getEditingTarget",value:function(){return this._editingTarget}},{key:"getAllVarNamesOfType",value:function(t){var e=[],r=!0,n=!1,i=void 0;try{for(var o,a=this.targets[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var s=o.value.getAllVariableNamesInScopeByType(t,!0);e=e.concat(s)}}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return e}},{key:"getLabelForOpcode",value:function(t){var e=n(L.splitFirst(t,"_"),2),r=e[0],i=e[1];if(r&&i){var o=this._blockInfo.find(function(t){return t.id===r});if(o){var a=o.blocks.find(function(t){return t.info.opcode===i});if(a)return{category:"extension",label:"".concat(o.name,": ").concat(a.info.text)}}}}},{key:"createNewGlobalVariable",value:function(t,e,r){var n="string"==typeof r?r:E.SCALAR_TYPE,i=this.getAllVarNamesOfType(n),o=L.unusedName(t,i),a=new E(e||P(),o,n);return this.getTargetForStage().variables[a.id]=a,a}},{key:"requestRedraw",value:function(){this.redrawRequested=!0}},{key:"requestTargetsUpdate",value:function(t){t.isOriginal&&(this._refreshTargets=!0)}},{key:"requestBlocksUpdate",value:function(){this.emit(e.BLOCKS_NEED_UPDATE)}},{key:"requestToolboxExtensionsUpdate",value:function(){this.emit(e.TOOLBOX_EXTENSIONS_NEED_UPDATE)}},{key:"start",value:function(){var t=this;if(!this._steppingInterval){var r=e.THREAD_STEP_INTERVAL;this.compatibilityMode&&(r=e.THREAD_STEP_INTERVAL_COMPATIBILITY),this.currentStepTime=r,this._steppingInterval=setInterval(function(){t._step()},r),this.emit(e.RUNTIME_STARTED)}}},{key:"enableProfiling",value:function(t){m.available()&&(this.profiler=new m(t))}},{key:"disableProfiling",value:function(){this.profiler=null}},{key:"updateCurrentMSecs",value:function(){this.currentMSecs=Date.now()}}],[{key:"STAGE_WIDTH",get:function(){return 480}},{key:"STAGE_HEIGHT",get:function(){return 360}},{key:"SCRIPT_GLOW_ON",get:function(){return"SCRIPT_GLOW_ON"}},{key:"SCRIPT_GLOW_OFF",get:function(){return"SCRIPT_GLOW_OFF"}},{key:"BLOCK_GLOW_ON",get:function(){return"BLOCK_GLOW_ON"}},{key:"BLOCK_GLOW_OFF",get:function(){return"BLOCK_GLOW_OFF"}},{key:"HAS_CLOUD_DATA_UPDATE",get:function(){return"HAS_CLOUD_DATA_UPDATE"}},{key:"TURBO_MODE_ON",get:function(){return"TURBO_MODE_ON"}},{key:"TURBO_MODE_OFF",get:function(){return"TURBO_MODE_OFF"}},{key:"PROJECT_START",get:function(){return"PROJECT_START"}},{key:"PROJECT_RUN_START",get:function(){return"PROJECT_RUN_START"}},{key:"PROJECT_RUN_STOP",get:function(){return"PROJECT_RUN_STOP"}},{key:"PROJECT_STOP_ALL",get:function(){return"PROJECT_STOP_ALL"}},{key:"STOP_FOR_TARGET",get:function(){return"STOP_FOR_TARGET"}},{key:"VISUAL_REPORT",get:function(){return"VISUAL_REPORT"}},{key:"PROJECT_LOADED",get:function(){return"PROJECT_LOADED"}},{key:"PROJECT_CHANGED",get:function(){return"PROJECT_CHANGED"}},{key:"TOOLBOX_EXTENSIONS_NEED_UPDATE",get:function(){return"TOOLBOX_EXTENSIONS_NEED_UPDATE"}},{key:"TARGETS_UPDATE",get:function(){return"TARGETS_UPDATE"}},{key:"MONITORS_UPDATE",get:function(){return"MONITORS_UPDATE"}},{key:"BLOCK_DRAG_UPDATE",get:function(){return"BLOCK_DRAG_UPDATE"}},{key:"BLOCK_DRAG_END",get:function(){return"BLOCK_DRAG_END"}},{key:"EXTENSION_ADDED",get:function(){return"EXTENSION_ADDED"}},{key:"EXTENSION_FIELD_ADDED",get:function(){return"EXTENSION_FIELD_ADDED"}},{key:"PERIPHERAL_LIST_UPDATE",get:function(){return"PERIPHERAL_LIST_UPDATE"}},{key:"PERIPHERAL_CONNECTED",get:function(){return"PERIPHERAL_CONNECTED"}},{key:"PERIPHERAL_DISCONNECTED",get:function(){return"PERIPHERAL_DISCONNECTED"}},{key:"PERIPHERAL_REQUEST_ERROR",get:function(){return"PERIPHERAL_REQUEST_ERROR"}},{key:"PERIPHERAL_CONNECTION_LOST_ERROR",get:function(){return"PERIPHERAL_CONNECTION_LOST_ERROR"}},{key:"PERIPHERAL_SCAN_TIMEOUT",get:function(){return"PERIPHERAL_SCAN_TIMEOUT"}},{key:"MIC_LISTENING",get:function(){return"MIC_LISTENING"}},{key:"BLOCKSINFO_UPDATE",get:function(){return"BLOCKSINFO_UPDATE"}},{key:"RUNTIME_STARTED",get:function(){return"RUNTIME_STARTED"}},{key:"RUNTIME_DISPOSED",get:function(){return"RUNTIME_DISPOSED"}},{key:"BLOCKS_NEED_UPDATE",get:function(){return"BLOCKS_NEED_UPDATE"}},{key:"THREAD_STEP_INTERVAL",get:function(){return 1e3/60}},{key:"THREAD_STEP_INTERVAL_COMPATIBILITY",get:function(){return 1e3/30}},{key:"MAX_CLONES",get:function(){return 300}}]),e}();t.exports=G},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=0,a={},s=0,u=1,c="object"===("undefined"==typeof window?"undefined":i(window))&&window.performance,l=function t(e){n(this,t),this.id=-1,this.totalTime=0,this.selfTime=0,this.arg=null,this.depth=e,this.count=0},h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};n(this,t),this.records=[],this.increments=[],this.counters=[],this.nullFrame=new l(-1),this._stack=[new l(0)],this.onFrame=e,this.START=s,this.STOP=u}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"start",value:function(t,e){this.records.push(s,t,e,c.now())}},{key:"stop",value:function(){this.records.push(u,c.now())}},{key:"increment",value:function(t){this.increments[t]||(this.increments[t]=new l(-1),this.increments[t].id=t),this.increments[t].count+=1}},{key:"frame",value:function(t,e){for(var r=0;r<this.counters.length;r++)if(this.counters[r].id===t&&this.counters[r].arg===e)return this.counters[r];var n=new l(-1);return n.id=t,n.arg=e,this.counters.push(n),n}},{key:"reportFrames",value:function(){for(var t=this._stack,e=1,r=0;r<this.records.length;)if(this.records[r]===s){e>=t.length&&t.push(new l(e));var n=t[e++];n.id=this.records[r+1],n.arg=this.records[r+2],n.totalTime=this.records[r+3],n.selfTime=0,r+=4}else{if(this.records[r]!==u)throw this.records.length=0,new Error("Unable to decode Profiler records.");var i=this.records[r+1],o=t[--e];o.totalTime=i-o.totalTime,o.selfTime+=o.totalTime,t[e-1].selfTime-=o.totalTime,o.count=1,this.onFrame(o),r+=2}for(var a=0;a<this.increments.length;a++)this.increments[a]&&this.increments[a].count>0&&(this.onFrame(this.increments[a]),this.increments[a].count=0);for(var c=0;c<this.counters.length;c++)this.counters[c].count>0&&(this.onFrame(this.counters[c]),this.counters[c].count=0);this.records.length=0}},{key:"idByName",value:function(e){return t.idByName(e)}},{key:"nameById",value:function(e){return t.nameById(e)}}],[{key:"idByName",value:function(t){return"number"!=typeof a[t]&&(a[t]=o++),a[t]}},{key:"nameById",value:function(t){for(var e in a)if(a[e]===t)return e;return null}},{key:"available",value:function(){return"object"===("undefined"==typeof window?"undefined":i(window))&&void 0!==window.performance}}]),t}();h.START=s,h.STOP=u,t.exports=h},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(36),o=r(57),a=r(108),s=-1,u=-1,c=-1,l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.timer=new i,this.runtime=e,this.activeThread=null}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"stepThreads",value:function(){var t=.75*this.runtime.currentStepTime;this.runtime.updateCurrentMSecs(),this.timer.start();for(var e=1/0,r=!1,n=[];this.runtime.threads.length>0&&e>0&&this.timer.timeElapsed()<t&&(this.runtime.turboMode||!this.runtime.redrawRequested);){null!==this.runtime.profiler&&(-1===u&&(u=this.runtime.profiler.idByName("Sequencer.stepThreads#inner")),this.runtime.profiler.start(u)),e=0;for(var i=!1,a=this.runtime.threads,c=0;c<a.length;c++){var l=this.activeThread=a[c];0!==l.stack.length&&l.status!==o.STATUS_DONE?(l.status!==o.STATUS_YIELD_TICK||r||(l.status=o.STATUS_RUNNING),l.status!==o.STATUS_RUNNING&&l.status!==o.STATUS_YIELD||(null!==this.runtime.profiler&&(-1===s&&(s=this.runtime.profiler.idByName("Sequencer.stepThread")),this.runtime.profiler.increment(s)),this.stepThread(l),l.warpTimer=null,l.isKilled&&c--),l.status===o.STATUS_RUNNING&&e++,0!==l.stack.length&&l.status!==o.STATUS_DONE||(i=!0)):i=!0}if(r=!0,null!==this.runtime.profiler&&this.runtime.profiler.stop(),i){for(var h=0,f=0;f<this.runtime.threads.length;f++){var p=this.runtime.threads[f];0!==p.stack.length&&p.status!==o.STATUS_DONE?(this.runtime.threads[h]=p,h++):n.push(p)}this.runtime.threads.length=h}}return this.activeThread=null,n}},{key:"stepThread",value:function(e){var r=e.peekStack();if(r||(e.popStack(),0!==e.stack.length))for(;r=e.peekStack();){var n=e.peekStackFrame().warpMode;if(n&&!e.warpTimer&&(e.warpTimer=new i,e.warpTimer.start()),null!==this.runtime.profiler&&(-1===c&&(c=this.runtime.profiler.idByName("execute")),this.runtime.profiler.increment(c)),null===e.target?this.retireThread(e):a(this,e),e.blockGlowInFrame=r,e.status===o.STATUS_YIELD){if(e.status=o.STATUS_RUNNING,n&&e.warpTimer.timeElapsed()<=t.WARP_TIME)continue;return}if(e.status===o.STATUS_PROMISE_WAIT)return;if(e.status===o.STATUS_YIELD_TICK)return;for(e.peekStack()===r&&e.goToNextBlock();!e.peekStack();){if(e.popStack(),0===e.stack.length)return void(e.status=o.STATUS_DONE);var s=e.peekStackFrame();if(n=s.warpMode,s.isLoop){if(!n||e.warpTimer.timeElapsed()>t.WARP_TIME)return}else{if(s.waitingReporter)return;e.goToNextBlock()}}}else e.status=o.STATUS_DONE}},{key:"stepToBranch",value:function(t,e,r){e||(e=1);var n=t.peekStack(),i=t.target.blocks.getBranch(n,e);t.peekStackFrame().isLoop=r,i?t.pushStack(i):t.pushStack(null)}},{key:"stepToProcedure",value:function(e,r){var n=e.target.blocks.getProcedureDefinition(r);if(n){var i=e.isRecursiveCall(r);if(e.pushStack(n),e.peekStackFrame().warpMode&&e.warpTimer.timeElapsed()>t.WARP_TIME)e.status=o.STATUS_YIELD;else{var a=e.target.blocks.getBlock(n),s=e.target.blocks.getBlock(a.inputs.custom_block.block),u=!1;if(s&&s.mutation){var c=s.mutation.warp;"boolean"==typeof c?u=c:"string"==typeof c&&(u=JSON.parse(c))}u?e.peekStackFrame().warpMode=!0:i&&(e.status=o.STATUS_YIELD)}}}},{key:"retireThread",value:function(t){t.stack=[],t.stackFrame=[],t.requestScriptGlowInFrame=!1,t.status=o.STATUS_DONE}}],[{key:"WARP_TIME",get:function(){return 500}}]),t}();t.exports=l},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(57),o=r(36),a=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sequencer=r,this.thread=n,this._nowObj={now:function(){return e.sequencer.runtime.currentMSecs}}}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"stackTimerFinished",value:function(){return!(this.stackFrame.timer.timeElapsed()<this.stackFrame.duration)}},{key:"stackTimerNeedsInit",value:function(){return!this.stackFrame.timer}},{key:"startStackTimer",value:function(t){this.nowObj?this.stackFrame.timer=new o(this.nowObj):this.stackFrame.timer=new o,this.stackFrame.timer.start(),this.stackFrame.duration=t}},{key:"yield",value:function(){this.thread.status=i.STATUS_YIELD}},{key:"yieldTick",value:function(){this.thread.status=i.STATUS_YIELD_TICK}},{key:"startBranch",value:function(t,e){this.sequencer.stepToBranch(this.thread,t,e)}},{key:"stopAll",value:function(){this.sequencer.runtime.stopAll()}},{key:"stopOtherTargetThreads",value:function(){this.sequencer.runtime.stopForTarget(this.thread.target,this.thread)}},{key:"stopThisScript",value:function(){this.thread.stopThisScript()}},{key:"startProcedure",value:function(t){this.sequencer.stepToProcedure(this.thread,t)}},{key:"getProcedureParamNamesAndIds",value:function(t){return this.thread.target.blocks.getProcedureParamNamesAndIds(t)}},{key:"getProcedureParamNamesIdsAndDefaults",value:function(t){return this.thread.target.blocks.getProcedureParamNamesIdsAndDefaults(t)}},{key:"initParams",value:function(){this.thread.initParams()}},{key:"pushParam",value:function(t,e){this.thread.pushParam(t,e)}},{key:"getParam",value:function(t){return this.thread.getParam(t)}},{key:"startHats",value:function(t,e,r){var n=this.thread,i=this.sequencer,o=this.sequencer.runtime.startHats(t,e,r);return this.thread=n,this.sequencer=i,o}},{key:"ioQuery",value:function(t,e,r){if(this.sequencer.runtime.ioDevices[t]&&this.sequencer.runtime.ioDevices[t][e]){var n=this.sequencer.runtime.ioDevices[t];return n[e].apply(n,r)}}},{key:"target",get:function(){return this.thread.target}},{key:"runtime",get:function(){return this.sequencer.runtime}},{key:"nowObj",get:function(){return this.runtime?this._nowObj:null}},{key:"stackFrame",get:function(){var t=this.thread.peekStackFrame();return null===t.executionContext&&(t.executionContext={}),t.executionContext}}]),t}();t.exports=a},function(t,e){t.exports={OUTPUT_SHAPE_HEXAGONAL:1,OUTPUT_SHAPE_ROUND:2,OUTPUT_SHAPE_SQUARE:3}},function(t,e){t.exports={SPRITE:"sprite",STAGE:"stage"}},function(t,e,r){var n=r(187);t.exports=function(t,e,r){return t&&t.id&&t.default?n(t,e,r):t}},function(t,e,r){"use strict";var n=r(188),i=r(189),o=r(111),a=r(110),s=r(109);function u(t,e){return Object.keys(e).forEach(function(r){t[r]=e[r]}),t}t.exports=function t(){var e=u({},s),r="en",c={},l=function(t){return t},h=null,f="warning",p={};function d(t,e,o){var a="string"==typeof t?t:t.default,s=v(a,"object"==typeof t&&t.id||l(a),o||r);return(s.format||(s.format=i(n(s.message),o||r,p)))(e)}d.rich=function(t,e,o){var a="string"==typeof t?t:t.default,s=v(a,"object"==typeof t&&t.id||l(a),o||r);return(s.toParts||(s.toParts=i.toParts(n(s.message,{tagsType:g}),o||r,p)))(e)};var g="<>";function m(t,e){var r=t[2];return function(t,e){var n="object"==typeof r?function(t,e){return Object.keys(t).reduce(function(r,n){return r[n]=t[n](e),r},{})}(r,e):r;return"function"==typeof t?t(n):t}}function v(t,e,r){var n=a(r,c)||"en",i=c[n]||(c[n]={}),o=i[e];if("string"==typeof o&&(o=i[e]={message:o}),!o){var s='Translation for "'+e+'" in "'+n+'" is missing';if("warning"===f)"undefined"!=typeof console&&console.warn(s);else if("ignore"!==f)throw new Error(s);var u="function"==typeof h?h(t,e,n)||t:h||t;o=i[e]={message:u}}return o}function _(t,e,n,i,s){"object"==typeof n&&"object"!=typeof i&&(s=i,i=n,n=0);var u=a(s||r,o),c=u&&o[u][t]||y;return i["="+ +e]||i[c(e-n)]||i.other}function y(){return"other"}return p[g]=m,d.setup=function(t){return(t=t||{}).locale&&(r=t.locale),"translations"in t&&(c=t.translations||{}),t.generateId&&(l=t.generateId),"missingReplacement"in t&&(h=t.missingReplacement),t.missingTranslation&&(f=t.missingTranslation),t.formats&&(t.formats.number&&u(e.number,t.formats.number),t.formats.date&&u(e.date,t.formats.date),t.formats.time&&u(e.time,t.formats.time)),t.types&&((p=t.types)[g]=m),{locale:r,translations:c,generateId:l,missingReplacement:h,missingTranslation:f,formats:e,types:p}},d.number=function(t,n,i){var o=n&&e.number[n]||e.parseNumberPattern(n)||e.number.default;return new Intl.NumberFormat(i||r,o).format(t)},d.date=function(t,n,i){var o=n&&e.date[n]||e.parseDatePattern(n)||e.date.default;return new Intl.DateTimeFormat(i||r,o).format(t)},d.time=function(t,n,i){var o=n&&e.time[n]||e.parseDatePattern(n)||e.time.default;return new Intl.DateTimeFormat(i||r,o).format(t)},d.select=function(t,e){return e[t]||e.other},d.custom=function(t,e,r,n){return t[1]in p?p[t[1]](t,e)(r,n):r},d.plural=_.bind(null,"cardinal"),d.selectordinal=_.bind(null,"ordinal"),d.namespace=t,d}()},function(t,e,r){"use strict";var n="{",i="}",o=",",a="#",s="<",u=">",c="</",l="/>",h="'",f="offset:",p=["number","date","time","ordinal","duration","spellout"],d=["plural","select","selectordinal"];function g(t,e){var r=t.pattern,n=r.length,o=[],a=t.index,s=m(t,e);for(s&&o.push(s),s&&t.tokens&&t.tokens.push(["text",r.slice(a,t.index)]);t.index<n;){if(r[t.index]===i){if(!e)throw E(t);break}if(e&&t.tagsType&&r.slice(t.index,t.index+c.length)===c)break;o.push(y(t)),a=t.index,(s=m(t,e))&&o.push(s),s&&t.tokens&&t.tokens.push(["text",r.slice(a,t.index)])}return o}function m(t,e){for(var r=t.pattern,o=r.length,u="plural"===e||"selectordinal"===e,c=!!t.tagsType,l="{style}"===e,f="";t.index<o;){var p=r[t.index];if(p===n||p===i||u&&p===a||c&&p===s||l&&v(p.charCodeAt(0)))break;if(p===h)if((p=r[++t.index])===h)f+=p,++t.index;else if(p===n||p===i||u&&p===a||c&&p===s||l)for(f+=p;++t.index<o;)if((p=r[t.index])===h&&r[t.index+1]===h)f+=h,++t.index;else{if(p===h){++t.index;break}f+=p}else f+=h;else f+=p,++t.index}return f}function v(t){return t>=9&&t<=13||32===t||133===t||160===t||6158===t||t>=8192&&t<=8205||8232===t||8233===t||8239===t||8287===t||8288===t||12288===t||65279===t}function _(t){for(var e=t.pattern,r=e.length,n=t.index;t.index<r&&v(e.charCodeAt(t.index));)++t.index;n<t.index&&t.tokens&&t.tokens.push(["space",t.pattern.slice(n,t.index)])}function y(t){var e=t.pattern;if(e[t.index]===a)return t.tokens&&t.tokens.push(["syntax",a]),++t.index,[a];var r=function(t){var e=t.tagsType;if(!e||t.pattern[t.index]!==s)return;if(t.pattern.slice(t.index,t.index+c.length)===c)throw E(t,null,"closing tag without matching opening tag");t.tokens&&t.tokens.push(["syntax",s]);++t.index;var r=b(t,!0);if(!r)throw E(t,"placeholder id");t.tokens&&t.tokens.push(["id",r]);if(_(t),t.pattern.slice(t.index,t.index+l.length)===l)return t.tokens&&t.tokens.push(["syntax",l]),t.index+=l.length,[r,e];if(t.pattern[t.index]!==u)throw E(t,u);t.tokens&&t.tokens.push(["syntax",u]);++t.index;var n=g(t,e),i=t.index;if(t.pattern.slice(t.index,t.index+c.length)!==c)throw E(t,c+r+u);t.tokens&&t.tokens.push(["syntax",c]);t.index+=c.length;var o=b(t,!0);o&&t.tokens&&t.tokens.push(["id",o]);if(r!==o)throw t.index=i,E(t,c+r+u,c+o+u);if(_(t),t.pattern[t.index]!==u)throw E(t,u);t.tokens&&t.tokens.push(["syntax",u]);return++t.index,[r,e,{children:n}]}(t);if(r)return r;if(e[t.index]!==n)throw E(t,n);t.tokens&&t.tokens.push(["syntax",n]),++t.index,_(t);var h=b(t);if(!h)throw E(t,"placeholder id");t.tokens&&t.tokens.push(["id",h]),_(t);var d=e[t.index];if(d===i)return t.tokens&&t.tokens.push(["syntax",i]),++t.index,[h];if(d!==o)throw E(t,o+" or "+i);t.tokens&&t.tokens.push(["syntax",o]),++t.index,_(t);var m,v=b(t);if(!v)throw E(t,"placeholder type");if(t.tokens&&t.tokens.push(["type",v]),_(t),(d=e[t.index])===i){if(t.tokens&&t.tokens.push(["syntax",i]),"plural"===v||"selectordinal"===v||"select"===v)throw E(t,v+" sub-messages");return++t.index,[h,v]}if(d!==o)throw E(t,o+" or "+i);if(t.tokens&&t.tokens.push(["syntax",o]),++t.index,_(t),"plural"===v||"selectordinal"===v){var y=function(t){var e=t.pattern,r=e.length,n=0;if(e.slice(t.index,t.index+f.length)===f){t.tokens&&t.tokens.push(["offset","offset"],["syntax",":"]),t.index+=f.length,_(t);for(var i=t.index;t.index<r&&T(e.charCodeAt(t.index));)++t.index;if(i===t.index)throw E(t,"offset number");t.tokens&&t.tokens.push(["number",e.slice(i,t.index)]),n=+e.slice(i,t.index)}return n}(t);_(t),m=[h,v,y,S(t,v)]}else if("select"===v)m=[h,v,S(t,v)];else if(p.indexOf(v)>=0)m=[h,v,k(t)];else{var w=t.index,I=k(t);_(t),e[t.index]===n&&(t.index=w,I=S(t,v)),m=[h,v,I]}if(_(t),e[t.index]!==i)throw E(t,i);return t.tokens&&t.tokens.push(["syntax",i]),++t.index,m}function b(t,e){for(var r=t.pattern,c=r.length,l="";t.index<c;){var f=r[t.index];if(f===n||f===i||f===o||f===a||f===h||v(f.charCodeAt(0))||e&&(f===s||f===u||"/"===f))break;l+=f,++t.index}return l}function k(t){var e=t.index,r=m(t,"{style}");if(!r)throw E(t,"placeholder style name");return t.tokens&&t.tokens.push(["style",t.pattern.slice(e,t.index)]),r}function T(t){return t>=48&&t<=57}function S(t,e){for(var r=t.pattern,n=r.length,o={};t.index<n&&r[t.index]!==i;){var a=b(t);if(!a)throw E(t,"sub-message selector");t.tokens&&t.tokens.push(["selector",a]),_(t),o[a]=w(t,e),_(t)}if(!o.other&&d.indexOf(e)>=0)throw E(t,null,null,'"other" sub-message must be specified in '+e);return o}function w(t,e){if(t.pattern[t.index]!==n)throw E(t,n+" to start sub-message");t.tokens&&t.tokens.push(["syntax",n]),++t.index;var r=g(t,e);if(t.pattern[t.index]!==i)throw E(t,i+" to end sub-message");return t.tokens&&t.tokens.push(["syntax",i]),++t.index,r}function E(t,e,r,n){var i=t.pattern,o=i.slice(0,t.index).split(/\r?\n/),a=t.index,s=o.length,u=o.slice(-1)[0].length;return r=r||(t.index>=i.length?"end of message pattern":b(t)||i[t.index]),n||(n=function(t,e){return t?"Expected "+t+" but found "+e:"Unexpected "+e+" found"}(e,r)),new I(n+=" in "+i.replace(/\r?\n/g,"\n"),e,r,a,s,u)}function I(t,e,r,n,i,o){Error.call(this,t),this.name="SyntaxError",this.message=t,this.expected=e,this.found=r,this.offset=n,this.line=i,this.column=o}e=t.exports=function(t,e){return g({pattern:String(t),index:0,tagsType:e&&e.tagsType||null,tokens:e&&e.tokens||null},"")},I.prototype=Object.create(Error.prototype),e.SyntaxError=I},function(t,e,r){"use strict";var n=r(109),i=r(110),o=r(111);function a(t,e,r,n,i){var o=t.map(function(t){return function(t,e,r,n,i){if("string"==typeof t){var o=t;return function(){return o}}var u,c=t[0],l=t[1];if(e&&"#"===t[0]){c=e[0];var h=e[2],p=(n.number||f.number)([c,"number"],r);return function(t){return p(s(c,t)-h,t)}}"plural"===l||"selectordinal"===l?(u={},Object.keys(t[3]).forEach(function(e){u[e]=a(t[3][e],t,r,n,i)}),t=[t[0],t[1],t[2],u]):t[2]&&"object"==typeof t[2]&&(u={},Object.keys(t[2]).forEach(function(e){u[e]=a(t[2][e],t,r,n,i)}),t=[t[0],t[1],u]);var d=l&&(n[l]||f[l]);if(d){var g=d(t,r);return function(t){return g(s(c,t),t)}}return i?function(t){return String(s(c,t))}:function(t){return s(c,t)}}(t,e,r,n,i)});return i?1===o.length?o[0]:function(t){for(var e="",r=0;r<o.length;++r)e+=o[r](t);return e}:function(t){return o.reduce(function(e,r){return e.concat(r(t))},[])}}function s(t,e){if(e&&t in e)return e[t];for(var r=t.split("."),n=e,i=0,o=r.length;n&&i<o;++i)n=n[r[i]];return n}function u(t,e){var r=t[2],i=n.number[r]||n.parseNumberPattern(r)||n.number.default;return new Intl.NumberFormat(e,i).format}function c(t,e){var r=t[1],i=t[2],o=n[r][i]||n.parseDatePattern(i)||n[r].default;return new Intl.DateTimeFormat(e,o).format}function l(t,e){var r,n="selectordinal"===t[1]?"ordinal":"cardinal",a=t[2],s=t[3];if(Intl.PluralRules&&Intl.PluralRules.supportedLocalesOf(e).length>0)r=new Intl.PluralRules(e,{type:n});else{var u=i(e,o),c=u&&o[u][n]||h;r={select:c}}return function(t,e){return(s["="+ +t]||s[r.select(t-a)]||s.other)(e)}}function h(){return"other"}(e=t.exports=function(t,e,r){return a(t,null,e||"en",r||{},!0)}).toParts=function(t,e,r){return a(t,null,e||"en",r||{},!1)};var f={number:u,ordinal:u,spellout:u,duration:function(t,e){var r=t[2],i=n.duration[r]||n.duration.default,o=new Intl.NumberFormat(e,i.seconds).format,a=new Intl.NumberFormat(e,i.minutes).format,s=new Intl.NumberFormat(e,i.hours).format,u=/^fi$|^fi-|^da/.test(String(e))?".":":";return function(t,e){if(t=+t,!isFinite(t))return o(t);var r=~~(t/60/60),n=~~(t/60%60),i=(r?s(Math.abs(r))+u:"")+a(Math.abs(n))+u+o(Math.abs(t%60));return t<0?s(-1).replace(s(1),i):i}},date:c,time:c,plural:l,selectordinal:l,select:function(t,e){var r=t[2];return function(t,e){return(r[t]||r.other)(e)}}};e.types=f},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._type=e,this._onOpen=null,this._onClose=null,this._onError=null,this._handleMessage=null,this._ws=null}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"open",value:function(){switch(this._type){case"BLE":this._ws=new WebSocket("wss://device-manager.scratch.mit.edu:20110/scratch/ble");break;case"BT":this._ws=new WebSocket("wss://device-manager.scratch.mit.edu:20110/scratch/bt");break;default:throw new Error("Unknown ScratchLink socket Type: ".concat(this._type))}if(!(this._onOpen&&this._onClose&&this._onError&&this._handleMessage))throw new Error("Must set open, close, message and error handlers before calling open on the socket");this._ws.onopen=this._onOpen,this._ws.onclose=this._onClose,this._ws.onerror=this._onError,this._ws.onmessage=this._onMessage.bind(this)}},{key:"close",value:function(){this._ws.close(),this._ws=null}},{key:"sendMessage",value:function(t){var e=JSON.stringify(t);this._ws.send(e)}},{key:"setOnOpen",value:function(t){this._onOpen=t}},{key:"setOnClose",value:function(t){this._onClose=t}},{key:"setOnError",value:function(t){this._onError=t}},{key:"setHandleMessage",value:function(t){this._handleMessage=t}},{key:"isOpen",value:function(){return this._ws&&this._ws.readyState===this._ws.OPEN}},{key:"_onMessage",value:function(t){var e=JSON.parse(t.data);this._handleMessage(e)}}]),t}();t.exports=n},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(36),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._projectTimer=new i({now:function(){return e.currentMSecs}}),this._projectTimer.start(),this._pausedTime=null,this._paused=!1,this.runtime=e}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"projectTimer",value:function(){return this._paused?this._pausedTime/1e3:this._projectTimer.timeElapsed()/1e3}},{key:"pause",value:function(){this._paused=!0,this._pausedTime=this._projectTimer.timeElapsed()}},{key:"resume",value:function(){this._paused=!1;var t=this._projectTimer.timeElapsed()-this._pausedTime;this._projectTimer.startTime+=t}},{key:"resetProjectTimer",value:function(){this._projectTimer.start()}}]),t}();t.exports=o},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(34),o=r(3),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.provider=null,this.runtime=e,this.stage=null}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"setProvider",value:function(t){this.provider=t}},{key:"setStage",value:function(t){this.stage=t}},{key:"postData",value:function(t){t.varUpdate&&this.updateCloudVariable(t.varUpdate)}},{key:"requestCreateVariable",value:function(t){this.runtime.canAddCloudVariable()&&this.provider&&this.provider.createVariable(t.name,t.value)}},{key:"requestUpdateVariable",value:function(t,e){this.provider&&this.provider.updateVariable(t,e)}},{key:"requestRenameVariable",value:function(t,e){this.provider&&this.provider.renameVariable(t,e)}},{key:"requestDeleteVariable",value:function(t){this.provider&&this.provider.deleteVariable(t)}},{key:"updateCloudVariable",value:function(t){var e=t.name,r=this.stage.lookupVariableByNameAndType(e,i.SCALAR_TYPE);r&&r.isCloud?r.value=t.value:o.warn("Received an update for a cloud variable that does not exist: ".concat(e))}},{key:"clear",value:function(){this.provider&&(this.provider.requestCloseConnection(),this.provider=null,this.stage=null)}}]),t}();t.exports=a},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(2),o={SPACE:"space",LEFT:"left arrow",UP:"up arrow",RIGHT:"right arrow",DOWN:"down arrow",ENTER:"enter"},a=Object.keys(o).map(function(t){return o[t]}),s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._keysPressed=[],this.runtime=e}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"_keyStringToScratchKey",value:function(t){switch(t=i.toString(t)){case" ":return o.SPACE;case"ArrowLeft":case"Left":return o.LEFT;case"ArrowUp":case"Up":return o.UP;case"Right":case"ArrowRight":return o.RIGHT;case"Down":case"ArrowDown":return o.DOWN;case"Enter":return o.ENTER}return t.length>1?"":t.toUpperCase()}},{key:"_keyArgToScratchKey",value:function(t){if("number"==typeof t){if(t>=48&&t<=90)return String.fromCharCode(t);switch(t){case 32:return o.SPACE;case 37:return o.LEFT;case 38:return o.UP;case 39:return o.RIGHT;case 40:return o.DOWN}}return t=i.toString(t),a.includes(t)?t:(t.length>1&&(t=t[0])," "===t?o.SPACE:t.toUpperCase())}},{key:"postData",value:function(t){if(t.key){var e=this._keyStringToScratchKey(t.key);if(""!==e){var r=this._keysPressed.indexOf(e);t.isDown?(this.runtime.emit("KEY_PRESSED",e),r<0&&this._keysPressed.push(e)):r>-1&&this._keysPressed.splice(r,1)}}}},{key:"getKeyIsDown",value:function(t){if("any"===t)return this._keysPressed.length>0;var e=this._keyArgToScratchKey(t);return this._keysPressed.indexOf(e)>-1}}]),t}();t.exports=s},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(5),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._x=0,this._y=0,this._isDown=!1,this.runtime=e}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"_activateClickHats",value:function(t){this.runtime.startHats("event_whenthisspriteclicked",null,t),this.runtime.startHats("event_whenstageclicked",null,t)}},{key:"_pickTarget",value:function(t,e){if(this.runtime.renderer)for(var r=this.runtime.renderer.pick(t,e),n=0;n<this.runtime.targets.length;n++){var i=this.runtime.targets[n];if(i.hasOwnProperty("drawableID")&&i.drawableID===r)return i}return this.runtime.getTargetForStage()}},{key:"postData",value:function(t){if(t.x&&(this._clientX=t.x,this._scratchX=Math.round(i.clamp(480*(t.x/t.canvasWidth-.5),-240,240))),t.y&&(this._clientY=t.y,this._scratchY=Math.round(i.clamp(-360*(t.y/t.canvasHeight-.5),-180,180))),void 0!==t.isDown){var e=this._isDown;if(this._isDown=t.isDown,e===this._isDown)return;if(t.wasDragged)return;if(!(t.x>0&&t.x<t.canvasWidth&&t.y>0&&t.y<t.canvasHeight))return;var r=this._pickTarget(t.x,t.y),n=!e&&this._isDown,o=e&&!this._isDown;r.draggable&&o?this._activateClickHats(r):!r.draggable&&n&&this._activateClickHats(r)}}},{key:"getClientX",value:function(){return this._clientX}},{key:"getClientY",value:function(){return this._clientY}},{key:"getScratchX",value:function(){return this._scratchX}},{key:"getScratchY",value:function(){return this._scratchY}},{key:"getIsDown",value:function(){return this._isDown}}]),t}();t.exports=o},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"postData",value:function(t){var e={};if(t.deltaY<0)e.KEY_OPTION="up arrow";else{if(!(t.deltaY>0))return;e.KEY_OPTION="down arrow"}this.runtime.startHats("event_whenkeypressed",e)}}]),t}();t.exports=n},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._username=""}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"postData",value:function(t){this._username=t.username}},{key:"getUsername",value:function(){return this._username}}]),t}();t.exports=n},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(2),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e,this._counter=0}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"getPrimitives",value:function(){return{control_repeat:this.repeat,control_repeat_until:this.repeatUntil,control_while:this.repeatWhile,control_for_each:this.forEach,control_forever:this.forever,control_wait:this.wait,control_wait_until:this.waitUntil,control_if:this.if,control_if_else:this.ifElse,control_stop:this.stop,control_create_clone_of:this.createClone,control_delete_this_clone:this.deleteClone,control_get_counter:this.getCounter,control_incr_counter:this.incrCounter,control_clear_counter:this.clearCounter,control_all_at_once:this.allAtOnce}}},{key:"getHats",value:function(){return{control_start_as_clone:{restartExistingThreads:!1}}}},{key:"repeat",value:function(t,e){var r=Math.round(i.toNumber(t.TIMES));void 0===e.stackFrame.loopCounter&&(e.stackFrame.loopCounter=r),e.stackFrame.loopCounter--,e.stackFrame.loopCounter>=0&&e.startBranch(1,!0)}},{key:"repeatUntil",value:function(t,e){i.toBoolean(t.CONDITION)||e.startBranch(1,!0)}},{key:"repeatWhile",value:function(t,e){i.toBoolean(t.CONDITION)&&e.startBranch(1,!0)}},{key:"forEach",value:function(t,e){var r=e.target.lookupOrCreateVariable(t.VARIABLE.id,t.VARIABLE.name);void 0===e.stackFrame.index&&(e.stackFrame.index=0),e.stackFrame.index<Number(t.VALUE)&&(e.stackFrame.index++,r.value=e.stackFrame.index,e.startBranch(1,!0))}},{key:"waitUntil",value:function(t,e){i.toBoolean(t.CONDITION)||e.yield()}},{key:"forever",value:function(t,e){e.startBranch(1,!0)}},{key:"wait",value:function(t,e){if(e.stackTimerNeedsInit()){var r=Math.max(0,1e3*i.toNumber(t.DURATION));e.startStackTimer(r),this.runtime.requestRedraw(),e.yield()}else e.stackTimerFinished()||e.yield()}},{key:"if",value:function(t,e){i.toBoolean(t.CONDITION)&&e.startBranch(1,!1)}},{key:"ifElse",value:function(t,e){i.toBoolean(t.CONDITION)?e.startBranch(1,!1):e.startBranch(2,!1)}},{key:"stop",value:function(t,e){var r=t.STOP_OPTION;"all"===r?e.stopAll():"other scripts in sprite"===r||"other scripts in stage"===r?e.stopOtherTargetThreads():"this script"===r&&e.stopThisScript()}},{key:"createClone",value:function(t,e){var r;if(t.CLONE_OPTION=i.toString(t.CLONE_OPTION),r="_myself_"===t.CLONE_OPTION?e.target:this.runtime.getSpriteTargetByName(t.CLONE_OPTION)){var n=r.makeClone();n&&(this.runtime.addTarget(n),n.goBehindOther(r))}}},{key:"deleteClone",value:function(t,e){e.target.isOriginal||(this.runtime.disposeTarget(e.target),this.runtime.stopForTarget(e.target))}},{key:"getCounter",value:function(){return this._counter}},{key:"clearCounter",value:function(){this._counter=0}},{key:"incrCounter",value:function(){this._counter++}},{key:"allAtOnce",value:function(t,e){e.startBranch(1,!1)}}]),t}();t.exports=o},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(2),o=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e,this.runtime.on("KEY_PRESSED",function(t){r.runtime.startHats("event_whenkeypressed",{KEY_OPTION:t}),r.runtime.startHats("event_whenkeypressed",{KEY_OPTION:"any"})})}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"getPrimitives",value:function(){return{event_whentouchingobject:this.touchingObject,event_broadcast:this.broadcast,event_broadcastandwait:this.broadcastAndWait,event_whengreaterthan:this.hatGreaterThanPredicate}}},{key:"getHats",value:function(){return{event_whenflagclicked:{restartExistingThreads:!0},event_whenkeypressed:{restartExistingThreads:!1},event_whenthisspriteclicked:{restartExistingThreads:!0},event_whentouchingobject:{restartExistingThreads:!1,edgeActivated:!0},event_whenstageclicked:{restartExistingThreads:!0},event_whenbackdropswitchesto:{restartExistingThreads:!0},event_whengreaterthan:{restartExistingThreads:!1,edgeActivated:!0},event_whenbroadcastreceived:{restartExistingThreads:!0}}}},{key:"touchingObject",value:function(t,e){return e.target.isTouchingObject(t.TOUCHINGOBJECTMENU)}},{key:"hatGreaterThanPredicate",value:function(t,e){var r=i.toString(t.WHENGREATERTHANMENU).toLowerCase(),n=i.toNumber(t.VALUE);switch(r){case"timer":return e.ioQuery("clock","projectTimer")>n;case"loudness":return this.runtime.audioEngine&&this.runtime.audioEngine.getLoudness()>n}return!1}},{key:"broadcast",value:function(t,e){var r=e.runtime.getTargetForStage().lookupBroadcastMsg(t.BROADCAST_OPTION.id,t.BROADCAST_OPTION.name);if(r){var n=r.name;e.startHats("event_whenbroadcastreceived",{BROADCAST_OPTION:n})}}},{key:"broadcastAndWait",value:function(t,e){var r=e.runtime.getTargetForStage().lookupBroadcastMsg(t.BROADCAST_OPTION.id,t.BROADCAST_OPTION.name);if(r){var n=r.name;if(!e.stackFrame.startedThreads&&(e.stackFrame.startedThreads=e.startHats("event_whenbroadcastreceived",{BROADCAST_OPTION:n}),0===e.stackFrame.startedThreads.length))return;var i=this;e.stackFrame.startedThreads.some(function(t){return-1!==i.runtime.threads.indexOf(t)})&&(e.stackFrame.startedThreads.every(function(t){return i.runtime.isWaitingThread(t)})?e.yieldTick():e.yield())}}}]),t}();t.exports=o},function(t,e,r){function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=r(2),a=r(4),s=r(58),u=r(9),c=r(35),l=r(48),h=r(5),f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e,this._onTargetChanged=this._onTargetChanged.bind(this),this._onResetBubbles=this._onResetBubbles.bind(this),this._onTargetWillExit=this._onTargetWillExit.bind(this),this._updateBubble=this._updateBubble.bind(this),this.runtime.on("PROJECT_STOP_ALL",this._onResetBubbles),this.runtime.on("targetWasRemoved",this._onTargetWillExit),this.runtime.on("SAY",this._updateBubble)}return function(t,e,r){e&&i(t.prototype,e),r&&i(t,r)}(t,[{key:"_getBubbleState",value:function(e){var r=e.getCustomState(t.STATE_KEY);return r||(r=a.simple(t.DEFAULT_BUBBLE_STATE),e.setCustomState(t.STATE_KEY,r)),r}},{key:"_onTargetChanged",value:function(t){this._getBubbleState(t).drawableId&&this._positionBubble(t)}},{key:"_onTargetWillExit",value:function(t){var e=this._getBubbleState(t);e.drawableId&&e.skinId&&(this.runtime.renderer.destroyDrawable(e.drawableId,c.SPRITE_LAYER),this.runtime.renderer.destroySkin(e.skinId),e.drawableId=null,e.skinId=null,this.runtime.requestRedraw()),t.removeListener(s.EVENT_TARGET_VISUAL_CHANGE,this._onTargetChanged)}},{key:"_onResetBubbles",value:function(){for(var t=0;t<this.runtime.targets.length;t++){this._getBubbleState(this.runtime.targets[t]).text="",this._onTargetWillExit(this.runtime.targets[t])}clearTimeout(this._bubbleTimeout)}},{key:"_positionBubble",value:function(t){if(t.visible){var e,r=this._getBubbleState(t),i=n(this.runtime.renderer.getCurrentSkinSize(r.drawableId),2),o=i[0],a=i[1];try{e=t.getBoundsForBubble()}catch(r){e={left:t.x,right:t.x,top:t.y,bottom:t.y}}var s=this.runtime.renderer.getNativeSize(),u={left:-s[0]/2,right:s[0]/2,top:s[1]/2,bottom:-s[1]/2};r.onSpriteRight&&o+e.right>u.right&&e.left-o>u.left?(r.onSpriteRight=!1,this._renderBubble(t)):!r.onSpriteRight&&e.left-o<u.left&&o+e.right<u.right?(r.onSpriteRight=!0,this._renderBubble(t)):(this.runtime.renderer.updateDrawableProperties(r.drawableId,{position:[r.onSpriteRight?Math.max(u.left,Math.min(u.right-o,e.right)):Math.min(u.right-o,Math.max(u.left,e.left-o)),Math.min(u.top,e.bottom+a)]}),this.runtime.requestRedraw())}}},{key:"_renderBubble",value:function(t){if(this.runtime.renderer){var e=this._getBubbleState(t),r=e.type,n=e.text,i=e.onSpriteRight;t.visible&&""!==n?(e.skinId?this.runtime.renderer.updateTextSkin(e.skinId,r,n,i,[0,0]):(t.addListener(s.EVENT_TARGET_VISUAL_CHANGE,this._onTargetChanged),e.drawableId=this.runtime.renderer.createDrawable(c.SPRITE_LAYER),e.skinId=this.runtime.renderer.createTextSkin(r,n,e.onSpriteRight,[0,0]),this.runtime.renderer.updateDrawableProperties(e.drawableId,{skinId:e.skinId})),this._positionBubble(t)):this._onTargetWillExit(t)}}},{key:"_updateBubble",value:function(t,e,r){var n=this._getBubbleState(t);n.type=e,n.text=r,n.usageId=u(),this._renderBubble(t)}},{key:"getPrimitives",value:function(){return{looks_say:this.say,looks_sayforsecs:this.sayforsecs,looks_think:this.think,looks_thinkforsecs:this.thinkforsecs,looks_show:this.show,looks_hide:this.hide,looks_hideallsprites:function(){},looks_switchcostumeto:this.switchCostume,looks_switchbackdropto:this.switchBackdrop,looks_switchbackdroptoandwait:this.switchBackdropAndWait,looks_nextcostume:this.nextCostume,looks_nextbackdrop:this.nextBackdrop,looks_changeeffectby:this.changeEffect,looks_seteffectto:this.setEffect,looks_cleargraphiceffects:this.clearEffects,looks_changesizeby:this.changeSize,looks_setsizeto:this.setSize,looks_changestretchby:function(){},looks_setstretchto:function(){},looks_gotofrontback:this.goToFrontBack,looks_goforwardbackwardlayers:this.goForwardBackwardLayers,looks_size:this.getSize,looks_costumenumbername:this.getCostumeNumberName,looks_backdropnumbername:this.getBackdropNumberName}}},{key:"getMonitored",value:function(){return{looks_size:{isSpriteSpecific:!0,getId:function(t){return"".concat(t,"_size")}},looks_costumenumbername:{isSpriteSpecific:!0,getId:function(t,e){return l("".concat(t,"_costumenumbername"),e)}},looks_backdropnumbername:{getId:function(t,e){return l("backdropnumbername",e)}}}}},{key:"say",value:function(e,r){var n=e.MESSAGE;"number"==typeof n&&(n=parseFloat(n.toFixed(2))),n=String(n).substr(0,t.SAY_BUBBLE_LIMIT),this.runtime.emit("SAY",r.target,"say",n)}},{key:"sayforsecs",value:function(t,e){var r=this;this.say(t,e);var n=e.target,i=this._getBubbleState(n).usageId;return new Promise(function(e){r._bubbleTimeout=setTimeout(function(){r._bubbleTimeout=null,r._getBubbleState(n).usageId===i&&r._updateBubble(n,"say",""),e()},1e3*t.SECS)})}},{key:"think",value:function(e,r){this._updateBubble(r.target,"think",String(e.MESSAGE).substr(0,t.SAY_BUBBLE_LIMIT))}},{key:"thinkforsecs",value:function(t,e){var r=this;this.think(t,e);var n=e.target,i=this._getBubbleState(n).usageId;return new Promise(function(e){r._bubbleTimeout=setTimeout(function(){r._bubbleTimeout=null,r._getBubbleState(n).usageId===i&&r._updateBubble(n,"think",""),e()},1e3*t.SECS)})}},{key:"show",value:function(t,e){e.target.setVisible(!0),this._renderBubble(e.target)}},{key:"hide",value:function(t,e){e.target.setVisible(!1),this._renderBubble(e.target)}},{key:"_setCostume",value:function(t,e,r){if("number"==typeof e)t.setCostume(r?e:e-1);else{var n=t.getCostumeIndexByName(e.toString());-1!==n?t.setCostume(n):"next costume"===e?t.setCostume(t.currentCostume+1):"previous costume"===e?t.setCostume(t.currentCostume-1):isNaN(e)||o.isWhiteSpace(e)||t.setCostume(r?Number(e):Number(e)-1)}return[]}},{key:"_setBackdrop",value:function(t,e,r){if("number"==typeof e)t.setCostume(r?e:e-1);else{var n=t.getCostumeIndexByName(e.toString());if(-1!==n)t.setCostume(n);else if("next backdrop"===e)t.setCostume(t.currentCostume+1);else if("previous backdrop"===e)t.setCostume(t.currentCostume-1);else if("random backdrop"===e){var i=t.getCostumes().length;if(i>1){var a=Math.floor(Math.random()*(i-1));a===t.currentCostume&&(a+=1),t.setCostume(a)}}else isNaN(e)||o.isWhiteSpace(e)||t.setCostume(r?Number(e):Number(e)-1)}var s=t.getCostumes()[t.currentCostume].name;return this.runtime.startHats("event_whenbackdropswitchesto",{BACKDROP:s})}},{key:"switchCostume",value:function(t,e){this._setCostume(e.target,t.COSTUME)}},{key:"nextCostume",value:function(t,e){this._setCostume(e.target,e.target.currentCostume+1,!0)}},{key:"switchBackdrop",value:function(t){this._setBackdrop(this.runtime.getTargetForStage(),t.BACKDROP)}},{key:"switchBackdropAndWait",value:function(t,e){if(e.stackFrame.startedThreads||(e.stackFrame.startedThreads=this._setBackdrop(this.runtime.getTargetForStage(),t.BACKDROP),0!==e.stackFrame.startedThreads.length)){var r=this;e.stackFrame.startedThreads.some(function(t){return-1!==r.runtime.threads.indexOf(t)})&&(e.stackFrame.startedThreads.every(function(t){return r.runtime.isWaitingThread(t)})?e.yieldTick():e.yield())}}},{key:"nextBackdrop",value:function(){var t=this.runtime.getTargetForStage();this._setBackdrop(t,t.currentCostume+1,!0)}},{key:"clampEffect",value:function(e,r){var n=r;switch(e){case"ghost":n=h.clamp(r,t.EFFECT_GHOST_LIMIT.min,t.EFFECT_GHOST_LIMIT.max);break;case"brightness":n=h.clamp(r,t.EFFECT_BRIGHTNESS_LIMIT.min,t.EFFECT_BRIGHTNESS_LIMIT.max)}return n}},{key:"changeEffect",value:function(t,e){var r=o.toString(t.EFFECT).toLowerCase(),n=o.toNumber(t.CHANGE);if(e.target.effects.hasOwnProperty(r)){var i=n+e.target.effects[r];i=this.clampEffect(r,i),e.target.setEffect(r,i)}}},{key:"setEffect",value:function(t,e){var r=o.toString(t.EFFECT).toLowerCase(),n=o.toNumber(t.VALUE);n=this.clampEffect(r,n),e.target.setEffect(r,n)}},{key:"clearEffects",value:function(t,e){e.target.clearEffects()}},{key:"changeSize",value:function(t,e){var r=o.toNumber(t.CHANGE);e.target.setSize(e.target.size+r)}},{key:"setSize",value:function(t,e){var r=o.toNumber(t.SIZE);e.target.setSize(r)}},{key:"goToFrontBack",value:function(t,e){e.target.isStage||("front"===t.FRONT_BACK?e.target.goToFront():e.target.goToBack())}},{key:"goForwardBackwardLayers",value:function(t,e){e.target.isStage||("forward"===t.FORWARD_BACKWARD?e.target.goForwardLayers(o.toNumber(t.NUM)):e.target.goBackwardLayers(o.toNumber(t.NUM)))}},{key:"getSize",value:function(t,e){return Math.round(e.target.size)}},{key:"getBackdropNumberName",value:function(t){var e=this.runtime.getTargetForStage();return"number"===t.NUMBER_NAME?e.currentCostume+1:e.getCostumes()[e.currentCostume].name}},{key:"getCostumeNumberName",value:function(t,e){return"number"===t.NUMBER_NAME?e.target.currentCostume+1:e.target.getCostumes()[e.target.currentCostume].name}}],[{key:"DEFAULT_BUBBLE_STATE",get:function(){return{drawableId:null,onSpriteRight:!0,skinId:null,text:"",type:"say",usageId:null}}},{key:"STATE_KEY",get:function(){return"Scratch.looks"}},{key:"SAY_BUBBLE_LIMIT",get:function(){return 330}},{key:"EFFECT_GHOST_LIMIT",get:function(){return{min:0,max:100}}},{key:"EFFECT_BRIGHTNESS_LIMIT",get:function(){return{min:-100,max:100}}}]),t}();t.exports=f},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(2),o=r(5),a=r(36),s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"getPrimitives",value:function(){return{motion_movesteps:this.moveSteps,motion_gotoxy:this.goToXY,motion_goto:this.goTo,motion_turnright:this.turnRight,motion_turnleft:this.turnLeft,motion_pointindirection:this.pointInDirection,motion_pointtowards:this.pointTowards,motion_glidesecstoxy:this.glide,motion_glideto:this.glideTo,motion_ifonedgebounce:this.ifOnEdgeBounce,motion_setrotationstyle:this.setRotationStyle,motion_changexby:this.changeX,motion_setx:this.setX,motion_changeyby:this.changeY,motion_sety:this.setY,motion_xposition:this.getX,motion_yposition:this.getY,motion_direction:this.getDirection,motion_scroll_right:function(){},motion_scroll_up:function(){},motion_align_scene:function(){},motion_xscroll:function(){},motion_yscroll:function(){}}}},{key:"getMonitored",value:function(){return{motion_xposition:{isSpriteSpecific:!0,getId:function(t){return"".concat(t,"_xposition")}},motion_yposition:{isSpriteSpecific:!0,getId:function(t){return"".concat(t,"_yposition")}},motion_direction:{isSpriteSpecific:!0,getId:function(t){return"".concat(t,"_direction")}}}}},{key:"moveSteps",value:function(t,e){var r=i.toNumber(t.STEPS),n=o.degToRad(90-e.target.direction),a=r*Math.cos(n),s=r*Math.sin(n);e.target.setXY(e.target.x+a,e.target.y+s)}},{key:"goToXY",value:function(t,e){var r=i.toNumber(t.X),n=i.toNumber(t.Y);e.target.setXY(r,n)}},{key:"getTargetXY",value:function(t,e){var r=0,n=0;if("_mouse_"===t)r=e.ioQuery("mouse","getScratchX"),n=e.ioQuery("mouse","getScratchY");else if("_random_"===t){var o=this.runtime.constructor.STAGE_WIDTH,a=this.runtime.constructor.STAGE_HEIGHT;r=Math.round(o*(Math.random()-.5)),n=Math.round(a*(Math.random()-.5))}else{t=i.toString(t);var s=this.runtime.getSpriteTargetByName(t);if(!s)return;r=s.x,n=s.y}return[r,n]}},{key:"goTo",value:function(t,e){var r=this.getTargetXY(t.TO,e);r&&e.target.setXY(r[0],r[1])}},{key:"turnRight",value:function(t,e){var r=i.toNumber(t.DEGREES);e.target.setDirection(e.target.direction+r)}},{key:"turnLeft",value:function(t,e){var r=i.toNumber(t.DEGREES);e.target.setDirection(e.target.direction-r)}},{key:"pointInDirection",value:function(t,e){var r=i.toNumber(t.DIRECTION);e.target.setDirection(r)}},{key:"pointTowards",value:function(t,e){var r=0,n=0;if("_mouse_"===t.TOWARDS)r=e.ioQuery("mouse","getScratchX"),n=e.ioQuery("mouse","getScratchY");else{if("_random_"===t.TOWARDS)return void e.target.setDirection(Math.round(360*Math.random())-180);t.TOWARDS=i.toString(t.TOWARDS);var a=this.runtime.getSpriteTargetByName(t.TOWARDS);if(!a)return;r=a.x,n=a.y}var s=r-e.target.x,u=n-e.target.y,c=90-o.radToDeg(Math.atan2(u,s));e.target.setDirection(c)}},{key:"glide",value:function(t,e){if(e.stackFrame.timer){var r=e.stackFrame.timer.timeElapsed();if(r<1e3*e.stackFrame.duration){var n=r/(1e3*e.stackFrame.duration),o=n*(e.stackFrame.endX-e.stackFrame.startX),s=n*(e.stackFrame.endY-e.stackFrame.startY);e.target.setXY(e.stackFrame.startX+o,e.stackFrame.startY+s),e.yield()}else e.target.setXY(e.stackFrame.endX,e.stackFrame.endY)}else{if(e.stackFrame.timer=new a,e.stackFrame.timer.start(),e.stackFrame.duration=i.toNumber(t.SECS),e.stackFrame.startX=e.target.x,e.stackFrame.startY=e.target.y,e.stackFrame.endX=i.toNumber(t.X),e.stackFrame.endY=i.toNumber(t.Y),e.stackFrame.duration<=0)return void e.target.setXY(e.stackFrame.endX,e.stackFrame.endY);e.yield()}}},{key:"glideTo",value:function(t,e){var r=this.getTargetXY(t.TO,e);r&&this.glide({SECS:t.SECS,X:r[0],Y:r[1]},e)}},{key:"ifOnEdgeBounce",value:function(t,e){var r=e.target.getBounds();if(r){var n=this.runtime.constructor.STAGE_WIDTH,i=this.runtime.constructor.STAGE_HEIGHT,a=Math.max(0,n/2+r.left),s=Math.max(0,i/2-r.top),u=Math.max(0,n/2-r.right),c=Math.max(0,i/2+r.bottom),l="",h=1/0;if(a<h&&(h=a,l="left"),s<h&&(h=s,l="top"),u<h&&(h=u,l="right"),c<h&&(h=c,l="bottom"),!(h>0)){var f=o.degToRad(90-e.target.direction),p=Math.cos(f),d=-Math.sin(f);"left"===l?p=Math.max(.2,Math.abs(p)):"top"===l?d=Math.max(.2,Math.abs(d)):"right"===l?p=0-Math.max(.2,Math.abs(p)):"bottom"===l&&(d=0-Math.max(.2,Math.abs(d)));var g=o.radToDeg(Math.atan2(d,p))+90;e.target.setDirection(g);var m=e.target.keepInFence(e.target.x,e.target.y);e.target.setXY(m[0],m[1])}}}},{key:"setRotationStyle",value:function(t,e){e.target.setRotationStyle(t.STYLE)}},{key:"changeX",value:function(t,e){var r=i.toNumber(t.DX);e.target.setXY(e.target.x+r,e.target.y)}},{key:"setX",value:function(t,e){var r=i.toNumber(t.X);e.target.setXY(r,e.target.y)}},{key:"changeY",value:function(t,e){var r=i.toNumber(t.DY);e.target.setXY(e.target.x,e.target.y+r)}},{key:"setY",value:function(t,e){var r=i.toNumber(t.Y);e.target.setXY(e.target.x,r)}},{key:"getX",value:function(t,e){return this.limitPrecision(e.target.x)}},{key:"getY",value:function(t,e){return this.limitPrecision(e.target.y)}},{key:"getDirection",value:function(t,e){return e.target.direction}},{key:"limitPrecision",value:function(t){var e=Math.round(t),r=t-e;return Math.abs(r)<1e-9?e:t}}]),t}();t.exports=s},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(2),o=r(5),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"getPrimitives",value:function(){return{operator_add:this.add,operator_subtract:this.subtract,operator_multiply:this.multiply,operator_divide:this.divide,operator_lt:this.lt,operator_equals:this.equals,operator_gt:this.gt,operator_and:this.and,operator_or:this.or,operator_not:this.not,operator_random:this.random,operator_join:this.join,operator_letter_of:this.letterOf,operator_length:this.length,operator_contains:this.contains,operator_mod:this.mod,operator_round:this.round,operator_mathop:this.mathop}}},{key:"add",value:function(t){return i.toNumber(t.NUM1)+i.toNumber(t.NUM2)}},{key:"subtract",value:function(t){return i.toNumber(t.NUM1)-i.toNumber(t.NUM2)}},{key:"multiply",value:function(t){return i.toNumber(t.NUM1)*i.toNumber(t.NUM2)}},{key:"divide",value:function(t){return i.toNumber(t.NUM1)/i.toNumber(t.NUM2)}},{key:"lt",value:function(t){return i.compare(t.OPERAND1,t.OPERAND2)<0}},{key:"equals",value:function(t){return 0===i.compare(t.OPERAND1,t.OPERAND2)}},{key:"gt",value:function(t){return i.compare(t.OPERAND1,t.OPERAND2)>0}},{key:"and",value:function(t){return i.toBoolean(t.OPERAND1)&&i.toBoolean(t.OPERAND2)}},{key:"or",value:function(t){return i.toBoolean(t.OPERAND1)||i.toBoolean(t.OPERAND2)}},{key:"not",value:function(t){return!i.toBoolean(t.OPERAND)}},{key:"random",value:function(t){var e=i.toNumber(t.FROM),r=i.toNumber(t.TO),n=e<=r?e:r,o=e<=r?r:e;return n===o?n:i.isInt(t.FROM)&&i.isInt(t.TO)?n+Math.floor(Math.random()*(o+1-n)):Math.random()*(o-n)+n}},{key:"join",value:function(t){return i.toString(t.STRING1)+i.toString(t.STRING2)}},{key:"letterOf",value:function(t){var e=i.toNumber(t.LETTER)-1,r=i.toString(t.STRING);return e<0||e>=r.length?"":r.charAt(e)}},{key:"length",value:function(t){return i.toString(t.STRING).length}},{key:"contains",value:function(t){var e=function(t){return i.toString(t).toLowerCase()};return e(t.STRING1).includes(e(t.STRING2))}},{key:"mod",value:function(t){var e=i.toNumber(t.NUM1),r=i.toNumber(t.NUM2),n=e%r;return n/r<0&&(n+=r),n}},{key:"round",value:function(t){return Math.round(i.toNumber(t.NUM))}},{key:"mathop",value:function(t){var e=i.toString(t.OPERATOR).toLowerCase(),r=i.toNumber(t.NUM);switch(e){case"abs":return Math.abs(r);case"floor":return Math.floor(r);case"ceiling":return Math.ceil(r);case"sqrt":return Math.sqrt(r);case"sin":return parseFloat(Math.sin(Math.PI*r/180).toFixed(10));case"cos":return parseFloat(Math.cos(Math.PI*r/180).toFixed(10));case"tan":return o.tan(r);case"asin":return 180*Math.asin(r)/Math.PI;case"acos":return 180*Math.acos(r)/Math.PI;case"atan":return 180*Math.atan(r)/Math.PI;case"ln":return Math.log(r);case"log":return Math.log(r)/Math.LN10;case"e ^":return Math.exp(r);case"10 ^":return Math.pow(10,r)}return 0}}]),t}();t.exports=a},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(5),o=r(2),a=r(4),s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e,this.waitingSounds={},this.stopAllSounds=this.stopAllSounds.bind(this),this._stopWaitingSoundsForTarget=this._stopWaitingSoundsForTarget.bind(this),this._clearEffectsForAllTargets=this._clearEffectsForAllTargets.bind(this),this.runtime&&(this.runtime.on("PROJECT_STOP_ALL",this.stopAllSounds),this.runtime.on("PROJECT_STOP_ALL",this._clearEffectsForAllTargets),this.runtime.on("STOP_FOR_TARGET",this._stopWaitingSoundsForTarget),this.runtime.on("PROJECT_START",this._clearEffectsForAllTargets)),this._onTargetCreated=this._onTargetCreated.bind(this),this.runtime&&e.on("targetWasCreated",this._onTargetCreated)}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"_getSoundState",value:function(e){var r=e.getCustomState(t.STATE_KEY);return r||(r=a.simple(t.DEFAULT_SOUND_STATE),e.setCustomState(t.STATE_KEY,r),e.soundEffects=r.effects),r}},{key:"_onTargetCreated",value:function(e,r){if(r){var n=r.getCustomState(t.STATE_KEY);n&&e&&(e.setCustomState(t.STATE_KEY,a.simple(n)),this._syncEffectsForTarget(e))}}},{key:"getPrimitives",value:function(){return{sound_play:this.playSound,sound_playuntildone:this.playSoundAndWait,sound_stopallsounds:this.stopAllSounds,sound_seteffectto:this.setEffect,sound_changeeffectby:this.changeEffect,sound_cleareffects:this.clearEffects,sound_sounds_menu:this.soundsMenu,sound_beats_menu:this.beatsMenu,sound_effects_menu:this.effectsMenu,sound_setvolumeto:this.setVolume,sound_changevolumeby:this.changeVolume,sound_volume:this.getVolume}}},{key:"getMonitored",value:function(){return{sound_volume:{isSpriteSpecific:!0,getId:function(t){return"".concat(t,"_volume")}}}}},{key:"playSound",value:function(t,e){this._playSound(t,e)}},{key:"playSoundAndWait",value:function(t,e){return this._playSound(t,e,!0)}},{key:"_playSound",value:function(t,e,r){var n=this._getSoundIndex(t.SOUND_MENU,e);if(n>=0){var i=e.target,o=i.sprite,a=o.sounds[n].soundId;if(o.soundBank)return!0===r?this._addWaitingSound(i.id,a):this._removeWaitingSound(i.id,a),o.soundBank.playSound(i,a)}}},{key:"_addWaitingSound",value:function(t,e){this.waitingSounds[t]||(this.waitingSounds[t]=new Set),this.waitingSounds[t].add(e)}},{key:"_removeWaitingSound",value:function(t,e){this.waitingSounds[t]&&this.waitingSounds[t].delete(e)}},{key:"_getSoundIndex",value:function(t,e){var r=e.target.sprite.sounds.length;if(0===r)return-1;var n=this.getSoundIndexByName(t,e);if(-1!==n)return n;var o=parseInt(t,10);return isNaN(o)?-1:i.wrapClamp(o-1,0,r-1)}},{key:"getSoundIndexByName",value:function(t,e){for(var r=e.target.sprite.sounds,n=0;n<r.length;n++)if(r[n].name===t)return n;return-1}},{key:"stopAllSounds",value:function(){if(null!==this.runtime.targets)for(var t=this.runtime.targets,e=0;e<t.length;e++)this._stopAllSoundsForTarget(t[e])}},{key:"_stopAllSoundsForTarget",value:function(t){t.sprite.soundBank&&(t.sprite.soundBank.stopAllSounds(t),this.waitingSounds[t.id]&&this.waitingSounds[t.id].clear())}},{key:"_stopWaitingSoundsForTarget",value:function(t){if(t.sprite.soundBank&&this.waitingSounds[t.id]){var e=!0,r=!1,n=void 0;try{for(var i,o=this.waitingSounds[t.id].values()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t.sprite.soundBank.stop(t,a)}}catch(t){r=!0,n=t}finally{try{e||null==o.return||o.return()}finally{if(r)throw n}}this.waitingSounds[t.id].clear()}}},{key:"setEffect",value:function(t,e){return this._updateEffect(t,e,!1)}},{key:"changeEffect",value:function(t,e){return this._updateEffect(t,e,!0)}},{key:"_updateEffect",value:function(e,r,n){var a=o.toString(e.EFFECT).toLowerCase(),s=o.toNumber(e.VALUE),u=this._getSoundState(r.target);if(u.effects.hasOwnProperty(a)){n?u.effects[a]+=s:u.effects[a]=s;var c=t.EFFECT_RANGE[a],l=c.min,h=c.max;return u.effects[a]=i.clamp(u.effects[a],l,h),this._syncEffectsForTarget(r.target),Promise.resolve()}}},{key:"_syncEffectsForTarget",value:function(t){t&&t.sprite.soundBank&&(t.soundEffects=this._getSoundState(t).effects,t.sprite.soundBank.setEffects(t))}},{key:"clearEffects",value:function(t,e){this._clearEffectsForTarget(e.target)}},{key:"_clearEffectsForTarget",value:function(t){var e=this._getSoundState(t);for(var r in e.effects)e.effects.hasOwnProperty(r)&&(e.effects[r]=0);this._syncEffectsForTarget(t)}},{key:"_clearEffectsForAllTargets",value:function(){if(null!==this.runtime.targets)for(var t=this.runtime.targets,e=0;e<t.length;e++)this._clearEffectsForTarget(t[e])}},{key:"setVolume",value:function(t,e){var r=o.toNumber(t.VOLUME);return this._updateVolume(r,e)}},{key:"changeVolume",value:function(t,e){var r=o.toNumber(t.VOLUME)+e.target.volume;return this._updateVolume(r,e)}},{key:"_updateVolume",value:function(t,e){return t=i.clamp(t,0,100),e.target.volume=t,this._syncEffectsForTarget(e.target),Promise.resolve()}},{key:"getVolume",value:function(t,e){return e.target.volume}},{key:"soundsMenu",value:function(t){return t.SOUND_MENU}},{key:"beatsMenu",value:function(t){return t.BEATS}},{key:"effectsMenu",value:function(t){return t.EFFECT}}],[{key:"STATE_KEY",get:function(){return"Scratch.sound"}},{key:"DEFAULT_SOUND_STATE",get:function(){return{effects:{pitch:0,pan:0}}}},{key:"MIDI_NOTE_RANGE",get:function(){return{min:36,max:96}}},{key:"BEAT_RANGE",get:function(){return{min:0,max:100}}},{key:"TEMPO_RANGE",get:function(){return{min:20,max:500}}},{key:"EFFECT_RANGE",get:function(){return{pitch:{min:-360,max:360},pan:{min:-100,max:100}}}}]),t}();t.exports=s},function(t,e,r){function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=r(2),a=r(36),s=r(48),u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e,this._answer="",this._timer=new a,this._cachedLoudness=-1,this._cachedLoudnessTimestamp=0,this._questionList=[],this.runtime.on("ANSWER",this._onAnswer.bind(this)),this.runtime.on("PROJECT_START",this._resetAnswer.bind(this)),this.runtime.on("PROJECT_STOP_ALL",this._clearAllQuestions.bind(this)),this.runtime.on("STOP_FOR_TARGET",this._clearTargetQuestions.bind(this))}return function(t,e,r){e&&i(t.prototype,e),r&&i(t,r)}(t,[{key:"getPrimitives",value:function(){return{sensing_touchingobject:this.touchingObject,sensing_touchingcolor:this.touchingColor,sensing_coloristouchingcolor:this.colorTouchingColor,sensing_distanceto:this.distanceTo,sensing_timer:this.getTimer,sensing_resettimer:this.resetTimer,sensing_of:this.getAttributeOf,sensing_mousex:this.getMouseX,sensing_mousey:this.getMouseY,sensing_setdragmode:this.setDragMode,sensing_mousedown:this.getMouseDown,sensing_keypressed:this.getKeyPressed,sensing_current:this.current,sensing_dayssince2000:this.daysSince2000,sensing_loudness:this.getLoudness,sensing_loud:this.isLoud,sensing_askandwait:this.askAndWait,sensing_answer:this.getAnswer,sensing_username:this.getUsername,sensing_userid:function(){}}}},{key:"getMonitored",value:function(){return{sensing_answer:{getId:function(){return"answer"}},sensing_loudness:{getId:function(){return"loudness"}},sensing_timer:{getId:function(){return"timer"}},sensing_current:{getId:function(t,e){return s("current",e)}}}}},{key:"_onAnswer",value:function(t){this._answer=t;var e=this._questionList.shift();if(e){var r=n(e,5),i=(r[0],r[1]),o=r[2],a=r[3],s=r[4];a&&!s&&this.runtime.emit("SAY",o,"say",""),i(),this._askNextQuestion()}}},{key:"_resetAnswer",value:function(){this._answer=""}},{key:"_enqueueAsk",value:function(t,e,r,n,i){this._questionList.push([t,e,r,n,i])}},{key:"_askNextQuestion",value:function(){if(this._questionList.length>0){var t=n(this._questionList[0],5),e=t[0],r=(t[1],t[2]),i=t[3],o=t[4];i&&!o?(this.runtime.emit("SAY",r,"say",e),this.runtime.emit("QUESTION","")):this.runtime.emit("QUESTION",e)}}},{key:"_clearAllQuestions",value:function(){this._questionList=[],this.runtime.emit("QUESTION",null)}},{key:"_clearTargetQuestions",value:function(t){var e=this._questionList.length>0&&this._questionList[0][2]===t;this._questionList=this._questionList.filter(function(e){return e[2]!==t}),e&&(this.runtime.emit("SAY",t,"say",""),this._questionList.length>0?this._askNextQuestion():this.runtime.emit("QUESTION",null))}},{key:"askAndWait",value:function(t,e){var r=this,n=e.target;return new Promise(function(e){var i=r._questionList.length>0;r._enqueueAsk(String(t.QUESTION),e,n,n.visible,n.isStage),i||r._askNextQuestion()})}},{key:"getAnswer",value:function(){return this._answer}},{key:"touchingObject",value:function(t,e){return e.target.isTouchingObject(t.TOUCHINGOBJECTMENU)}},{key:"touchingColor",value:function(t,e){var r=o.toRgbColorList(t.COLOR);return e.target.isTouchingColor(r)}},{key:"colorTouchingColor",value:function(t,e){var r=o.toRgbColorList(t.COLOR),n=o.toRgbColorList(t.COLOR2);return e.target.colorIsTouchingColor(n,r)}},{key:"distanceTo",value:function(t,e){if(e.target.isStage)return 1e4;var r=0,n=0;if("_mouse_"===t.DISTANCETOMENU)r=e.ioQuery("mouse","getScratchX"),n=e.ioQuery("mouse","getScratchY");else{t.DISTANCETOMENU=o.toString(t.DISTANCETOMENU);var i=this.runtime.getSpriteTargetByName(t.DISTANCETOMENU);if(!i)return 1e4;r=i.x,n=i.y}var a=e.target.x-r,s=e.target.y-n;return Math.sqrt(a*a+s*s)}},{key:"setDragMode",value:function(t,e){e.target.setDraggable("draggable"===t.DRAG_MODE)}},{key:"getTimer",value:function(t,e){return e.ioQuery("clock","projectTimer")}},{key:"resetTimer",value:function(t,e){e.ioQuery("clock","resetProjectTimer")}},{key:"getMouseX",value:function(t,e){return e.ioQuery("mouse","getScratchX")}},{key:"getMouseY",value:function(t,e){return e.ioQuery("mouse","getScratchY")}},{key:"getMouseDown",value:function(t,e){return e.ioQuery("mouse","getIsDown")}},{key:"current",value:function(t){var e=o.toString(t.CURRENTMENU).toLowerCase(),r=new Date;switch(e){case"year":return r.getFullYear();case"month":return r.getMonth()+1;case"date":return r.getDate();case"dayofweek":return r.getDay()+1;case"hour":return r.getHours();case"minute":return r.getMinutes();case"second":return r.getSeconds()}return 0}},{key:"getKeyPressed",value:function(t,e){return e.ioQuery("keyboard","getKeyIsDown",[t.KEY_OPTION])}},{key:"daysSince2000",value:function(){var t=new Date(2e3,0,1),e=new Date,r=e.getTimezoneOffset()-t.getTimezoneOffset(),n=e.valueOf()-t.valueOf();return(n+=60*(e.getTimezoneOffset()-r)*1e3)/864e5}},{key:"getLoudness",value:function(){return void 0===this.runtime.audioEngine?-1:null===this.runtime.currentStepTime?-1:this._timer.time()-this._cachedLoudnessTimestamp<this.runtime.currentStepTime?this._cachedLoudness:(this._cachedLoudnessTimestamp=this._timer.time(),this._cachedLoudness=this.runtime.audioEngine.getLoudness(),this._cachedLoudness)}},{key:"isLoud",value:function(){return this.getLoudness()>10}},{key:"getAttributeOf",value:function(t){var e;if("_stage_"===t.OBJECT?e=this.runtime.getTargetForStage():(t.OBJECT=o.toString(t.OBJECT),e=this.runtime.getSpriteTargetByName(t.OBJECT)),!e)return 0;if(e.isStage)switch(t.PROPERTY){case"background #":case"backdrop #":return e.currentCostume+1;case"backdrop name":return e.getCostumes()[e.currentCostume].name;case"volume":return e.volume}else switch(t.PROPERTY){case"x position":return e.x;case"y position":return e.y;case"direction":return e.direction;case"costume #":return e.currentCostume+1;case"costume name":return e.getCostumes()[e.currentCostume].name;case"size":return e.size;case"volume":return e.volume}var r=t.PROPERTY,n=e.lookupVariableByNameAndType(r,"",!0);return n?n.value:0}},{key:"getUsername",value:function(t,e){return e.ioQuery("userData","getUsername")}}]),t}();t.exports=u},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(2),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"getPrimitives",value:function(){return{data_variable:this.getVariable,data_setvariableto:this.setVariableTo,data_changevariableby:this.changeVariableBy,data_hidevariable:this.hideVariable,data_showvariable:this.showVariable,data_listcontents:this.getListContents,data_addtolist:this.addToList,data_deleteoflist:this.deleteOfList,data_deletealloflist:this.deleteAllOfList,data_insertatlist:this.insertAtList,data_replaceitemoflist:this.replaceItemOfList,data_itemoflist:this.getItemOfList,data_itemnumoflist:this.getItemNumOfList,data_lengthoflist:this.lengthOfList,data_listcontainsitem:this.listContainsItem,data_hidelist:this.hideList,data_showlist:this.showList}}},{key:"getVariable",value:function(t,e){return e.target.lookupOrCreateVariable(t.VARIABLE.id,t.VARIABLE.name).value}},{key:"setVariableTo",value:function(t,e){var r=e.target.lookupOrCreateVariable(t.VARIABLE.id,t.VARIABLE.name);r.value=t.VALUE,r.isCloud&&e.ioQuery("cloud","requestUpdateVariable",[r.name,t.VALUE])}},{key:"changeVariableBy",value:function(t,e){var r=e.target.lookupOrCreateVariable(t.VARIABLE.id,t.VARIABLE.name),n=i.toNumber(r.value)+i.toNumber(t.VALUE);r.value=n,r.isCloud&&e.ioQuery("cloud","requestUpdateVariable",[r.name,n])}},{key:"changeMonitorVisibility",value:function(t,e){this.runtime.monitorBlocks.changeBlock({id:t,element:"checkbox",value:e},this.runtime)}},{key:"showVariable",value:function(t){this.changeMonitorVisibility(t.VARIABLE.id,!0)}},{key:"hideVariable",value:function(t){this.changeMonitorVisibility(t.VARIABLE.id,!1)}},{key:"showList",value:function(t){this.changeMonitorVisibility(t.LIST.id,!0)}},{key:"hideList",value:function(t){this.changeMonitorVisibility(t.LIST.id,!1)}},{key:"getListContents",value:function(t,e){var r=e.target.lookupOrCreateList(t.LIST.id,t.LIST.name);if(e.thread.updateMonitor)return r._monitorUpToDate?r.value:(r._monitorUpToDate=!0,r.value.slice());for(var n=!0,i=0;i<r.value.length;i++){var o=r.value[i];if("string"!=typeof o||1!==o.length){n=!1;break}}return n?r.value.join(""):r.value.join(" ")}},{key:"addToList",value:function(e,r){var n=r.target.lookupOrCreateList(e.LIST.id,e.LIST.name);n.value.length<t.LIST_ITEM_LIMIT&&(n.value.push(e.ITEM),n._monitorUpToDate=!1)}},{key:"deleteOfList",value:function(t,e){var r=e.target.lookupOrCreateList(t.LIST.id,t.LIST.name),n=i.toListIndex(t.INDEX,r.value.length,!0);n!==i.LIST_INVALID&&(n!==i.LIST_ALL?(r.value.splice(n-1,1),r._monitorUpToDate=!1):r.value=[])}},{key:"deleteAllOfList",value:function(t,e){e.target.lookupOrCreateList(t.LIST.id,t.LIST.name).value=[]}},{key:"insertAtList",value:function(e,r){var n=e.ITEM,o=r.target.lookupOrCreateList(e.LIST.id,e.LIST.name),a=i.toListIndex(e.INDEX,o.value.length+1,!1);if(a!==i.LIST_INVALID){var s=t.LIST_ITEM_LIMIT;a>s||(o.value.splice(a-1,0,n),o.value.length>s&&o.value.pop(),o._monitorUpToDate=!1)}}},{key:"replaceItemOfList",value:function(t,e){var r=t.ITEM,n=e.target.lookupOrCreateList(t.LIST.id,t.LIST.name),o=i.toListIndex(t.INDEX,n.value.length,!1);o!==i.LIST_INVALID&&(n.value.splice(o-1,1,r),n._monitorUpToDate=!1)}},{key:"getItemOfList",value:function(t,e){var r=e.target.lookupOrCreateList(t.LIST.id,t.LIST.name),n=i.toListIndex(t.INDEX,r.value.length,!1);return n===i.LIST_INVALID?"":r.value[n-1]}},{key:"getItemNumOfList",value:function(t,e){for(var r=t.ITEM,n=e.target.lookupOrCreateList(t.LIST.id,t.LIST.name),o=0;o<n.value.length;o++)if(0===i.compare(n.value[o],r))return o+1;return 0}},{key:"lengthOfList",value:function(t,e){return e.target.lookupOrCreateList(t.LIST.id,t.LIST.name).value.length}},{key:"listContainsItem",value:function(t,e){var r=t.ITEM,n=e.target.lookupOrCreateList(t.LIST.id,t.LIST.name);if(n.value.indexOf(r)>=0)return!0;for(var o=0;o<n.value.length;o++)if(0===i.compare(n.value[o],r))return!0;return!1}}],[{key:"LIST_ITEM_LIMIT",get:function(){return 2e5}}]),t}();t.exports=o},function(t,e){function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.runtime=e}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"getPrimitives",value:function(){return{procedures_definition:this.definition,procedures_call:this.call,argument_reporter_string_number:this.argumentReporterStringNumber,argument_reporter_boolean:this.argumentReporterBoolean}}},{key:"definition",value:function(){}},{key:"call",value:function(t,e){if(!e.stackFrame.executed){var n=t.mutation.proccode,i=e.getProcedureParamNamesIdsAndDefaults(n);if(null===i)return;var o=r(i,3),a=o[0],s=o[1],u=o[2];e.initParams();for(var c=0;c<s.length;c++)t.hasOwnProperty(s[c])?e.pushParam(a[c],t[s[c]]):e.pushParam(a[c],u[c]);e.stackFrame.executed=!0,e.startProcedure(n)}}},{key:"argumentReporterStringNumber",value:function(t,e){var r=e.getParam(t.VALUE);return null===r?0:r}},{key:"argumentReporterBoolean",value:function(t,e){var r=e.getParam(t.VALUE);return null===r?0:r}}]),t}();t.exports=i},function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=r(207),o=i.motionVector,a=i.scratchAtan2,s=480,u=360,c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frameNumber=0,this.lastAnalyzedFrame=0,this.motionAmount=0,this.motionDirection=0,this.curr=null,this.prev=null,this._arrays=new ArrayBuffer(s*u*2*1),this._curr=new Uint8ClampedArray(this._arrays,s*u*0*1,s*u),this._prev=new Uint8ClampedArray(this._arrays,s*u*1*1,s*u)}return function(t,e,r){e&&n(t.prototype,e),r&&n(t,r)}(t,[{key:"reset",value:function(){this.frameNumber=0,this.lastAnalyzedFrame=0,this.motionAmount=this.motionDirection=0,this.prev=this.curr=null}},{key:"addFrame",value:function(t){this.frameNumber++,this.prev=this.curr,this.curr=new Uint32Array(t.buffer.slice(0));var e=this._prev;this._prev=this._curr,this._curr=e;for(var r=0;r<this.curr.length;r++)this._curr[r]=255&this.curr[r]}},{key:"analyzeFrame",value:function(){if(this.curr&&this.prev){if(this.lastAnalyzedFrame!==this.frameNumber){this.lastAnalyzedFrame=this.frameNumber;for(var t=this._curr,e=this._prev,r=s-8-1,n=u-8-1,i=0,c=0,l=0,h=9;h<n;h+=17)for(var f=9;f<r;f+=17){for(var p=0,d=0,g=0,m=0,v=0,_=(h-8)*s+f-8,y=_+17,b=(h+8)*s+f+8;_<=b;_+=s-17,y+=s)for(;_<=y;_+=1){var k=e[_]-t[_],T=t[_-1]-t[_+1],S=t[_-s]-t[_+s];p+=T*T,d+=T*S,g+=S*S,v+=T*k,m+=S*k}var w=o(p,d,g,v,m),E=w.u,I=w.v;-17<E&&E<17&&-17<I&&I<17&&(i+=E,c+=I,l++)}i/=l,c/=l,this.motionAmount=Math.round(100*Math.hypot(i,c)),this.motionAmount>10&&(this.motionDirection=a(c,i))}}else this.motionAmount=this.motionDirection=-1}},{key:"getLocalMotion",value:function(t,e){if(this.curr&&this.prev){if(e.motionFrameNumber!==this.frameNumber){var r=this._prev,n=this._curr;t.updateMatrix(),t.skin&&t.skin.updateSilhouette();for(var i=t.getFastBounds(),c=Math.max(Math.floor(i.left+s/2),1),l=Math.min(Math.floor(i.right+s/2),s-1),h=Math.max(Math.floor(u/2-i.top),1),f=Math.min(Math.floor(u/2-i.bottom),u-1),p=0,d=0,g=0,m=0,v=0,_=0,y=[0,0,0],b=h;b<f;b++)for(var k=c;k<l;k++)if(y[0]=k-s/2,y[1]=u/2-b,t.isTouching(y)){var T=b*s+k,S=r[T]-n[T],w=n[T-1]-n[T+1],E=n[T-s]-n[T+s];p+=w*w,d+=w*E,g+=E*E,v+=w*S,m+=E*S,_++}var I=o(p,d,g,v,m),A=I.u,O=I.v,N=0;_&&(N=_,A/=_/=256,O/=_),e.motionAmount=Math.round(.02*N*Math.hypot(A,O)),e.motionAmount>100&&(e.motionAmount=100),e.motionAmount>10/3&&(e.motionDirection=a(O,A)),e.motionFrameNumber=this.frameNumber}}else e.motionAmount=e.motionDirection=-1}}]),t}();t.exports=c},function(t,e){var r=180/Math.PI,n={u:0,v:0},i=function(t){return(t+270)%360-180};t.exports={motionVector:function(t,e,r,i,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n,s=e*e-t*r;if(s){var u=-(o*e-i*r),c=-(e*i-t*o),l=8/s;a.u=u*l,a.v=c*l}else{var h=(e+t)*(e+t)+(r+e)*(r+e);if(h){var f=8/h*-(o+i);a.u=(e+t)*f,a.v=(r+e)*f}else a.u=0,a.v=0}return a},scratchDegrees:i,scratchAtan2:function(t,e){return i(Math.atan2(t,e)*r)}}}])});